using System;
using System.Web.UI;
using System.Web.UI.WebControls;

namespace NSW
{
    public partial class MobileMaster : System.Web.UI.MasterPage
    {
        public string SplashLink = NSW.Info.ProjectInfo.protocol + NSW.Info.AppSettings.GetAppSetting("webServer", false);

        protected void Page_Load(object sender, EventArgs e)
        {
            Log.WriteToLog(NSW.Info.ProjectInfo.ProjectLogType, "Master.Page_Load", "Starting...", LogEnum.Debug);
            setText();
        }

        private void setText()
        {
            Log.WriteToLog(NSW.Info.ProjectInfo.ProjectLogType, "Master.setText", "Starting...", LogEnum.Debug);
            // now set all the label text
            // title of the page
            lblTitle.Text = NSW.Data.LabelText.Text("Master.lblTitle");
            // Title bar button "Login"
            Label newLabel = (Label)this.HeadLoginView.FindControl("lblLogin");
            if (newLabel != null)
                newLabel.Text = NSW.Data.LabelText.Text("Master.lblLogin");
            // logout button
            if (Page.User.Identity.IsAuthenticated)
            {
                LoginStatus newStatus = (LoginStatus)this.HeadLoginView.FindControl("HeadLoginStatus");
                if (newStatus != null)
                    newStatus.LogoutText = NSW.Data.LabelText.Text("Master.lblLogout");
            }
            // Menu bar
            MenuItem searchItem = new MenuItem(NSW.Data.LabelText.Text("Master.btnSearch"), null, null, "~/Search.aspx");
            MenuItem homeItem = new MenuItem(NSW.Data.LabelText.Text("Master.btnHome"), null, null, "~/Default.aspx");
            MenuItem contactItem = new MenuItem(NSW.Data.LabelText.Text("Master.btnContact"), null, null, "~/Contact.aspx");
            this.NavigationMenu.Items.Clear();
            this.NavigationMenu.Items.Add(homeItem);
            this.NavigationMenu.Items.Add(searchItem);
            this.NavigationMenu.Items.Add(contactItem);
            NSW.Data.User cacheUser = new Data.User(Page.User.Identity.Name);
            if (Page.User.Identity.IsAuthenticated)
            {
                MenuItem addItem = new MenuItem(NSW.Data.LabelText.Text("Master.btnAdd"), null, null, "~/Posts/AddPost.aspx");
                this.NavigationMenu.Items.Add(addItem);
            }
            // footer
            this.lblFooter.Text = NSW.Data.LabelText.Text("Master.lblFooter");
        }
    }
}

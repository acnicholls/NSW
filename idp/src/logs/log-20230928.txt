[01:40:30 Information] 
Starting host...

[01:40:30 Warning] Microsoft.AspNetCore.DataProtection.Repositories.FileSystemXmlRepository
Storing keys in a directory '/root/.aspnet/DataProtection-Keys' that may not be persisted outside of the container. Protected data will be unavailable when container is destroyed.

[01:40:30 Information] Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager
User profile is available. Using '/root/.aspnet/DataProtection-Keys' as key repository; keys will not be encrypted at rest.

[01:40:30 Information] Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager
Creating key {3d627fa9-f3c3-41c7-ab49-996f4cc7ac81} with creation date 2023-09-28 01:40:30Z, activation date 2023-09-28 01:40:30Z, and expiration date 2023-12-27 01:40:30Z.

[01:40:30 Warning] Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager
No XML encryptor configured. Key {3d627fa9-f3c3-41c7-ab49-996f4cc7ac81} may be persisted to storage in unencrypted form.

[01:40:30 Information] Microsoft.AspNetCore.DataProtection.Repositories.FileSystemXmlRepository
Writing data to file '/root/.aspnet/DataProtection-Keys/key-3d627fa9-f3c3-41c7-ab49-996f4cc7ac81.xml'.

[01:40:32 Fatal] Microsoft.AspNetCore.Hosting.Diagnostics
Application startup exception
Microsoft.Data.SqlClient.SqlException (0x80131904): Login failed for user 'sa'. Reason: Server is in script upgrade mode. Only administrator can connect at this time.
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.CompleteLogin(Boolean enlistOK)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.AttemptOneLogin(ServerInfo serverInfo, String newPassword, SecureString newSecurePassword, Boolean ignoreSniOpenTimeout, TimeoutTimer timeout, Boolean withFailover)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.LoginNoFailover(ServerInfo serverInfo, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance, SqlConnectionString connectionOptions, SqlCredential credential, TimeoutTimer timeout)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.OpenLoginEnlist(TimeoutTimer timeout, SqlConnectionString connectionOptions, SqlCredential credential, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds..ctor(DbConnectionPoolIdentity identity, SqlConnectionString connectionOptions, SqlCredential credential, Object providerInfo, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance, SqlConnectionString userConnectionOptions, SessionData reconnectSessionData, Boolean applyTransientFaultHandling, String accessToken, DbConnectionPool pool)
   at Microsoft.Data.SqlClient.SqlConnectionFactory.CreateConnection(DbConnectionOptions options, DbConnectionPoolKey poolKey, Object poolGroupProviderInfo, DbConnectionPool pool, DbConnection owningConnection, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionFactory.CreatePooledConnection(DbConnectionPool pool, DbConnection owningObject, DbConnectionOptions options, DbConnectionPoolKey poolKey, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionPool.CreateObject(DbConnection owningObject, DbConnectionOptions userOptions, DbConnectionInternal oldConnection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.UserCreateRequest(DbConnection owningObject, DbConnectionOptions userOptions, DbConnectionInternal oldConnection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at Microsoft.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry, SqlConnectionOverrides overrides)
   at Microsoft.Data.SqlClient.SqlConnection.Open(SqlConnectionOverrides overrides)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerConnection.OpenDbConnection(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternal(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.Open(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerDatabaseCreator.<>c__DisplayClass18_0.<Exists>b__0(DateTime giveUp)
   at Microsoft.EntityFrameworkCore.ExecutionStrategyExtensions.<>c__DisplayClass12_0`2.<Execute>b__0(DbContext c, TState s)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.ExecutionStrategyExtensions.Execute[TState,TResult](IExecutionStrategy strategy, TState state, Func`2 operation, Func`2 verifySucceeded)
   at Microsoft.EntityFrameworkCore.ExecutionStrategyExtensions.Execute[TState,TResult](IExecutionStrategy strategy, TState state, Func`2 operation)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerDatabaseCreator.Exists(Boolean retryOnNotExists)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerDatabaseCreator.Exists()
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.Exists()
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.Migrate(String targetMigration)
   at Microsoft.EntityFrameworkCore.RelationalDatabaseFacadeExtensions.Migrate(DatabaseFacade databaseFacade)
   at Starter.Idp.SeedData.EnsureSeedData(String connectionString) in /app/SeedData.cs:line 36
   at Starter.Idp.Startup.Configure(IApplicationBuilder app) in /app/Startup.cs:line 116
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Object[] arguments, Signature sig, Boolean constructor, Boolean wrapExceptions)
   at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.AspNetCore.Hosting.ConfigureBuilder.Invoke(Object instance, IApplicationBuilder builder)
   at Microsoft.AspNetCore.Hosting.ConfigureBuilder.<>c__DisplayClass4_0.<Build>b__0(IApplicationBuilder builder)
   at Microsoft.AspNetCore.Hosting.GenericWebHostBuilder.<>c__DisplayClass15_0.<UseStartup>b__1(IApplicationBuilder app)
   at Microsoft.AspNetCore.Mvc.Filters.MiddlewareFilterBuilderStartupFilter.<>c__DisplayClass0_0.<Configure>g__MiddlewareFilterBuilder|0(IApplicationBuilder builder)
   at Microsoft.AspNetCore.HostFilteringStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder app)
   at Microsoft.AspNetCore.Watch.BrowserRefresh.HostingStartup.<>c__DisplayClass1_0.<Configure>b__0(IApplicationBuilder app)
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
ClientConnectionId:5e284f99-85c5-427c-8ef0-235ff4c2b738
Error Number:18401,State:1,Class:14

[01:40:32 Fatal] 
Host terminated unexpectedly.
Microsoft.Data.SqlClient.SqlException (0x80131904): Login failed for user 'sa'. Reason: Server is in script upgrade mode. Only administrator can connect at this time.
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.CompleteLogin(Boolean enlistOK)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.AttemptOneLogin(ServerInfo serverInfo, String newPassword, SecureString newSecurePassword, Boolean ignoreSniOpenTimeout, TimeoutTimer timeout, Boolean withFailover)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.LoginNoFailover(ServerInfo serverInfo, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance, SqlConnectionString connectionOptions, SqlCredential credential, TimeoutTimer timeout)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.OpenLoginEnlist(TimeoutTimer timeout, SqlConnectionString connectionOptions, SqlCredential credential, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds..ctor(DbConnectionPoolIdentity identity, SqlConnectionString connectionOptions, SqlCredential credential, Object providerInfo, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance, SqlConnectionString userConnectionOptions, SessionData reconnectSessionData, Boolean applyTransientFaultHandling, String accessToken, DbConnectionPool pool)
   at Microsoft.Data.SqlClient.SqlConnectionFactory.CreateConnection(DbConnectionOptions options, DbConnectionPoolKey poolKey, Object poolGroupProviderInfo, DbConnectionPool pool, DbConnection owningConnection, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionFactory.CreatePooledConnection(DbConnectionPool pool, DbConnection owningObject, DbConnectionOptions options, DbConnectionPoolKey poolKey, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionPool.CreateObject(DbConnection owningObject, DbConnectionOptions userOptions, DbConnectionInternal oldConnection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.UserCreateRequest(DbConnection owningObject, DbConnectionOptions userOptions, DbConnectionInternal oldConnection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at Microsoft.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry, SqlConnectionOverrides overrides)
   at Microsoft.Data.SqlClient.SqlConnection.Open(SqlConnectionOverrides overrides)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerConnection.OpenDbConnection(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternal(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.Open(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerDatabaseCreator.<>c__DisplayClass18_0.<Exists>b__0(DateTime giveUp)
   at Microsoft.EntityFrameworkCore.ExecutionStrategyExtensions.<>c__DisplayClass12_0`2.<Execute>b__0(DbContext c, TState s)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.ExecutionStrategyExtensions.Execute[TState,TResult](IExecutionStrategy strategy, TState state, Func`2 operation, Func`2 verifySucceeded)
   at Microsoft.EntityFrameworkCore.ExecutionStrategyExtensions.Execute[TState,TResult](IExecutionStrategy strategy, TState state, Func`2 operation)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerDatabaseCreator.Exists(Boolean retryOnNotExists)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerDatabaseCreator.Exists()
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.Exists()
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.Migrate(String targetMigration)
   at Microsoft.EntityFrameworkCore.RelationalDatabaseFacadeExtensions.Migrate(DatabaseFacade databaseFacade)
   at Starter.Idp.SeedData.EnsureSeedData(String connectionString) in /app/SeedData.cs:line 36
   at Starter.Idp.Startup.Configure(IApplicationBuilder app) in /app/Startup.cs:line 116
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Object[] arguments, Signature sig, Boolean constructor, Boolean wrapExceptions)
   at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.AspNetCore.Hosting.ConfigureBuilder.Invoke(Object instance, IApplicationBuilder builder)
   at Microsoft.AspNetCore.Hosting.ConfigureBuilder.<>c__DisplayClass4_0.<Build>b__0(IApplicationBuilder builder)
   at Microsoft.AspNetCore.Hosting.GenericWebHostBuilder.<>c__DisplayClass15_0.<UseStartup>b__1(IApplicationBuilder app)
   at Microsoft.AspNetCore.Mvc.Filters.MiddlewareFilterBuilderStartupFilter.<>c__DisplayClass0_0.<Configure>g__MiddlewareFilterBuilder|0(IApplicationBuilder builder)
   at Microsoft.AspNetCore.HostFilteringStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder app)
   at Microsoft.AspNetCore.Watch.BrowserRefresh.HostingStartup.<>c__DisplayClass1_0.<Configure>b__0(IApplicationBuilder app)
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Run(IHost host)
   at Starter.Idp.Program.Main(String[] args) in /app/Program.cs:line 66
ClientConnectionId:5e284f99-85c5-427c-8ef0-235ff4c2b738
Error Number:18401,State:1,Class:14

[01:52:45 Information] 
Starting host...

[01:52:46 Warning] Microsoft.AspNetCore.DataProtection.Repositories.FileSystemXmlRepository
Storing keys in a directory '/root/.aspnet/DataProtection-Keys' that may not be persisted outside of the container. Protected data will be unavailable when container is destroyed.

[01:52:46 Information] Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager
User profile is available. Using '/root/.aspnet/DataProtection-Keys' as key repository; keys will not be encrypted at rest.

[01:52:47 Debug] 
alice already exists

[01:52:47 Debug] 
bob already exists

[01:52:47 Information] IdentityServer4.Startup
Starting IdentityServer4 version 4.1.2+997a6cdd643e46cd5762b710c4ddc43574cbec2e

[01:52:47 Information] IdentityServer4.Startup
You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.

[01:52:47 Debug] IdentityServer4.Startup
Custom IssuerUri set to https://localhost

[01:52:47 Information] IdentityServer4.Startup
Using the default authentication scheme Identity.Application for IdentityServer

[01:52:47 Debug] IdentityServer4.Startup
Using Identity.Application as default ASP.NET Core scheme for authentication

[01:52:47 Debug] IdentityServer4.Startup
Using Identity.External as default ASP.NET Core scheme for sign-in

[01:52:47 Debug] IdentityServer4.Startup
Using Identity.External as default ASP.NET Core scheme for sign-out

[01:52:47 Debug] IdentityServer4.Startup
Using Identity.Application as default ASP.NET Core scheme for challenge

[01:52:47 Debug] IdentityServer4.Startup
Using Identity.Application as default ASP.NET Core scheme for forbid

[01:52:47 Warning] Microsoft.AspNetCore.Server.Kestrel
Overriding address(es) 'https://localhost:5001, http://localhost:5000'. Binding to endpoints defined in UseKestrel() instead.

[01:52:47 Information] Microsoft.Hosting.Lifetime
Now listening on: http://0.0.0.0:5006

[01:52:47 Information] Microsoft.Hosting.Lifetime
Now listening on: https://0.0.0.0:5007

[01:52:47 Information] Microsoft.Hosting.Lifetime
Application started. Press Ctrl+C to shut down.

[01:52:47 Information] Microsoft.Hosting.Lifetime
Hosting environment: Development

[01:52:47 Information] Microsoft.Hosting.Lifetime
Content root path: /app

[01:53:12 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration - -

[01:53:12 Debug] IdentityServer4.Startup
Login Url: /Account/Login

[01:53:12 Debug] IdentityServer4.Startup
Login Return Url Parameter: ReturnUrl

[01:53:12 Debug] IdentityServer4.Startup
Logout Url: /Account/Logout

[01:53:12 Debug] IdentityServer4.Startup
ConsentUrl Url: /consent

[01:53:12 Debug] IdentityServer4.Startup
Consent Return Url Parameter: returnUrl

[01:53:12 Debug] IdentityServer4.Startup
Error Url: /home/error

[01:53:12 Debug] IdentityServer4.Startup
Error Id Parameter: errorId

[01:53:12 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[01:53:12 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[01:53:12 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /.well-known/openid-configuration matched to endpoint type Discovery

[01:53:12 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint

[01:53:12 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration

[01:53:12 Debug] IdentityServer4.Endpoints.DiscoveryEndpoint
Start discovery request

[01:53:12 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 142.9417ms

[01:53:12 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration/jwks - -

[01:53:12 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[01:53:12 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[01:53:12 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery

[01:53:12 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint

[01:53:12 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks

[01:53:12 Debug] IdentityServer4.Endpoints.DiscoveryKeyEndpoint
Start key discovery request

[01:53:13 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 47.8411ms

[01:53:13 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.0 GET https://localhost/connect/authorize?client_id=Starter.Bff&redirect_uri=https%3A%2F%2Flocalhost%2Fsignin-oidc&response_type=code&scope=openid%20profile%20Starter.Api%20offline_access&code_challenge=YPRm6pDJgB9UCZKDvHZV0I5s5rPnPlLrqPLGekRhpE4&code_challenge_method=S256&response_mode=form_post&nonce=638314627930249103.NmEwNzc2MTMtYzI1NC00YTllLWFjYTItOTRjZTU4MWZlZGQzZWViZmRiODUtNzdkNC00YWEyLWJmNzAtNTFiNThkNzM4Nzg3&state=CfDJ8PJKEZ1uyltHi8IKXEkudMuaHSCP3rfk69L2U41P1RcJzX-0_1Lg5PlrDmNwhvVh3zuDtBFNNIFaMWXHiU76TcdpbN6pqorpgjT0zZl4NEBJaTKqXbwf-q8sXmWEOW4I6v5uePCEecb20pa9fkUvOWB_QwLA-Ts9sfhr3MqkDlWUhdgUSSZTLNqghoJEv_TnRkc4bxJbv7xkIxvAlftkW8haJIxSslxBUFTTb5EnBN47yV96PjCCH_Q6OFJ3xxV2x57PLUafpK4_w1mKBELyyDet2yLdEEe8m5li91DneU9I-cDK6YmiSIUoThEoyE3uB2vVWDJfNPXwDtvWiSnJLs1uc6dwjUnQA_j_axseCsLhSkOGlCysaqp95toNqqpgGPnZkX0vRbqtyw0ywhbwIZk&x-client-SKU=ID_NETSTANDARD2_0&x-client-ver=6.7.1.0 - -

[01:53:13 Information] Microsoft.AspNetCore.Cors.Infrastructure.CorsService
CORS policy execution successful.

[01:53:13 Information] Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware
No CORS policy found for the specified request.

[01:53:13 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[01:53:13 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[01:53:13 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /connect/authorize matched to endpoint type Authorize

[01:53:13 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint

[01:53:13 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize

[01:53:13 Debug] IdentityServer4.Endpoints.AuthorizeEndpoint
Start authorize request

[01:53:13 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[01:53:13 Debug] IdentityServer4.Endpoints.AuthorizeEndpoint
No user present in authorize request

[01:53:13 Debug] IdentityServer4.Validation.AuthorizeRequestValidator
Start authorize request protocol validation

[01:53:13 Debug] IdentityServer4.Stores.ValidatingClientStore
client configuration validation for client Starter.Bff succeeded.

[01:53:13 Debug] IdentityServer4.Validation.AuthorizeRequestValidator
Checking for PKCE parameters

[01:53:13 Debug] IdentityServer4.Validation.AuthorizeRequestValidator
Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator

[01:53:13 Debug] IdentityServer4.Endpoints.AuthorizeEndpoint
ValidatedAuthorizeRequest
{"ClientId":"Starter.Bff","ClientName":null,"RedirectUri":"https://localhost/signin-oidc","AllowedRedirectUris":["https://localhost/signin-oidc","https://bff:5005/signin-oidc","https://localhost/loggedin"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"form_post","GrantType":"authorization_code","RequestedScopes":"openid profile Starter.Api offline_access","State":"CfDJ8PJKEZ1uyltHi8IKXEkudMuaHSCP3rfk69L2U41P1RcJzX-0_1Lg5PlrDmNwhvVh3zuDtBFNNIFaMWXHiU76TcdpbN6pqorpgjT0zZl4NEBJaTKqXbwf-q8sXmWEOW4I6v5uePCEecb20pa9fkUvOWB_QwLA-Ts9sfhr3MqkDlWUhdgUSSZTLNqghoJEv_TnRkc4bxJbv7xkIxvAlftkW8haJIxSslxBUFTTb5EnBN47yV96PjCCH_Q6OFJ3xxV2x57PLUafpK4_w1mKBELyyDet2yLdEEe8m5li91DneU9I-cDK6YmiSIUoThEoyE3uB2vVWDJfNPXwDtvWiSnJLs1uc6dwjUnQA_j_axseCsLhSkOGlCysaqp95toNqqpgGPnZkX0vRbqtyw0ywhbwIZk","UiLocales":null,"Nonce":"638314627930249103.NmEwNzc2MTMtYzI1NC00YTllLWFjYTItOTRjZTU4MWZlZGQzZWViZmRiODUtNzdkNC00YWEyLWJmNzAtNTFiNThkNzM4Nzg3","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"Starter.Bff","redirect_uri":"https://localhost/signin-oidc","response_type":"code","scope":"openid profile Starter.Api offline_access","code_challenge":"YPRm6pDJgB9UCZKDvHZV0I5s5rPnPlLrqPLGekRhpE4","code_challenge_method":"S256","response_mode":"form_post","nonce":"638314627930249103.NmEwNzc2MTMtYzI1NC00YTllLWFjYTItOTRjZTU4MWZlZGQzZWViZmRiODUtNzdkNC00YWEyLWJmNzAtNTFiNThkNzM4Nzg3","state":"CfDJ8PJKEZ1uyltHi8IKXEkudMuaHSCP3rfk69L2U41P1RcJzX-0_1Lg5PlrDmNwhvVh3zuDtBFNNIFaMWXHiU76TcdpbN6pqorpgjT0zZl4NEBJaTKqXbwf-q8sXmWEOW4I6v5uePCEecb20pa9fkUvOWB_QwLA-Ts9sfhr3MqkDlWUhdgUSSZTLNqghoJEv_TnRkc4bxJbv7xkIxvAlftkW8haJIxSslxBUFTTb5EnBN47yV96PjCCH_Q6OFJ3xxV2x57PLUafpK4_w1mKBELyyDet2yLdEEe8m5li91DneU9I-cDK6YmiSIUoThEoyE3uB2vVWDJfNPXwDtvWiSnJLs1uc6dwjUnQA_j_axseCsLhSkOGlCysaqp95toNqqpgGPnZkX0vRbqtyw0ywhbwIZk","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"6.7.1.0"},"$type":"AuthorizeRequestValidationLog"}

[01:53:13 Information] IdentityServer4.ResponseHandling.AuthorizeInteractionResponseGenerator
Showing login: User is not authenticated

[01:53:13 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.0 GET https://localhost/connect/authorize?client_id=Starter.Bff&redirect_uri=https%3A%2F%2Flocalhost%2Fsignin-oidc&response_type=code&scope=openid%20profile%20Starter.Api%20offline_access&code_challenge=YPRm6pDJgB9UCZKDvHZV0I5s5rPnPlLrqPLGekRhpE4&code_challenge_method=S256&response_mode=form_post&nonce=638314627930249103.NmEwNzc2MTMtYzI1NC00YTllLWFjYTItOTRjZTU4MWZlZGQzZWViZmRiODUtNzdkNC00YWEyLWJmNzAtNTFiNThkNzM4Nzg3&state=CfDJ8PJKEZ1uyltHi8IKXEkudMuaHSCP3rfk69L2U41P1RcJzX-0_1Lg5PlrDmNwhvVh3zuDtBFNNIFaMWXHiU76TcdpbN6pqorpgjT0zZl4NEBJaTKqXbwf-q8sXmWEOW4I6v5uePCEecb20pa9fkUvOWB_QwLA-Ts9sfhr3MqkDlWUhdgUSSZTLNqghoJEv_TnRkc4bxJbv7xkIxvAlftkW8haJIxSslxBUFTTb5EnBN47yV96PjCCH_Q6OFJ3xxV2x57PLUafpK4_w1mKBELyyDet2yLdEEe8m5li91DneU9I-cDK6YmiSIUoThEoyE3uB2vVWDJfNPXwDtvWiSnJLs1uc6dwjUnQA_j_axseCsLhSkOGlCysaqp95toNqqpgGPnZkX0vRbqtyw0ywhbwIZk&x-client-SKU=ID_NETSTANDARD2_0&x-client-ver=6.7.1.0 - - - 302 0 - 140.7280ms

[01:53:13 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.0 GET https://localhost/Account/Login?ReturnUrl=%2Fconnect%2Fauthorize%2Fcallback%3Fclient_id%3DStarter.Bff%26redirect_uri%3Dhttps%253A%252F%252Flocalhost%252Fsignin-oidc%26response_type%3Dcode%26scope%3Dopenid%2520profile%2520Starter.Api%2520offline_access%26code_challenge%3DYPRm6pDJgB9UCZKDvHZV0I5s5rPnPlLrqPLGekRhpE4%26code_challenge_method%3DS256%26response_mode%3Dform_post%26nonce%3D638314627930249103.NmEwNzc2MTMtYzI1NC00YTllLWFjYTItOTRjZTU4MWZlZGQzZWViZmRiODUtNzdkNC00YWEyLWJmNzAtNTFiNThkNzM4Nzg3%26state%3DCfDJ8PJKEZ1uyltHi8IKXEkudMuaHSCP3rfk69L2U41P1RcJzX-0_1Lg5PlrDmNwhvVh3zuDtBFNNIFaMWXHiU76TcdpbN6pqorpgjT0zZl4NEBJaTKqXbwf-q8sXmWEOW4I6v5uePCEecb20pa9fkUvOWB_QwLA-Ts9sfhr3MqkDlWUhdgUSSZTLNqghoJEv_TnRkc4bxJbv7xkIxvAlftkW8haJIxSslxBUFTTb5EnBN47yV96PjCCH_Q6OFJ3xxV2x57PLUafpK4_w1mKBELyyDet2yLdEEe8m5li91DneU9I-cDK6YmiSIUoThEoyE3uB2vVWDJfNPXwDtvWiSnJLs1uc6dwjUnQA_j_axseCsLhSkOGlCysaqp95toNqqpgGPnZkX0vRbqtyw0ywhbwIZk%26x-client-SKU%3DID_NETSTANDARD2_0%26x-client-ver%3D6.7.1.0 - -

[01:53:13 Information] Microsoft.AspNetCore.Cors.Infrastructure.CorsService
CORS policy execution successful.

[01:53:13 Information] Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware
No CORS policy found for the specified request.

[01:53:13 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[01:53:13 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[01:53:13 Information] Microsoft.AspNetCore.Routing.EndpointMiddleware
Executing endpoint 'Starter.Idp.Controllers.Account.AccountController.Login (IDP)'

[01:53:13 Information] Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker
Route matched with {action = "Login", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(System.String) on controller Starter.Idp.Controllers.Account.AccountController (IDP).

[01:53:13 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[01:53:13 Debug] IdentityServer4.Validation.AuthorizeRequestValidator
Start authorize request protocol validation

[01:53:13 Debug] IdentityServer4.Stores.ValidatingClientStore
client configuration validation for client Starter.Bff succeeded.

[01:53:13 Debug] IdentityServer4.Validation.AuthorizeRequestValidator
Checking for PKCE parameters

[01:53:13 Debug] IdentityServer4.Validation.AuthorizeRequestValidator
Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator

[01:53:13 Debug] IdentityServer4.Stores.ValidatingClientStore
client configuration validation for client Starter.Bff succeeded.

[01:53:13 Information] Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor
Executing ViewResult, running view Login.

[01:53:13 Information] Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor
Executed ViewResult - view Login executed in 134.3036ms.

[01:53:13 Information] Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker
Executed action Starter.Idp.Controllers.Account.AccountController.Login (IDP) in 184.3876ms

[01:53:13 Information] Microsoft.AspNetCore.Routing.EndpointMiddleware
Executed endpoint 'Starter.Idp.Controllers.Account.AccountController.Login (IDP)'

[01:53:13 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.0 GET https://localhost/Account/Login?ReturnUrl=%2Fconnect%2Fauthorize%2Fcallback%3Fclient_id%3DStarter.Bff%26redirect_uri%3Dhttps%253A%252F%252Flocalhost%252Fsignin-oidc%26response_type%3Dcode%26scope%3Dopenid%2520profile%2520Starter.Api%2520offline_access%26code_challenge%3DYPRm6pDJgB9UCZKDvHZV0I5s5rPnPlLrqPLGekRhpE4%26code_challenge_method%3DS256%26response_mode%3Dform_post%26nonce%3D638314627930249103.NmEwNzc2MTMtYzI1NC00YTllLWFjYTItOTRjZTU4MWZlZGQzZWViZmRiODUtNzdkNC00YWEyLWJmNzAtNTFiNThkNzM4Nzg3%26state%3DCfDJ8PJKEZ1uyltHi8IKXEkudMuaHSCP3rfk69L2U41P1RcJzX-0_1Lg5PlrDmNwhvVh3zuDtBFNNIFaMWXHiU76TcdpbN6pqorpgjT0zZl4NEBJaTKqXbwf-q8sXmWEOW4I6v5uePCEecb20pa9fkUvOWB_QwLA-Ts9sfhr3MqkDlWUhdgUSSZTLNqghoJEv_TnRkc4bxJbv7xkIxvAlftkW8haJIxSslxBUFTTb5EnBN47yV96PjCCH_Q6OFJ3xxV2x57PLUafpK4_w1mKBELyyDet2yLdEEe8m5li91DneU9I-cDK6YmiSIUoThEoyE3uB2vVWDJfNPXwDtvWiSnJLs1uc6dwjUnQA_j_axseCsLhSkOGlCysaqp95toNqqpgGPnZkX0vRbqtyw0ywhbwIZk%26x-client-SKU%3DID_NETSTANDARD2_0%26x-client-ver%3D6.7.1.0 - - - 200 - text/html;+charset=utf-8 226.5611ms

[01:53:13 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.0 GET https://localhost/css/site.css - -

[01:53:13 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.0 GET https://localhost/lib/bootstrap/dist/css/bootstrap.min.css - -

[01:53:13 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.0 GET https://localhost/lib/jquery/dist/jquery.slim.min.js - -

[01:53:13 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.0 GET https://localhost/lib/bootstrap/dist/js/bootstrap.bundle.min.js - -

[01:53:13 Information] Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware
Sending file. Request path: '/css/site.css'. Physical path: '/app/wwwroot/css/site.css'

[01:53:13 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.0 GET https://localhost/css/site.css - - - 200 497 text/css 54.0189ms

[01:53:13 Information] Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware
Sending file. Request path: '/lib/bootstrap/dist/js/bootstrap.bundle.min.js'. Physical path: '/app/wwwroot/lib/bootstrap/dist/js/bootstrap.bundle.min.js'

[01:53:13 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.0 GET https://localhost/lib/bootstrap/dist/js/bootstrap.bundle.min.js - - - 200 80698 application/javascript 36.9036ms

[01:53:13 Information] Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware
Sending file. Request path: '/lib/jquery/dist/jquery.slim.min.js'. Physical path: '/app/wwwroot/lib/jquery/dist/jquery.slim.min.js'

[01:53:13 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.0 GET https://localhost/lib/jquery/dist/jquery.slim.min.js - - - 200 72397 application/javascript 63.6813ms

[01:53:13 Information] Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware
Sending file. Request path: '/lib/bootstrap/dist/css/bootstrap.min.css'. Physical path: '/app/wwwroot/lib/bootstrap/dist/css/bootstrap.min.css'

[01:53:13 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.0 GET https://localhost/lib/bootstrap/dist/css/bootstrap.min.css - - - 200 159515 text/css 76.3047ms

[01:53:13 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.0 GET https://localhost/favicon.ico - -

[01:53:13 Information] Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware
Sending file. Request path: '/favicon.ico'. Physical path: '/app/wwwroot/favicon.ico'

[01:53:13 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.0 GET https://localhost/favicon.ico - - - 200 1150 image/x-icon 18.3696ms

[01:53:38 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.0 POST https://localhost/Account/Login?ReturnUrl=%2Fconnect%2Fauthorize%2Fcallback%3Fclient_id%3DStarter.Bff%26redirect_uri%3Dhttps%253A%252F%252Flocalhost%252Fsignin-oidc%26response_type%3Dcode%26scope%3Dopenid%2520profile%2520Starter.Api%2520offline_access%26code_challenge%3DYPRm6pDJgB9UCZKDvHZV0I5s5rPnPlLrqPLGekRhpE4%26code_challenge_method%3DS256%26response_mode%3Dform_post%26nonce%3D638314627930249103.NmEwNzc2MTMtYzI1NC00YTllLWFjYTItOTRjZTU4MWZlZGQzZWViZmRiODUtNzdkNC00YWEyLWJmNzAtNTFiNThkNzM4Nzg3%26state%3DCfDJ8PJKEZ1uyltHi8IKXEkudMuaHSCP3rfk69L2U41P1RcJzX-0_1Lg5PlrDmNwhvVh3zuDtBFNNIFaMWXHiU76TcdpbN6pqorpgjT0zZl4NEBJaTKqXbwf-q8sXmWEOW4I6v5uePCEecb20pa9fkUvOWB_QwLA-Ts9sfhr3MqkDlWUhdgUSSZTLNqghoJEv_TnRkc4bxJbv7xkIxvAlftkW8haJIxSslxBUFTTb5EnBN47yV96PjCCH_Q6OFJ3xxV2x57PLUafpK4_w1mKBELyyDet2yLdEEe8m5li91DneU9I-cDK6YmiSIUoThEoyE3uB2vVWDJfNPXwDtvWiSnJLs1uc6dwjUnQA_j_axseCsLhSkOGlCysaqp95toNqqpgGPnZkX0vRbqtyw0ywhbwIZk%26x-client-SKU%3DID_NETSTANDARD2_0%26x-client-ver%3D6.7.1.0 application/x-www-form-urlencoded 1198

[01:53:38 Information] Microsoft.AspNetCore.Cors.Infrastructure.CorsService
CORS policy execution successful.

[01:53:38 Information] Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware
No CORS policy found for the specified request.

[01:53:38 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[01:53:38 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[01:53:38 Information] Microsoft.AspNetCore.Routing.EndpointMiddleware
Executing endpoint 'Starter.Idp.Controllers.Account.AccountController.Login (IDP)'

[01:53:38 Information] Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker
Route matched with {action = "Login", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(Starter.Idp.Models.Account.LoginInputModel, System.String) on controller Starter.Idp.Controllers.Account.AccountController (IDP).

[01:53:38 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[01:53:38 Debug] IdentityServer4.Validation.AuthorizeRequestValidator
Start authorize request protocol validation

[01:53:38 Debug] IdentityServer4.Stores.ValidatingClientStore
client configuration validation for client Starter.Bff succeeded.

[01:53:38 Debug] IdentityServer4.Validation.AuthorizeRequestValidator
Checking for PKCE parameters

[01:53:38 Debug] IdentityServer4.Validation.AuthorizeRequestValidator
Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator

[01:53:38 Information] Microsoft.EntityFrameworkCore.Infrastructure
Entity Framework Core 5.0.8 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None

[01:53:38 Information] Microsoft.EntityFrameworkCore.Database.Command
Executed DbCommand (1ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0

[01:53:38 Information] Microsoft.EntityFrameworkCore.Database.Command
Executed DbCommand (13ms) [Parameters=[@__user_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0

[01:53:38 Information] Microsoft.EntityFrameworkCore.Database.Command
Executed DbCommand (11ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0

[01:53:38 Debug] IdentityServer4.Hosting.IdentityServerAuthenticationService
Augmenting SignInContext

[01:53:38 Debug] IdentityServer4.Hosting.IdentityServerAuthenticationService
Adding idp claim with value: local

[01:53:38 Debug] IdentityServer4.Hosting.IdentityServerAuthenticationService
Adding auth_time claim with value: 1695866018

[01:53:38 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[01:53:38 Information] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application signed in.

[01:53:38 Information] Microsoft.EntityFrameworkCore.Database.Command
Executed DbCommand (1ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0

[01:53:38 Information] IdentityServer4.Events.DefaultEventService
{"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"4","DisplayName":"bob","Endpoint":"UI","ClientId":"Starter.Bff","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HMTVOMM7PL7T:00000002","TimeStamp":"2023-09-28T01:53:38.0000000Z","ProcessId":136,"LocalIpAddress":"172.18.0.4:5007","RemoteIpAddress":"172.18.0.1","$type":"UserLoginSuccessEvent"}

[01:53:38 Information] Microsoft.AspNetCore.Mvc.Infrastructure.RedirectResultExecutor
Executing RedirectResult, redirecting to /connect/authorize/callback?client_id=Starter.Bff&redirect_uri=https%3A%2F%2Flocalhost%2Fsignin-oidc&response_type=code&scope=openid%20profile%20Starter.Api%20offline_access&code_challenge=YPRm6pDJgB9UCZKDvHZV0I5s5rPnPlLrqPLGekRhpE4&code_challenge_method=S256&response_mode=form_post&nonce=638314627930249103.NmEwNzc2MTMtYzI1NC00YTllLWFjYTItOTRjZTU4MWZlZGQzZWViZmRiODUtNzdkNC00YWEyLWJmNzAtNTFiNThkNzM4Nzg3&state=CfDJ8PJKEZ1uyltHi8IKXEkudMuaHSCP3rfk69L2U41P1RcJzX-0_1Lg5PlrDmNwhvVh3zuDtBFNNIFaMWXHiU76TcdpbN6pqorpgjT0zZl4NEBJaTKqXbwf-q8sXmWEOW4I6v5uePCEecb20pa9fkUvOWB_QwLA-Ts9sfhr3MqkDlWUhdgUSSZTLNqghoJEv_TnRkc4bxJbv7xkIxvAlftkW8haJIxSslxBUFTTb5EnBN47yV96PjCCH_Q6OFJ3xxV2x57PLUafpK4_w1mKBELyyDet2yLdEEe8m5li91DneU9I-cDK6YmiSIUoThEoyE3uB2vVWDJfNPXwDtvWiSnJLs1uc6dwjUnQA_j_axseCsLhSkOGlCysaqp95toNqqpgGPnZkX0vRbqtyw0ywhbwIZk&x-client-SKU=ID_NETSTANDARD2_0&x-client-ver=6.7.1.0.

[01:53:38 Information] Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker
Executed action Starter.Idp.Controllers.Account.AccountController.Login (IDP) in 211.1205ms

[01:53:38 Information] Microsoft.AspNetCore.Routing.EndpointMiddleware
Executed endpoint 'Starter.Idp.Controllers.Account.AccountController.Login (IDP)'

[01:53:38 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.0 POST https://localhost/Account/Login?ReturnUrl=%2Fconnect%2Fauthorize%2Fcallback%3Fclient_id%3DStarter.Bff%26redirect_uri%3Dhttps%253A%252F%252Flocalhost%252Fsignin-oidc%26response_type%3Dcode%26scope%3Dopenid%2520profile%2520Starter.Api%2520offline_access%26code_challenge%3DYPRm6pDJgB9UCZKDvHZV0I5s5rPnPlLrqPLGekRhpE4%26code_challenge_method%3DS256%26response_mode%3Dform_post%26nonce%3D638314627930249103.NmEwNzc2MTMtYzI1NC00YTllLWFjYTItOTRjZTU4MWZlZGQzZWViZmRiODUtNzdkNC00YWEyLWJmNzAtNTFiNThkNzM4Nzg3%26state%3DCfDJ8PJKEZ1uyltHi8IKXEkudMuaHSCP3rfk69L2U41P1RcJzX-0_1Lg5PlrDmNwhvVh3zuDtBFNNIFaMWXHiU76TcdpbN6pqorpgjT0zZl4NEBJaTKqXbwf-q8sXmWEOW4I6v5uePCEecb20pa9fkUvOWB_QwLA-Ts9sfhr3MqkDlWUhdgUSSZTLNqghoJEv_TnRkc4bxJbv7xkIxvAlftkW8haJIxSslxBUFTTb5EnBN47yV96PjCCH_Q6OFJ3xxV2x57PLUafpK4_w1mKBELyyDet2yLdEEe8m5li91DneU9I-cDK6YmiSIUoThEoyE3uB2vVWDJfNPXwDtvWiSnJLs1uc6dwjUnQA_j_axseCsLhSkOGlCysaqp95toNqqpgGPnZkX0vRbqtyw0ywhbwIZk%26x-client-SKU%3DID_NETSTANDARD2_0%26x-client-ver%3D6.7.1.0 application/x-www-form-urlencoded 1198 - 302 0 - 239.0603ms

[01:53:38 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.0 GET https://localhost/connect/authorize/callback?client_id=Starter.Bff&redirect_uri=https%3A%2F%2Flocalhost%2Fsignin-oidc&response_type=code&scope=openid%20profile%20Starter.Api%20offline_access&code_challenge=YPRm6pDJgB9UCZKDvHZV0I5s5rPnPlLrqPLGekRhpE4&code_challenge_method=S256&response_mode=form_post&nonce=638314627930249103.NmEwNzc2MTMtYzI1NC00YTllLWFjYTItOTRjZTU4MWZlZGQzZWViZmRiODUtNzdkNC00YWEyLWJmNzAtNTFiNThkNzM4Nzg3&state=CfDJ8PJKEZ1uyltHi8IKXEkudMuaHSCP3rfk69L2U41P1RcJzX-0_1Lg5PlrDmNwhvVh3zuDtBFNNIFaMWXHiU76TcdpbN6pqorpgjT0zZl4NEBJaTKqXbwf-q8sXmWEOW4I6v5uePCEecb20pa9fkUvOWB_QwLA-Ts9sfhr3MqkDlWUhdgUSSZTLNqghoJEv_TnRkc4bxJbv7xkIxvAlftkW8haJIxSslxBUFTTb5EnBN47yV96PjCCH_Q6OFJ3xxV2x57PLUafpK4_w1mKBELyyDet2yLdEEe8m5li91DneU9I-cDK6YmiSIUoThEoyE3uB2vVWDJfNPXwDtvWiSnJLs1uc6dwjUnQA_j_axseCsLhSkOGlCysaqp95toNqqpgGPnZkX0vRbqtyw0ywhbwIZk&x-client-SKU=ID_NETSTANDARD2_0&x-client-ver=6.7.1.0 - -

[01:53:38 Information] Microsoft.AspNetCore.Cors.Infrastructure.CorsService
CORS policy execution successful.

[01:53:38 Information] Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware
No CORS policy found for the specified request.

[01:53:38 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was successfully authenticated.

[01:53:38 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was successfully authenticated.

[01:53:38 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /connect/authorize/callback matched to endpoint type Authorize

[01:53:38 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint

[01:53:38 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback

[01:53:38 Debug] IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
Start authorize callback request

[01:53:38 Debug] IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
User in authorize request: 4

[01:53:38 Debug] IdentityServer4.Validation.AuthorizeRequestValidator
Start authorize request protocol validation

[01:53:38 Debug] IdentityServer4.Stores.ValidatingClientStore
client configuration validation for client Starter.Bff succeeded.

[01:53:38 Debug] IdentityServer4.Validation.AuthorizeRequestValidator
Checking for PKCE parameters

[01:53:38 Debug] IdentityServer4.Validation.AuthorizeRequestValidator
Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator

[01:53:38 Debug] IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
ValidatedAuthorizeRequest
{"ClientId":"Starter.Bff","ClientName":null,"RedirectUri":"https://localhost/signin-oidc","AllowedRedirectUris":["https://localhost/signin-oidc","https://bff:5005/signin-oidc","https://localhost/loggedin"],"SubjectId":"4","ResponseType":"code","ResponseMode":"form_post","GrantType":"authorization_code","RequestedScopes":"openid profile Starter.Api offline_access","State":"CfDJ8PJKEZ1uyltHi8IKXEkudMuaHSCP3rfk69L2U41P1RcJzX-0_1Lg5PlrDmNwhvVh3zuDtBFNNIFaMWXHiU76TcdpbN6pqorpgjT0zZl4NEBJaTKqXbwf-q8sXmWEOW4I6v5uePCEecb20pa9fkUvOWB_QwLA-Ts9sfhr3MqkDlWUhdgUSSZTLNqghoJEv_TnRkc4bxJbv7xkIxvAlftkW8haJIxSslxBUFTTb5EnBN47yV96PjCCH_Q6OFJ3xxV2x57PLUafpK4_w1mKBELyyDet2yLdEEe8m5li91DneU9I-cDK6YmiSIUoThEoyE3uB2vVWDJfNPXwDtvWiSnJLs1uc6dwjUnQA_j_axseCsLhSkOGlCysaqp95toNqqpgGPnZkX0vRbqtyw0ywhbwIZk","UiLocales":null,"Nonce":"638314627930249103.NmEwNzc2MTMtYzI1NC00YTllLWFjYTItOTRjZTU4MWZlZGQzZWViZmRiODUtNzdkNC00YWEyLWJmNzAtNTFiNThkNzM4Nzg3","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"648EA5A59CFC827224D6BBC5450F0974","Raw":{"client_id":"Starter.Bff","redirect_uri":"https://localhost/signin-oidc","response_type":"code","scope":"openid profile Starter.Api offline_access","code_challenge":"YPRm6pDJgB9UCZKDvHZV0I5s5rPnPlLrqPLGekRhpE4","code_challenge_method":"S256","response_mode":"form_post","nonce":"638314627930249103.NmEwNzc2MTMtYzI1NC00YTllLWFjYTItOTRjZTU4MWZlZGQzZWViZmRiODUtNzdkNC00YWEyLWJmNzAtNTFiNThkNzM4Nzg3","state":"CfDJ8PJKEZ1uyltHi8IKXEkudMuaHSCP3rfk69L2U41P1RcJzX-0_1Lg5PlrDmNwhvVh3zuDtBFNNIFaMWXHiU76TcdpbN6pqorpgjT0zZl4NEBJaTKqXbwf-q8sXmWEOW4I6v5uePCEecb20pa9fkUvOWB_QwLA-Ts9sfhr3MqkDlWUhdgUSSZTLNqghoJEv_TnRkc4bxJbv7xkIxvAlftkW8haJIxSslxBUFTTb5EnBN47yV96PjCCH_Q6OFJ3xxV2x57PLUafpK4_w1mKBELyyDet2yLdEEe8m5li91DneU9I-cDK6YmiSIUoThEoyE3uB2vVWDJfNPXwDtvWiSnJLs1uc6dwjUnQA_j_axseCsLhSkOGlCysaqp95toNqqpgGPnZkX0vRbqtyw0ywhbwIZk","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"6.7.1.0"},"$type":"AuthorizeRequestValidationLog"}

[01:53:38 Information] Microsoft.EntityFrameworkCore.Infrastructure
Entity Framework Core 5.0.8 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None

[01:53:38 Information] Microsoft.EntityFrameworkCore.Database.Command
Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0

[01:53:38 Debug] IdentityServer4.Services.DefaultConsentService
Client is configured to not require consent, no consent is required

[01:53:38 Debug] IdentityServer4.ResponseHandling.AuthorizeResponseGenerator
Creating Authorization Code Flow response.

[01:53:38 Information] IdentityServer4.Events.DefaultEventService
{"ClientId":"Starter.Bff","ClientName":null,"RedirectUri":"https://localhost/signin-oidc","Endpoint":"Authorize","SubjectId":"4","Scopes":"openid profile Starter.Api offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****D69B","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HMTVOMM7PL7U:00000002","TimeStamp":"2023-09-28T01:53:38.0000000Z","ProcessId":136,"LocalIpAddress":"172.18.0.4:5007","RemoteIpAddress":"172.18.0.1","$type":"TokenIssuedSuccessEvent"}

[01:53:38 Debug] IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
Authorize endpoint response
{"SubjectId":"4","ClientId":"Starter.Bff","RedirectUri":"https://localhost/signin-oidc","State":"CfDJ8PJKEZ1uyltHi8IKXEkudMuaHSCP3rfk69L2U41P1RcJzX-0_1Lg5PlrDmNwhvVh3zuDtBFNNIFaMWXHiU76TcdpbN6pqorpgjT0zZl4NEBJaTKqXbwf-q8sXmWEOW4I6v5uePCEecb20pa9fkUvOWB_QwLA-Ts9sfhr3MqkDlWUhdgUSSZTLNqghoJEv_TnRkc4bxJbv7xkIxvAlftkW8haJIxSslxBUFTTb5EnBN47yV96PjCCH_Q6OFJ3xxV2x57PLUafpK4_w1mKBELyyDet2yLdEEe8m5li91DneU9I-cDK6YmiSIUoThEoyE3uB2vVWDJfNPXwDtvWiSnJLs1uc6dwjUnQA_j_axseCsLhSkOGlCysaqp95toNqqpgGPnZkX0vRbqtyw0ywhbwIZk","Scope":"openid profile Starter.Api offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}

[01:53:38 Debug] IdentityServer4.Hosting.IdentityServerAuthenticationService
Augmenting SignInContext

[01:53:38 Information] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application signed in.

[01:53:38 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.0 GET https://localhost/connect/authorize/callback?client_id=Starter.Bff&redirect_uri=https%3A%2F%2Flocalhost%2Fsignin-oidc&response_type=code&scope=openid%20profile%20Starter.Api%20offline_access&code_challenge=YPRm6pDJgB9UCZKDvHZV0I5s5rPnPlLrqPLGekRhpE4&code_challenge_method=S256&response_mode=form_post&nonce=638314627930249103.NmEwNzc2MTMtYzI1NC00YTllLWFjYTItOTRjZTU4MWZlZGQzZWViZmRiODUtNzdkNC00YWEyLWJmNzAtNTFiNThkNzM4Nzg3&state=CfDJ8PJKEZ1uyltHi8IKXEkudMuaHSCP3rfk69L2U41P1RcJzX-0_1Lg5PlrDmNwhvVh3zuDtBFNNIFaMWXHiU76TcdpbN6pqorpgjT0zZl4NEBJaTKqXbwf-q8sXmWEOW4I6v5uePCEecb20pa9fkUvOWB_QwLA-Ts9sfhr3MqkDlWUhdgUSSZTLNqghoJEv_TnRkc4bxJbv7xkIxvAlftkW8haJIxSslxBUFTTb5EnBN47yV96PjCCH_Q6OFJ3xxV2x57PLUafpK4_w1mKBELyyDet2yLdEEe8m5li91DneU9I-cDK6YmiSIUoThEoyE3uB2vVWDJfNPXwDtvWiSnJLs1uc6dwjUnQA_j_axseCsLhSkOGlCysaqp95toNqqpgGPnZkX0vRbqtyw0ywhbwIZk&x-client-SKU=ID_NETSTANDARD2_0&x-client-ver=6.7.1.0 - - - 200 - text/html;+charset=UTF-8 149.4764ms

[01:53:39 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.1 POST http://idp:5006/connect/token application/x-www-form-urlencoded 251

[01:53:39 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[01:53:39 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[01:53:39 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /connect/token matched to endpoint type Token

[01:53:39 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint

[01:53:39 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token

[01:53:39 Debug] IdentityServer4.Endpoints.TokenEndpoint
Start token request.

[01:53:39 Debug] IdentityServer4.Validation.ClientSecretValidator
Start client validation

[01:53:39 Debug] IdentityServer4.Validation.BasicAuthenticationSecretParser
Start parsing Basic Authentication secret

[01:53:39 Debug] IdentityServer4.Validation.PostBodySecretParser
Start parsing for secret in post body

[01:53:39 Debug] IdentityServer4.Validation.ISecretsListParser
Parser found secret: PostBodySecretParser

[01:53:39 Debug] IdentityServer4.Validation.ISecretsListParser
Secret id found: Starter.Bff

[01:53:39 Debug] IdentityServer4.Stores.ValidatingClientStore
client configuration validation for client Starter.Bff succeeded.

[01:53:39 Debug] IdentityServer4.Validation.ISecretsListValidator
Secret validator success: HashedSharedSecretValidator

[01:53:39 Debug] IdentityServer4.Validation.ClientSecretValidator
Client validation success

[01:53:39 Information] IdentityServer4.Events.DefaultEventService
{"ClientId":"Starter.Bff","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HMTVOMM7PL7L:00000004","TimeStamp":"2023-09-28T01:53:39.0000000Z","ProcessId":136,"LocalIpAddress":"172.18.0.4:5006","RemoteIpAddress":"172.18.0.5","$type":"ClientAuthenticationSuccessEvent"}

[01:53:39 Debug] IdentityServer4.Validation.TokenRequestValidator
Start token request validation

[01:53:39 Debug] IdentityServer4.Validation.TokenRequestValidator
Start validation of authorization code token request

[01:53:39 Debug] IdentityServer4.Validation.TokenRequestValidator
Client required a proof key for code exchange. Starting PKCE validation

[01:53:39 Information] Microsoft.EntityFrameworkCore.Infrastructure
Entity Framework Core 5.0.8 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None

[01:53:39 Information] Microsoft.EntityFrameworkCore.Database.Command
Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0

[01:53:39 Debug] IdentityServer4.Validation.TokenRequestValidator
Validation of authorization code token request success

[01:53:39 Information] IdentityServer4.Validation.TokenRequestValidator
Token request validation success, {"ClientId":"Starter.Bff","ClientName":null,"GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"****D69B","RefreshToken":"********","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"Starter.Bff","client_secret":"***REDACTED***","code":"831AE0565ABED4170AF7069D059662E602778225DE9AE069441142B5E900D69B","grant_type":"authorization_code","redirect_uri":"https://localhost/signin-oidc","code_verifier":"qWq3WuAHouxJZl5_HJdbpL5ixIIFfc4ICc79RDDRNno"},"$type":"TokenRequestValidationLog"}

[01:53:39 Debug] IdentityServer4.Stores.ValidatingClientStore
client configuration validation for client Starter.Bff succeeded.

[01:53:39 Debug] IdentityServer4.Services.DefaultClaimsService
Getting claims for access token for client: Starter.Bff

[01:53:39 Debug] IdentityServer4.Services.DefaultClaimsService
Getting claims for access token for subject: 4

[01:53:39 Information] Microsoft.EntityFrameworkCore.Database.Command
Executed DbCommand (1ms) [Parameters=[@__user_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0

[01:53:39 Information] Microsoft.EntityFrameworkCore.Database.Command
Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0

[01:53:39 Debug] IdentityServer4.Services.DefaultRefreshTokenService
Creating refresh token

[01:53:39 Debug] IdentityServer4.Services.DefaultRefreshTokenService
Setting an absolute lifetime: 2592000

[01:53:39 Debug] IdentityServer4.Stores.ValidatingClientStore
client configuration validation for client Starter.Bff succeeded.

[01:53:39 Debug] IdentityServer4.Services.DefaultClaimsService
Getting claims for identity token for subject: 4 and client: Starter.Bff

[01:53:39 Debug] IdentityServer4.Services.DefaultClaimsService
In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.

[01:53:39 Information] IdentityServer4.Events.DefaultEventService
{"ClientId":"Starter.Bff","ClientName":null,"RedirectUri":null,"Endpoint":"Token","SubjectId":"4","Scopes":"openid profile Starter.Api offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****LnOg","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****F5D5","$type":"Token"},{"TokenType":"access_token","TokenValue":"****ICNg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HMTVOMM7PL7L:00000004","TimeStamp":"2023-09-28T01:53:39.0000000Z","ProcessId":136,"LocalIpAddress":"172.18.0.4:5006","RemoteIpAddress":"172.18.0.5","$type":"TokenIssuedSuccessEvent"}

[01:53:39 Debug] IdentityServer4.Endpoints.TokenEndpoint
Token request success.

[01:53:39 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.1 POST http://idp:5006/connect/token application/x-www-form-urlencoded 251 - 200 - application/json;+charset=UTF-8 253.6925ms

[01:53:39 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.1 GET http://idp:5006/connect/userinfo - -

[01:53:39 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[01:53:39 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[01:53:39 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /connect/userinfo matched to endpoint type Userinfo

[01:53:39 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint

[01:53:39 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo

[01:53:39 Debug] IdentityServer4.Endpoints.UserInfoEndpoint
Start userinfo request

[01:53:39 Debug] IdentityServer4.Validation.BearerTokenUsageValidator
Bearer token found in header

[01:53:39 Debug] IdentityServer4.Stores.ValidatingClientStore
client configuration validation for client Starter.Bff succeeded.

[01:53:39 Debug] IdentityServer4.Stores.ValidatingClientStore
client configuration validation for client Starter.Bff succeeded.

[01:53:39 Information] Microsoft.EntityFrameworkCore.Infrastructure
Entity Framework Core 5.0.8 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None

[01:53:39 Information] Microsoft.EntityFrameworkCore.Database.Command
Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0

[01:53:39 Debug] IdentityServer4.Validation.TokenValidator
Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator

[01:53:39 Debug] IdentityServer4.Validation.TokenValidator
Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":"3C9D146DB121C2310529C2749BA884FF","Claims":{"nbf":1695866019,"exp":1695869619,"iss":"https://localhost","aud":["starter.api","https://localhost/resources"],"client_id":"Starter.Bff","sub":"4","auth_time":1695866018,"idp":"local","jti":"3C9D146DB121C2310529C2749BA884FF","sid":"648EA5A59CFC827224D6BBC5450F0974","iat":1695866019,"scope":["openid","profile","Starter.Api","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}

[01:53:39 Debug] IdentityServer4.ResponseHandling.UserInfoResponseGenerator
Creating userinfo response

[01:53:39 Debug] IdentityServer4.ResponseHandling.UserInfoResponseGenerator
Scopes in access token: openid profile Starter.Api offline_access

[01:53:39 Debug] IdentityServer4.ResponseHandling.UserInfoResponseGenerator
Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at

[01:53:39 Information] Microsoft.EntityFrameworkCore.Database.Command
Executed DbCommand (2ms) [Parameters=[@__user_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0

[01:53:39 Information] Microsoft.EntityFrameworkCore.Database.Command
Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0

[01:53:39 Information] IdentityServer4.ResponseHandling.UserInfoResponseGenerator
Profile service returned the following claim types: sub website family_name given_name name preferred_username

[01:53:39 Debug] IdentityServer4.Endpoints.UserInfoEndpoint
End userinfo request

[01:53:39 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.1 GET http://idp:5006/connect/userinfo - - - 200 - application/json;+charset=UTF-8 75.4545ms

[01:53:39 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration - -

[01:53:39 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[01:53:39 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[01:53:39 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /.well-known/openid-configuration matched to endpoint type Discovery

[01:53:39 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint

[01:53:39 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration

[01:53:39 Debug] IdentityServer4.Endpoints.DiscoveryEndpoint
Start discovery request

[01:53:39 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 8.0021ms

[01:53:39 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration/jwks - -

[01:53:39 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[01:53:39 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[01:53:39 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery

[01:53:39 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint

[01:53:39 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks

[01:53:39 Debug] IdentityServer4.Endpoints.DiscoveryKeyEndpoint
Start key discovery request

[01:53:39 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 4.9869ms

[01:53:39 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.1 GET http://idp:5006/connect/userinfo - -

[01:53:39 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[01:53:39 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[01:53:39 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /connect/userinfo matched to endpoint type Userinfo

[01:53:39 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint

[01:53:39 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo

[01:53:39 Debug] IdentityServer4.Endpoints.UserInfoEndpoint
Start userinfo request

[01:53:39 Debug] IdentityServer4.Validation.BearerTokenUsageValidator
Bearer token found in header

[01:53:39 Debug] IdentityServer4.Stores.ValidatingClientStore
client configuration validation for client Starter.Bff succeeded.

[01:53:39 Debug] IdentityServer4.Stores.ValidatingClientStore
client configuration validation for client Starter.Bff succeeded.

[01:53:39 Information] Microsoft.EntityFrameworkCore.Infrastructure
Entity Framework Core 5.0.8 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None

[01:53:39 Information] Microsoft.EntityFrameworkCore.Database.Command
Executed DbCommand (9ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0

[01:53:39 Debug] IdentityServer4.Validation.TokenValidator
Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator

[01:53:39 Debug] IdentityServer4.Validation.TokenValidator
Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":"3C9D146DB121C2310529C2749BA884FF","Claims":{"nbf":1695866019,"exp":1695869619,"iss":"https://localhost","aud":["starter.api","https://localhost/resources"],"client_id":"Starter.Bff","sub":"4","auth_time":1695866018,"idp":"local","jti":"3C9D146DB121C2310529C2749BA884FF","sid":"648EA5A59CFC827224D6BBC5450F0974","iat":1695866019,"scope":["openid","profile","Starter.Api","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}

[01:53:39 Debug] IdentityServer4.ResponseHandling.UserInfoResponseGenerator
Creating userinfo response

[01:53:39 Debug] IdentityServer4.ResponseHandling.UserInfoResponseGenerator
Scopes in access token: openid profile Starter.Api offline_access

[01:53:39 Debug] IdentityServer4.ResponseHandling.UserInfoResponseGenerator
Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at

[01:53:39 Information] Microsoft.EntityFrameworkCore.Database.Command
Executed DbCommand (6ms) [Parameters=[@__user_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0

[01:53:39 Information] Microsoft.EntityFrameworkCore.Database.Command
Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0

[01:53:39 Information] IdentityServer4.ResponseHandling.UserInfoResponseGenerator
Profile service returned the following claim types: sub website family_name given_name name preferred_username

[01:53:39 Debug] IdentityServer4.Endpoints.UserInfoEndpoint
End userinfo request

[01:53:39 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.1 GET http://idp:5006/connect/userinfo - - - 200 - application/json;+charset=UTF-8 69.1551ms

[01:53:48 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.0 GET https://localhost/connect/endsession?post_logout_redirect_uri=https%3A%2F%2Flocalhost%2Fsignout-callback-oidc&id_token_hint=eyJhbGciOiJSUzI1NiIsImtpZCI6Ijg1RTc3MDAyODhFOUFCMkRBOEJFODA4QkEyREZGRTZDIiwidHlwIjoiSldUIn0.eyJuYmYiOjE2OTU4NjYwMTksImV4cCI6MTY5NTg2NjMxOSwiaXNzIjoiaHR0cHM6Ly9sb2NhbGhvc3QiLCJhdWQiOiJTdGFydGVyLkJmZiIsIm5vbmNlIjoiNjM4MzE0NjI3OTMwMjQ5MTAzLk5tRXdOemMyTVRNdFl6STFOQzAwWVRsbExXRmpZVEl0T1RSalpUVTRNV1psWkdRelpXVmlabVJpT0RVdE56ZGtOQzAwWVdFeUxXSm1OekF0TlRGaU5UaGtOek00TnpnMyIsImlhdCI6MTY5NTg2NjAxOSwiYXRfaGFzaCI6ImJjbnlJSmY1b29QLXB3WEk4YzUyMHciLCJzX2hhc2giOiJDUjZuc0ZUWkZEaVNGc2JIN01za0h3Iiwic2lkIjoiNjQ4RUE1QTU5Q0ZDODI3MjI0RDZCQkM1NDUwRjA5NzQiLCJzdWIiOiI0IiwiYXV0aF90aW1lIjoxNjk1ODY2MDE4LCJpZHAiOiJsb2NhbCIsImFtciI6WyJwd2QiXX0.VD8cDr8F6JiKyOnv_6XxsO7v7a3-zvH3JiaWTibLahQ3vA0CtD34o2fZZnmj2llyPsKms4lMv5vpD1t84D1JVrTaRzBrpw8kZjU2WCJ5Tt3b4Q328wLW-FfZv1pqlcpqDNnB65tFcCtd01AVGsfnV3yWr6TZzW6wVoqAGtH1iznEspRgitzcDykbvzOSBznOoP0uBYEf33c3-194MlaKWWvyPLEo34pxDIJceTzHjpiL2qAcPOgyZqzMGtxQlsImWW6XbinCev30eHB0hJB1ePcIH-1Zra4GRH1lsfwRYSy6lllLpZ2Xu83nm9xsvdEx8NVMUUN9mAnET2sScXLnOg&state=CfDJ8PJKEZ1uyltHi8IKXEkudMsk_C5R_dKfs_P-xLlE1HjCWkNR9oWEkQby3INfb5o4M3gNSbwKBXX4S0qMvYGic97tV6N3snRH0A1l9nNwraL5UqgepeKjL7JomLHVJNj_I34jik2leobT4WnJTVScin_8ZbXX09ztNtaEYiAxB-NF&x-client-SKU=ID_NETSTANDARD2_0&x-client-ver=6.7.1.0 - -

[01:53:48 Information] Microsoft.AspNetCore.Cors.Infrastructure.CorsService
CORS policy execution successful.

[01:53:48 Information] Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware
No CORS policy found for the specified request.

[01:53:48 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was successfully authenticated.

[01:53:48 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was successfully authenticated.

[01:53:48 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /connect/endsession matched to endpoint type Endsession

[01:53:48 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint

[01:53:48 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession

[01:53:48 Debug] IdentityServer4.Endpoints.EndSessionEndpoint
Processing signout request for 4

[01:53:48 Debug] IdentityServer4.Validation.EndSessionRequestValidator
Start end session request validation

[01:53:48 Debug] IdentityServer4.Validation.TokenValidator
Start identity token validation

[01:53:48 Debug] IdentityServer4.Stores.ValidatingClientStore
client configuration validation for client Starter.Bff succeeded.

[01:53:48 Debug] IdentityServer4.Validation.TokenValidator
Client found: Starter.Bff / null

[01:53:48 Debug] IdentityServer4.Validation.TokenValidator
Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator

[01:53:48 Debug] IdentityServer4.Validation.TokenValidator
Token validation success
{"ClientId":"Starter.Bff","ClientName":null,"ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1695866019,"exp":1695866319,"iss":"https://localhost","aud":"Starter.Bff","nonce":"638314627930249103.NmEwNzc2MTMtYzI1NC00YTllLWFjYTItOTRjZTU4MWZlZGQzZWViZmRiODUtNzdkNC00YWEyLWJmNzAtNTFiNThkNzM4Nzg3","iat":1695866019,"at_hash":"bcnyIJf5ooP-pwXI8c520w","s_hash":"CR6nsFTZFDiSFsbH7MskHw","sid":"648EA5A59CFC827224D6BBC5450F0974","sub":"4","auth_time":1695866018,"idp":"local","amr":"pwd"},"$type":"TokenValidationLog"}

[01:53:48 Information] IdentityServer4.Validation.EndSessionRequestValidator
End session request validation success
{"ClientId":"Starter.Bff","ClientName":null,"SubjectId":"4","PostLogOutUri":"https://localhost/signout-callback-oidc","State":"CfDJ8PJKEZ1uyltHi8IKXEkudMsk_C5R_dKfs_P-xLlE1HjCWkNR9oWEkQby3INfb5o4M3gNSbwKBXX4S0qMvYGic97tV6N3snRH0A1l9nNwraL5UqgepeKjL7JomLHVJNj_I34jik2leobT4WnJTVScin_8ZbXX09ztNtaEYiAxB-NF","Raw":{"post_logout_redirect_uri":"https://localhost/signout-callback-oidc","id_token_hint":"***REDACTED***","state":"CfDJ8PJKEZ1uyltHi8IKXEkudMsk_C5R_dKfs_P-xLlE1HjCWkNR9oWEkQby3INfb5o4M3gNSbwKBXX4S0qMvYGic97tV6N3snRH0A1l9nNwraL5UqgepeKjL7JomLHVJNj_I34jik2leobT4WnJTVScin_8ZbXX09ztNtaEYiAxB-NF","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"6.7.1.0"},"$type":"EndSessionRequestValidationLog"}

[01:53:48 Debug] IdentityServer4.Endpoints.EndSessionEndpoint
Success validating end session request from Starter.Bff

[01:53:48 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.0 GET https://localhost/connect/endsession?post_logout_redirect_uri=https%3A%2F%2Flocalhost%2Fsignout-callback-oidc&id_token_hint=eyJhbGciOiJSUzI1NiIsImtpZCI6Ijg1RTc3MDAyODhFOUFCMkRBOEJFODA4QkEyREZGRTZDIiwidHlwIjoiSldUIn0.eyJuYmYiOjE2OTU4NjYwMTksImV4cCI6MTY5NTg2NjMxOSwiaXNzIjoiaHR0cHM6Ly9sb2NhbGhvc3QiLCJhdWQiOiJTdGFydGVyLkJmZiIsIm5vbmNlIjoiNjM4MzE0NjI3OTMwMjQ5MTAzLk5tRXdOemMyTVRNdFl6STFOQzAwWVRsbExXRmpZVEl0T1RSalpUVTRNV1psWkdRelpXVmlabVJpT0RVdE56ZGtOQzAwWVdFeUxXSm1OekF0TlRGaU5UaGtOek00TnpnMyIsImlhdCI6MTY5NTg2NjAxOSwiYXRfaGFzaCI6ImJjbnlJSmY1b29QLXB3WEk4YzUyMHciLCJzX2hhc2giOiJDUjZuc0ZUWkZEaVNGc2JIN01za0h3Iiwic2lkIjoiNjQ4RUE1QTU5Q0ZDODI3MjI0RDZCQkM1NDUwRjA5NzQiLCJzdWIiOiI0IiwiYXV0aF90aW1lIjoxNjk1ODY2MDE4LCJpZHAiOiJsb2NhbCIsImFtciI6WyJwd2QiXX0.VD8cDr8F6JiKyOnv_6XxsO7v7a3-zvH3JiaWTibLahQ3vA0CtD34o2fZZnmj2llyPsKms4lMv5vpD1t84D1JVrTaRzBrpw8kZjU2WCJ5Tt3b4Q328wLW-FfZv1pqlcpqDNnB65tFcCtd01AVGsfnV3yWr6TZzW6wVoqAGtH1iznEspRgitzcDykbvzOSBznOoP0uBYEf33c3-194MlaKWWvyPLEo34pxDIJceTzHjpiL2qAcPOgyZqzMGtxQlsImWW6XbinCev30eHB0hJB1ePcIH-1Zra4GRH1lsfwRYSy6lllLpZ2Xu83nm9xsvdEx8NVMUUN9mAnET2sScXLnOg&state=CfDJ8PJKEZ1uyltHi8IKXEkudMsk_C5R_dKfs_P-xLlE1HjCWkNR9oWEkQby3INfb5o4M3gNSbwKBXX4S0qMvYGic97tV6N3snRH0A1l9nNwraL5UqgepeKjL7JomLHVJNj_I34jik2leobT4WnJTVScin_8ZbXX09ztNtaEYiAxB-NF&x-client-SKU=ID_NETSTANDARD2_0&x-client-ver=6.7.1.0 - - - 302 0 - 25.4175ms

[01:53:48 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.0 GET https://localhost/Account/Logout?logoutId=CfDJ8Kl_Yj3D88dBq0mZb0zHrIFoRTLYSSnwS00Cofs6TVsSgT1Qkicgnu1nM2wNl3kttZiTueT5NNuqgDlHSu0PBFXXLhH69onC3MC3J1CyV3b64SKE5mCo2B8tcRpdW4JTwJZB7swLFbquMrejcKGBL_8r9zOBHUXoP494ymBxt0yHt2aB1arvt8GpKN8bIvnOOBQn3_XYy5Pr6trHUBlq0DjpPaOsSSpmmy8QNrCBrAf-lFOdJdQHFLbGJVaZgnqdA0GK2mjGJkNn1lPMAWHnFsyfPymdD1_QDhdXc4y27XrBWll58Hbs5d-W341RLKLEM59nKikDVPEW2kd5_dwYJRxi4NSJIARcyculFRO2dmd6bEs6Rg5sisTohc8fFBzo6ct2nsOMT8O2g3sMPX-9F9JwbW8dxLyq4ciqLGO-kliZ-krM0rNhWj06toM5pVNj2R2iVU5MpDoxUGd85jr39CYGJlbxTRcsbZLqMiu8Uxx_717TI1ka8HbQDBkavLjSPrcx55w9YLLShlzKZtcuqvnFzgyaCABm1W8XZs_b6AiQ2_ZZ4nm5rlLGHAukx6-MgwubI05vMm_D7hzXOlLVhcMjCKPYCes4XBv172R0JkL506Iu1LW4KY0484_GJ5eN8QuKyu366czS7ztEYDOlgdLL6hKjhZ4Hs1bS2HLB5Zs4pcDQ8Xzrv78e24SRwaW3F77a0QN46mFrKQplW--J_gzlFFZ_OaF9H_poLoxyMgll0-YCAW8LOol4JrkNMhBZyA - -

[01:53:48 Information] Microsoft.AspNetCore.Cors.Infrastructure.CorsService
CORS policy execution successful.

[01:53:48 Information] Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware
No CORS policy found for the specified request.

[01:53:48 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was successfully authenticated.

[01:53:48 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was successfully authenticated.

[01:53:48 Information] Microsoft.AspNetCore.Routing.EndpointMiddleware
Executing endpoint 'Starter.Idp.Controllers.Account.AccountController.Logout (IDP)'

[01:53:48 Information] Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker
Route matched with {action = "Logout", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Logout(System.String) on controller Starter.Idp.Controllers.Account.AccountController (IDP).

[01:53:48 Information] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application signed out.

[01:53:48 Information] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.External signed out.

[01:53:48 Information] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.TwoFactorUserId signed out.

[01:53:48 Information] IdentityServer4.Events.DefaultEventService
{"SubjectId":"4","DisplayName":"Bob Smith","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HMTVOMM7PL82:00000002","TimeStamp":"2023-09-28T01:53:48.0000000Z","ProcessId":136,"LocalIpAddress":"172.18.0.4:5007","RemoteIpAddress":"172.18.0.1","$type":"UserLogoutSuccessEvent"}

[01:53:48 Information] Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor
Executing ViewResult, running view LoggedOut.

[01:53:48 Debug] IdentityServer4.Hosting.IdentityServerMiddleware
SignOutCalled set; processing post-signout session cleanup.

[01:53:48 Debug] IdentityServer4.Stores.ValidatingClientStore
client configuration validation for client Starter.Bff succeeded.

[01:53:48 Debug] IdentityServer4.Services.LogoutNotificationService
No client back-channel logout URLs

[01:53:48 Information] Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor
Executed ViewResult - view LoggedOut executed in 16.6913ms.

[01:53:48 Information] Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker
Executed action Starter.Idp.Controllers.Account.AccountController.Logout (IDP) in 75.2251ms

[01:53:48 Information] Microsoft.AspNetCore.Routing.EndpointMiddleware
Executed endpoint 'Starter.Idp.Controllers.Account.AccountController.Logout (IDP)'

[01:53:48 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.0 GET https://localhost/Account/Logout?logoutId=CfDJ8Kl_Yj3D88dBq0mZb0zHrIFoRTLYSSnwS00Cofs6TVsSgT1Qkicgnu1nM2wNl3kttZiTueT5NNuqgDlHSu0PBFXXLhH69onC3MC3J1CyV3b64SKE5mCo2B8tcRpdW4JTwJZB7swLFbquMrejcKGBL_8r9zOBHUXoP494ymBxt0yHt2aB1arvt8GpKN8bIvnOOBQn3_XYy5Pr6trHUBlq0DjpPaOsSSpmmy8QNrCBrAf-lFOdJdQHFLbGJVaZgnqdA0GK2mjGJkNn1lPMAWHnFsyfPymdD1_QDhdXc4y27XrBWll58Hbs5d-W341RLKLEM59nKikDVPEW2kd5_dwYJRxi4NSJIARcyculFRO2dmd6bEs6Rg5sisTohc8fFBzo6ct2nsOMT8O2g3sMPX-9F9JwbW8dxLyq4ciqLGO-kliZ-krM0rNhWj06toM5pVNj2R2iVU5MpDoxUGd85jr39CYGJlbxTRcsbZLqMiu8Uxx_717TI1ka8HbQDBkavLjSPrcx55w9YLLShlzKZtcuqvnFzgyaCABm1W8XZs_b6AiQ2_ZZ4nm5rlLGHAukx6-MgwubI05vMm_D7hzXOlLVhcMjCKPYCes4XBv172R0JkL506Iu1LW4KY0484_GJ5eN8QuKyu366czS7ztEYDOlgdLL6hKjhZ4Hs1bS2HLB5Zs4pcDQ8Xzrv78e24SRwaW3F77a0QN46mFrKQplW--J_gzlFFZ_OaF9H_poLoxyMgll0-YCAW8LOol4JrkNMhBZyA - - - 200 - text/html;+charset=utf-8 94.9638ms

[01:53:48 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.0 GET https://localhost/connect/endsession/callback?endSessionId=CfDJ8Kl_Yj3D88dBq0mZb0zHrIGu0o0tabVZYC_hbFk4wcL1ANd1msiuOUjxtagLBfWnwI2SEs81rcRtAJG7Ugc_DfvA5BSRiAiQEvmhUII_MM8ns_udROMzI2uiPuFiJkpetOB6-mjtZGvyhdWqZZmE7J13KZoMDCrIvKNOcyfWFmDdmbc-nK-brHVmbsPodOWx3ahhi6B7kj0vmS2WYLLR3Qd1GGKhED-JHsER34TtZVcg-mHJsEvt_CLzX9Y67rN_bFwF_YVSACAGxAOQu6jGI5ly1xFMMwqra8NcYJb7oIuk - -

[01:53:48 Information] Microsoft.AspNetCore.Cors.Infrastructure.CorsService
CORS policy execution successful.

[01:53:48 Information] Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware
No CORS policy found for the specified request.

[01:53:48 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[01:53:48 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[01:53:48 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /connect/endsession/callback matched to endpoint type Endsession

[01:53:48 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint

[01:53:48 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback

[01:53:48 Debug] IdentityServer4.Endpoints.EndSessionCallbackEndpoint
Processing signout callback request

[01:53:48 Debug] IdentityServer4.Stores.ValidatingClientStore
client configuration validation for client Starter.Bff succeeded.

[01:53:48 Debug] IdentityServer4.Services.LogoutNotificationService
No client front-channel logout URLs

[01:53:48 Information] IdentityServer4.Endpoints.EndSessionCallbackEndpoint
Successful signout callback.

[01:53:48 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.0 GET https://localhost/connect/endsession/callback?endSessionId=CfDJ8Kl_Yj3D88dBq0mZb0zHrIGu0o0tabVZYC_hbFk4wcL1ANd1msiuOUjxtagLBfWnwI2SEs81rcRtAJG7Ugc_DfvA5BSRiAiQEvmhUII_MM8ns_udROMzI2uiPuFiJkpetOB6-mjtZGvyhdWqZZmE7J13KZoMDCrIvKNOcyfWFmDdmbc-nK-brHVmbsPodOWx3ahhi6B7kj0vmS2WYLLR3Qd1GGKhED-JHsER34TtZVcg-mHJsEvt_CLzX9Y67rN_bFwF_YVSACAGxAOQu6jGI5ly1xFMMwqra8NcYJb7oIuk - - - 200 - text/html;+charset=UTF-8 60.6274ms


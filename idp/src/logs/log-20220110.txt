[02:04:38 Information] 
Starting host...

[02:04:38 Warning] Microsoft.AspNetCore.DataProtection.Repositories.FileSystemXmlRepository
Storing keys in a directory '/root/.aspnet/DataProtection-Keys' that may not be persisted outside of the container. Protected data will be unavailable when container is destroyed.

[02:04:38 Information] Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager
User profile is available. Using '/root/.aspnet/DataProtection-Keys' as key repository; keys will not be encrypted at rest.

[02:04:38 Information] Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager
Creating key {9b73762d-208d-4b9f-961c-719d05e207b2} with creation date 2022-01-10 02:04:38Z, activation date 2022-01-10 02:04:38Z, and expiration date 2022-04-10 02:04:38Z.

[02:04:38 Warning] Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager
No XML encryptor configured. Key {9b73762d-208d-4b9f-961c-719d05e207b2} may be persisted to storage in unencrypted form.

[02:04:38 Information] Microsoft.AspNetCore.DataProtection.Repositories.FileSystemXmlRepository
Writing data to file '/root/.aspnet/DataProtection-Keys/key-9b73762d-208d-4b9f-961c-719d05e207b2.xml'.

[02:04:40 Debug] 
alice already exists

[02:04:40 Debug] 
bob already exists

[02:04:40 Information] IdentityServer4.Startup
Starting IdentityServer4 version 4.1.2+997a6cdd643e46cd5762b710c4ddc43574cbec2e

[02:04:40 Information] IdentityServer4.Startup
You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.

[02:04:40 Debug] IdentityServer4.Startup
Custom IssuerUri set to https://localhost

[02:04:40 Information] IdentityServer4.Startup
Using the default authentication scheme Identity.Application for IdentityServer

[02:04:40 Debug] IdentityServer4.Startup
Using Identity.Application as default ASP.NET Core scheme for authentication

[02:04:40 Debug] IdentityServer4.Startup
Using Identity.External as default ASP.NET Core scheme for sign-in

[02:04:40 Debug] IdentityServer4.Startup
Using Identity.External as default ASP.NET Core scheme for sign-out

[02:04:40 Debug] IdentityServer4.Startup
Using Identity.Application as default ASP.NET Core scheme for challenge

[02:04:40 Debug] IdentityServer4.Startup
Using Identity.Application as default ASP.NET Core scheme for forbid

[02:04:40 Warning] Microsoft.AspNetCore.Server.Kestrel
Overriding address(es) 'https://localhost:5001, http://localhost:5000'. Binding to endpoints defined in UseKestrel() instead.

[02:04:40 Information] Microsoft.Hosting.Lifetime
Now listening on: http://0.0.0.0:5006

[02:04:40 Information] Microsoft.Hosting.Lifetime
Now listening on: https://0.0.0.0:5007

[02:04:40 Information] Microsoft.Hosting.Lifetime
Application started. Press Ctrl+C to shut down.

[02:04:40 Information] Microsoft.Hosting.Lifetime
Hosting environment: Development

[02:04:40 Information] Microsoft.Hosting.Lifetime
Content root path: /app

[02:22:12 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration - -

[02:22:12 Debug] IdentityServer4.Startup
Login Url: /Account/Login

[02:22:12 Debug] IdentityServer4.Startup
Login Return Url Parameter: ReturnUrl

[02:22:12 Debug] IdentityServer4.Startup
Logout Url: /Account/Logout

[02:22:12 Debug] IdentityServer4.Startup
ConsentUrl Url: /consent

[02:22:12 Debug] IdentityServer4.Startup
Consent Return Url Parameter: returnUrl

[02:22:12 Debug] IdentityServer4.Startup
Error Url: /home/error

[02:22:12 Debug] IdentityServer4.Startup
Error Id Parameter: errorId

[02:22:12 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[02:22:12 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[02:22:12 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /.well-known/openid-configuration matched to endpoint type Discovery

[02:22:12 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint

[02:22:12 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration

[02:22:12 Debug] IdentityServer4.Endpoints.DiscoveryEndpoint
Start discovery request

[02:22:12 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 106.0937ms

[02:22:12 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration/jwks - -

[02:22:12 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[02:22:12 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[02:22:12 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery

[02:22:12 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint

[02:22:12 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks

[02:22:12 Debug] IdentityServer4.Endpoints.DiscoveryKeyEndpoint
Start key discovery request

[02:22:13 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 33.2091ms

[02:22:13 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.0 GET https://localhost/connect/authorize?client_id=Starter.Bff&redirect_uri=https%3A%2F%2Flocalhost%2Fsignin-oidc&response_type=code&scope=openid%20profile%20Starter.Api%20offline_access&code_challenge=rTpiWLerseh9H8YcRlwffuXWbDgNvKPXwk-18MfhtJw&code_challenge_method=S256&response_mode=form_post&nonce=637773781330355890.Zjc1ZGE2MjUtY2Q5Ny00MTkxLWJkZTItMWEyNzlhOGUyOTkxNTI4MGQ1M2MtMDRkYi00NmNiLWE1YWMtMGEwZmI2OWJhNmI5&state=CfDJ8B_OL-oYhMtAppB-AJAKkXqq5DT3sDEJnxutmCXrQc8NIX2Q0XcZqQOXxpbr2P0GDE5GPjQfZhLfSLUgfLylX0jAEYaCxmWFuxLbSwWNAOApszDBoXQdF8rWBnvQgLzVDPK1Qm0pXLpDXhPqhW3avvet90m-etYc3082k_-tTOOvKjOTnaPvZralHCF1uQZk8Aqu7nqOfQA5yH6Zr9lFxXEtvllHyfIN3yJQ3AwgvceeuIWUUtqQ3TOE5WDKXJO2GIS-1tyw6XpZ_9ldK9uFyV5pv9tMA9211QVBHfghYkGOcmExWUmOrlb0ya-ulFvT38OLzKZKhVbgjHUbPmaQkjd6I4Be92K5I4TkgnOo8KDjOgfjrLbJUMGw5ZyfAPCatmeaKSj0QatV0zWiY32_ceo&x-client-SKU=ID_NETSTANDARD2_0&x-client-ver=6.7.1.0 - -

[02:22:13 Information] Microsoft.AspNetCore.Cors.Infrastructure.CorsService
CORS policy execution successful.

[02:22:13 Information] Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware
No CORS policy found for the specified request.

[02:22:13 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[02:22:13 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[02:22:13 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /connect/authorize matched to endpoint type Authorize

[02:22:13 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint

[02:22:13 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize

[02:22:13 Debug] IdentityServer4.Endpoints.AuthorizeEndpoint
Start authorize request

[02:22:13 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[02:22:13 Debug] IdentityServer4.Endpoints.AuthorizeEndpoint
No user present in authorize request

[02:22:13 Debug] IdentityServer4.Validation.AuthorizeRequestValidator
Start authorize request protocol validation

[02:22:13 Debug] IdentityServer4.Stores.ValidatingClientStore
client configuration validation for client Starter.Bff succeeded.

[02:22:13 Debug] IdentityServer4.Validation.AuthorizeRequestValidator
Checking for PKCE parameters

[02:22:13 Debug] IdentityServer4.Validation.AuthorizeRequestValidator
Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator

[02:22:13 Debug] IdentityServer4.Endpoints.AuthorizeEndpoint
ValidatedAuthorizeRequest
{"ClientId":"Starter.Bff","ClientName":null,"RedirectUri":"https://localhost/signin-oidc","AllowedRedirectUris":["https://localhost/signin-oidc","https://bff:5005/signin-oidc","https://localhost/loggedin"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"form_post","GrantType":"authorization_code","RequestedScopes":"openid profile Starter.Api offline_access","State":"CfDJ8B_OL-oYhMtAppB-AJAKkXqq5DT3sDEJnxutmCXrQc8NIX2Q0XcZqQOXxpbr2P0GDE5GPjQfZhLfSLUgfLylX0jAEYaCxmWFuxLbSwWNAOApszDBoXQdF8rWBnvQgLzVDPK1Qm0pXLpDXhPqhW3avvet90m-etYc3082k_-tTOOvKjOTnaPvZralHCF1uQZk8Aqu7nqOfQA5yH6Zr9lFxXEtvllHyfIN3yJQ3AwgvceeuIWUUtqQ3TOE5WDKXJO2GIS-1tyw6XpZ_9ldK9uFyV5pv9tMA9211QVBHfghYkGOcmExWUmOrlb0ya-ulFvT38OLzKZKhVbgjHUbPmaQkjd6I4Be92K5I4TkgnOo8KDjOgfjrLbJUMGw5ZyfAPCatmeaKSj0QatV0zWiY32_ceo","UiLocales":null,"Nonce":"637773781330355890.Zjc1ZGE2MjUtY2Q5Ny00MTkxLWJkZTItMWEyNzlhOGUyOTkxNTI4MGQ1M2MtMDRkYi00NmNiLWE1YWMtMGEwZmI2OWJhNmI5","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"Starter.Bff","redirect_uri":"https://localhost/signin-oidc","response_type":"code","scope":"openid profile Starter.Api offline_access","code_challenge":"rTpiWLerseh9H8YcRlwffuXWbDgNvKPXwk-18MfhtJw","code_challenge_method":"S256","response_mode":"form_post","nonce":"637773781330355890.Zjc1ZGE2MjUtY2Q5Ny00MTkxLWJkZTItMWEyNzlhOGUyOTkxNTI4MGQ1M2MtMDRkYi00NmNiLWE1YWMtMGEwZmI2OWJhNmI5","state":"CfDJ8B_OL-oYhMtAppB-AJAKkXqq5DT3sDEJnxutmCXrQc8NIX2Q0XcZqQOXxpbr2P0GDE5GPjQfZhLfSLUgfLylX0jAEYaCxmWFuxLbSwWNAOApszDBoXQdF8rWBnvQgLzVDPK1Qm0pXLpDXhPqhW3avvet90m-etYc3082k_-tTOOvKjOTnaPvZralHCF1uQZk8Aqu7nqOfQA5yH6Zr9lFxXEtvllHyfIN3yJQ3AwgvceeuIWUUtqQ3TOE5WDKXJO2GIS-1tyw6XpZ_9ldK9uFyV5pv9tMA9211QVBHfghYkGOcmExWUmOrlb0ya-ulFvT38OLzKZKhVbgjHUbPmaQkjd6I4Be92K5I4TkgnOo8KDjOgfjrLbJUMGw5ZyfAPCatmeaKSj0QatV0zWiY32_ceo","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"6.7.1.0"},"$type":"AuthorizeRequestValidationLog"}

[02:22:13 Information] IdentityServer4.ResponseHandling.AuthorizeInteractionResponseGenerator
Showing login: User is not authenticated

[02:22:13 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.0 GET https://localhost/connect/authorize?client_id=Starter.Bff&redirect_uri=https%3A%2F%2Flocalhost%2Fsignin-oidc&response_type=code&scope=openid%20profile%20Starter.Api%20offline_access&code_challenge=rTpiWLerseh9H8YcRlwffuXWbDgNvKPXwk-18MfhtJw&code_challenge_method=S256&response_mode=form_post&nonce=637773781330355890.Zjc1ZGE2MjUtY2Q5Ny00MTkxLWJkZTItMWEyNzlhOGUyOTkxNTI4MGQ1M2MtMDRkYi00NmNiLWE1YWMtMGEwZmI2OWJhNmI5&state=CfDJ8B_OL-oYhMtAppB-AJAKkXqq5DT3sDEJnxutmCXrQc8NIX2Q0XcZqQOXxpbr2P0GDE5GPjQfZhLfSLUgfLylX0jAEYaCxmWFuxLbSwWNAOApszDBoXQdF8rWBnvQgLzVDPK1Qm0pXLpDXhPqhW3avvet90m-etYc3082k_-tTOOvKjOTnaPvZralHCF1uQZk8Aqu7nqOfQA5yH6Zr9lFxXEtvllHyfIN3yJQ3AwgvceeuIWUUtqQ3TOE5WDKXJO2GIS-1tyw6XpZ_9ldK9uFyV5pv9tMA9211QVBHfghYkGOcmExWUmOrlb0ya-ulFvT38OLzKZKhVbgjHUbPmaQkjd6I4Be92K5I4TkgnOo8KDjOgfjrLbJUMGw5ZyfAPCatmeaKSj0QatV0zWiY32_ceo&x-client-SKU=ID_NETSTANDARD2_0&x-client-ver=6.7.1.0 - - - 302 0 - 98.4215ms

[02:22:13 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.0 GET https://localhost/Account/Login?ReturnUrl=%2Fconnect%2Fauthorize%2Fcallback%3Fclient_id%3DStarter.Bff%26redirect_uri%3Dhttps%253A%252F%252Flocalhost%252Fsignin-oidc%26response_type%3Dcode%26scope%3Dopenid%2520profile%2520Starter.Api%2520offline_access%26code_challenge%3DrTpiWLerseh9H8YcRlwffuXWbDgNvKPXwk-18MfhtJw%26code_challenge_method%3DS256%26response_mode%3Dform_post%26nonce%3D637773781330355890.Zjc1ZGE2MjUtY2Q5Ny00MTkxLWJkZTItMWEyNzlhOGUyOTkxNTI4MGQ1M2MtMDRkYi00NmNiLWE1YWMtMGEwZmI2OWJhNmI5%26state%3DCfDJ8B_OL-oYhMtAppB-AJAKkXqq5DT3sDEJnxutmCXrQc8NIX2Q0XcZqQOXxpbr2P0GDE5GPjQfZhLfSLUgfLylX0jAEYaCxmWFuxLbSwWNAOApszDBoXQdF8rWBnvQgLzVDPK1Qm0pXLpDXhPqhW3avvet90m-etYc3082k_-tTOOvKjOTnaPvZralHCF1uQZk8Aqu7nqOfQA5yH6Zr9lFxXEtvllHyfIN3yJQ3AwgvceeuIWUUtqQ3TOE5WDKXJO2GIS-1tyw6XpZ_9ldK9uFyV5pv9tMA9211QVBHfghYkGOcmExWUmOrlb0ya-ulFvT38OLzKZKhVbgjHUbPmaQkjd6I4Be92K5I4TkgnOo8KDjOgfjrLbJUMGw5ZyfAPCatmeaKSj0QatV0zWiY32_ceo%26x-client-SKU%3DID_NETSTANDARD2_0%26x-client-ver%3D6.7.1.0 - -

[02:22:13 Information] Microsoft.AspNetCore.Cors.Infrastructure.CorsService
CORS policy execution successful.

[02:22:13 Information] Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware
No CORS policy found for the specified request.

[02:22:13 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[02:22:13 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[02:22:13 Information] Microsoft.AspNetCore.Routing.EndpointMiddleware
Executing endpoint 'Starter.Idp.Controllers.Account.AccountController.Login (IDP)'

[02:22:13 Information] Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker
Route matched with {action = "Login", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(System.String) on controller Starter.Idp.Controllers.Account.AccountController (IDP).

[02:22:13 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[02:22:13 Debug] IdentityServer4.Validation.AuthorizeRequestValidator
Start authorize request protocol validation

[02:22:13 Debug] IdentityServer4.Stores.ValidatingClientStore
client configuration validation for client Starter.Bff succeeded.

[02:22:13 Debug] IdentityServer4.Validation.AuthorizeRequestValidator
Checking for PKCE parameters

[02:22:13 Debug] IdentityServer4.Validation.AuthorizeRequestValidator
Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator

[02:22:13 Debug] IdentityServer4.Stores.ValidatingClientStore
client configuration validation for client Starter.Bff succeeded.

[02:22:13 Information] Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor
Executing ViewResult, running view Login.

[02:22:13 Information] Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor
Executed ViewResult - view Login executed in 94.2433ms.

[02:22:13 Information] Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker
Executed action Starter.Idp.Controllers.Account.AccountController.Login (IDP) in 125.8466ms

[02:22:13 Information] Microsoft.AspNetCore.Routing.EndpointMiddleware
Executed endpoint 'Starter.Idp.Controllers.Account.AccountController.Login (IDP)'

[02:22:13 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.0 GET https://localhost/Account/Login?ReturnUrl=%2Fconnect%2Fauthorize%2Fcallback%3Fclient_id%3DStarter.Bff%26redirect_uri%3Dhttps%253A%252F%252Flocalhost%252Fsignin-oidc%26response_type%3Dcode%26scope%3Dopenid%2520profile%2520Starter.Api%2520offline_access%26code_challenge%3DrTpiWLerseh9H8YcRlwffuXWbDgNvKPXwk-18MfhtJw%26code_challenge_method%3DS256%26response_mode%3Dform_post%26nonce%3D637773781330355890.Zjc1ZGE2MjUtY2Q5Ny00MTkxLWJkZTItMWEyNzlhOGUyOTkxNTI4MGQ1M2MtMDRkYi00NmNiLWE1YWMtMGEwZmI2OWJhNmI5%26state%3DCfDJ8B_OL-oYhMtAppB-AJAKkXqq5DT3sDEJnxutmCXrQc8NIX2Q0XcZqQOXxpbr2P0GDE5GPjQfZhLfSLUgfLylX0jAEYaCxmWFuxLbSwWNAOApszDBoXQdF8rWBnvQgLzVDPK1Qm0pXLpDXhPqhW3avvet90m-etYc3082k_-tTOOvKjOTnaPvZralHCF1uQZk8Aqu7nqOfQA5yH6Zr9lFxXEtvllHyfIN3yJQ3AwgvceeuIWUUtqQ3TOE5WDKXJO2GIS-1tyw6XpZ_9ldK9uFyV5pv9tMA9211QVBHfghYkGOcmExWUmOrlb0ya-ulFvT38OLzKZKhVbgjHUbPmaQkjd6I4Be92K5I4TkgnOo8KDjOgfjrLbJUMGw5ZyfAPCatmeaKSj0QatV0zWiY32_ceo%26x-client-SKU%3DID_NETSTANDARD2_0%26x-client-ver%3D6.7.1.0 - - - 200 - text/html;+charset=utf-8 163.6722ms

[02:22:13 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.0 GET https://localhost/lib/bootstrap/dist/css/bootstrap.min.css - -

[02:22:13 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.0 GET https://localhost/css/site.css - -

[02:22:13 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.0 GET https://localhost/lib/jquery/dist/jquery.slim.min.js - -

[02:22:13 Information] Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware
Sending file. Request path: '/css/site.css'. Physical path: '/app/wwwroot/css/site.css'

[02:22:13 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.0 GET https://localhost/css/site.css - - - 200 497 text/css 23.2631ms

[02:22:13 Information] Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware
Sending file. Request path: '/lib/bootstrap/dist/css/bootstrap.min.css'. Physical path: '/app/wwwroot/lib/bootstrap/dist/css/bootstrap.min.css'

[02:22:13 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.0 GET https://localhost/lib/bootstrap/dist/css/bootstrap.min.css - - - 200 159515 text/css 28.1108ms

[02:22:13 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.0 GET https://localhost/lib/bootstrap/dist/js/bootstrap.bundle.min.js - -

[02:22:13 Information] Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware
Sending file. Request path: '/lib/jquery/dist/jquery.slim.min.js'. Physical path: '/app/wwwroot/lib/jquery/dist/jquery.slim.min.js'

[02:22:13 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.0 GET https://localhost/lib/jquery/dist/jquery.slim.min.js - - - 200 72397 application/javascript 13.4083ms

[02:22:13 Information] Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware
Sending file. Request path: '/lib/bootstrap/dist/js/bootstrap.bundle.min.js'. Physical path: '/app/wwwroot/lib/bootstrap/dist/js/bootstrap.bundle.min.js'

[02:22:13 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.0 GET https://localhost/lib/bootstrap/dist/js/bootstrap.bundle.min.js - - - 200 80698 application/javascript 14.8705ms

[02:22:19 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.0 POST https://localhost/Account/Login?ReturnUrl=%2Fconnect%2Fauthorize%2Fcallback%3Fclient_id%3DStarter.Bff%26redirect_uri%3Dhttps%253A%252F%252Flocalhost%252Fsignin-oidc%26response_type%3Dcode%26scope%3Dopenid%2520profile%2520Starter.Api%2520offline_access%26code_challenge%3DrTpiWLerseh9H8YcRlwffuXWbDgNvKPXwk-18MfhtJw%26code_challenge_method%3DS256%26response_mode%3Dform_post%26nonce%3D637773781330355890.Zjc1ZGE2MjUtY2Q5Ny00MTkxLWJkZTItMWEyNzlhOGUyOTkxNTI4MGQ1M2MtMDRkYi00NmNiLWE1YWMtMGEwZmI2OWJhNmI5%26state%3DCfDJ8B_OL-oYhMtAppB-AJAKkXqq5DT3sDEJnxutmCXrQc8NIX2Q0XcZqQOXxpbr2P0GDE5GPjQfZhLfSLUgfLylX0jAEYaCxmWFuxLbSwWNAOApszDBoXQdF8rWBnvQgLzVDPK1Qm0pXLpDXhPqhW3avvet90m-etYc3082k_-tTOOvKjOTnaPvZralHCF1uQZk8Aqu7nqOfQA5yH6Zr9lFxXEtvllHyfIN3yJQ3AwgvceeuIWUUtqQ3TOE5WDKXJO2GIS-1tyw6XpZ_9ldK9uFyV5pv9tMA9211QVBHfghYkGOcmExWUmOrlb0ya-ulFvT38OLzKZKhVbgjHUbPmaQkjd6I4Be92K5I4TkgnOo8KDjOgfjrLbJUMGw5ZyfAPCatmeaKSj0QatV0zWiY32_ceo%26x-client-SKU%3DID_NETSTANDARD2_0%26x-client-ver%3D6.7.1.0 application/x-www-form-urlencoded 1198

[02:22:19 Information] Microsoft.AspNetCore.Cors.Infrastructure.CorsService
CORS policy execution successful.

[02:22:19 Information] Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware
No CORS policy found for the specified request.

[02:22:19 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[02:22:19 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[02:22:19 Information] Microsoft.AspNetCore.Routing.EndpointMiddleware
Executing endpoint 'Starter.Idp.Controllers.Account.AccountController.Login (IDP)'

[02:22:19 Information] Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker
Route matched with {action = "Login", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(Starter.Idp.Models.Account.LoginInputModel, System.String) on controller Starter.Idp.Controllers.Account.AccountController (IDP).

[02:22:19 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[02:22:19 Debug] IdentityServer4.Validation.AuthorizeRequestValidator
Start authorize request protocol validation

[02:22:19 Debug] IdentityServer4.Stores.ValidatingClientStore
client configuration validation for client Starter.Bff succeeded.

[02:22:19 Debug] IdentityServer4.Validation.AuthorizeRequestValidator
Checking for PKCE parameters

[02:22:19 Debug] IdentityServer4.Validation.AuthorizeRequestValidator
Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator

[02:22:19 Information] Microsoft.EntityFrameworkCore.Infrastructure
Entity Framework Core 5.0.8 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None

[02:22:19 Information] Microsoft.EntityFrameworkCore.Database.Command
Executed DbCommand (1ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0

[02:22:19 Information] Microsoft.EntityFrameworkCore.Database.Command
Executed DbCommand (3ms) [Parameters=[@__user_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0

[02:22:19 Information] Microsoft.EntityFrameworkCore.Database.Command
Executed DbCommand (4ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0

[02:22:19 Debug] IdentityServer4.Hosting.IdentityServerAuthenticationService
Augmenting SignInContext

[02:22:19 Debug] IdentityServer4.Hosting.IdentityServerAuthenticationService
Adding idp claim with value: local

[02:22:19 Debug] IdentityServer4.Hosting.IdentityServerAuthenticationService
Adding auth_time claim with value: 1641781339

[02:22:19 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[02:22:19 Information] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application signed in.

[02:22:19 Information] Microsoft.EntityFrameworkCore.Database.Command
Executed DbCommand (1ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0

[02:22:19 Information] IdentityServer4.Events.DefaultEventService
{"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"4","DisplayName":"bob","Endpoint":"UI","ClientId":"Starter.Bff","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HMEJS01GRVG8:00000002","TimeStamp":"2022-01-10T02:22:19.0000000Z","ProcessId":202,"LocalIpAddress":"172.24.0.3:5007","RemoteIpAddress":"172.24.0.1","$type":"UserLoginSuccessEvent"}

[02:22:19 Information] Microsoft.AspNetCore.Mvc.Infrastructure.RedirectResultExecutor
Executing RedirectResult, redirecting to /connect/authorize/callback?client_id=Starter.Bff&redirect_uri=https%3A%2F%2Flocalhost%2Fsignin-oidc&response_type=code&scope=openid%20profile%20Starter.Api%20offline_access&code_challenge=rTpiWLerseh9H8YcRlwffuXWbDgNvKPXwk-18MfhtJw&code_challenge_method=S256&response_mode=form_post&nonce=637773781330355890.Zjc1ZGE2MjUtY2Q5Ny00MTkxLWJkZTItMWEyNzlhOGUyOTkxNTI4MGQ1M2MtMDRkYi00NmNiLWE1YWMtMGEwZmI2OWJhNmI5&state=CfDJ8B_OL-oYhMtAppB-AJAKkXqq5DT3sDEJnxutmCXrQc8NIX2Q0XcZqQOXxpbr2P0GDE5GPjQfZhLfSLUgfLylX0jAEYaCxmWFuxLbSwWNAOApszDBoXQdF8rWBnvQgLzVDPK1Qm0pXLpDXhPqhW3avvet90m-etYc3082k_-tTOOvKjOTnaPvZralHCF1uQZk8Aqu7nqOfQA5yH6Zr9lFxXEtvllHyfIN3yJQ3AwgvceeuIWUUtqQ3TOE5WDKXJO2GIS-1tyw6XpZ_9ldK9uFyV5pv9tMA9211QVBHfghYkGOcmExWUmOrlb0ya-ulFvT38OLzKZKhVbgjHUbPmaQkjd6I4Be92K5I4TkgnOo8KDjOgfjrLbJUMGw5ZyfAPCatmeaKSj0QatV0zWiY32_ceo&x-client-SKU=ID_NETSTANDARD2_0&x-client-ver=6.7.1.0.

[02:22:19 Information] Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker
Executed action Starter.Idp.Controllers.Account.AccountController.Login (IDP) in 205.7351ms

[02:22:19 Information] Microsoft.AspNetCore.Routing.EndpointMiddleware
Executed endpoint 'Starter.Idp.Controllers.Account.AccountController.Login (IDP)'

[02:22:19 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.0 POST https://localhost/Account/Login?ReturnUrl=%2Fconnect%2Fauthorize%2Fcallback%3Fclient_id%3DStarter.Bff%26redirect_uri%3Dhttps%253A%252F%252Flocalhost%252Fsignin-oidc%26response_type%3Dcode%26scope%3Dopenid%2520profile%2520Starter.Api%2520offline_access%26code_challenge%3DrTpiWLerseh9H8YcRlwffuXWbDgNvKPXwk-18MfhtJw%26code_challenge_method%3DS256%26response_mode%3Dform_post%26nonce%3D637773781330355890.Zjc1ZGE2MjUtY2Q5Ny00MTkxLWJkZTItMWEyNzlhOGUyOTkxNTI4MGQ1M2MtMDRkYi00NmNiLWE1YWMtMGEwZmI2OWJhNmI5%26state%3DCfDJ8B_OL-oYhMtAppB-AJAKkXqq5DT3sDEJnxutmCXrQc8NIX2Q0XcZqQOXxpbr2P0GDE5GPjQfZhLfSLUgfLylX0jAEYaCxmWFuxLbSwWNAOApszDBoXQdF8rWBnvQgLzVDPK1Qm0pXLpDXhPqhW3avvet90m-etYc3082k_-tTOOvKjOTnaPvZralHCF1uQZk8Aqu7nqOfQA5yH6Zr9lFxXEtvllHyfIN3yJQ3AwgvceeuIWUUtqQ3TOE5WDKXJO2GIS-1tyw6XpZ_9ldK9uFyV5pv9tMA9211QVBHfghYkGOcmExWUmOrlb0ya-ulFvT38OLzKZKhVbgjHUbPmaQkjd6I4Be92K5I4TkgnOo8KDjOgfjrLbJUMGw5ZyfAPCatmeaKSj0QatV0zWiY32_ceo%26x-client-SKU%3DID_NETSTANDARD2_0%26x-client-ver%3D6.7.1.0 application/x-www-form-urlencoded 1198 - 302 0 - 220.4982ms

[02:22:19 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.0 GET https://localhost/connect/authorize/callback?client_id=Starter.Bff&redirect_uri=https%3A%2F%2Flocalhost%2Fsignin-oidc&response_type=code&scope=openid%20profile%20Starter.Api%20offline_access&code_challenge=rTpiWLerseh9H8YcRlwffuXWbDgNvKPXwk-18MfhtJw&code_challenge_method=S256&response_mode=form_post&nonce=637773781330355890.Zjc1ZGE2MjUtY2Q5Ny00MTkxLWJkZTItMWEyNzlhOGUyOTkxNTI4MGQ1M2MtMDRkYi00NmNiLWE1YWMtMGEwZmI2OWJhNmI5&state=CfDJ8B_OL-oYhMtAppB-AJAKkXqq5DT3sDEJnxutmCXrQc8NIX2Q0XcZqQOXxpbr2P0GDE5GPjQfZhLfSLUgfLylX0jAEYaCxmWFuxLbSwWNAOApszDBoXQdF8rWBnvQgLzVDPK1Qm0pXLpDXhPqhW3avvet90m-etYc3082k_-tTOOvKjOTnaPvZralHCF1uQZk8Aqu7nqOfQA5yH6Zr9lFxXEtvllHyfIN3yJQ3AwgvceeuIWUUtqQ3TOE5WDKXJO2GIS-1tyw6XpZ_9ldK9uFyV5pv9tMA9211QVBHfghYkGOcmExWUmOrlb0ya-ulFvT38OLzKZKhVbgjHUbPmaQkjd6I4Be92K5I4TkgnOo8KDjOgfjrLbJUMGw5ZyfAPCatmeaKSj0QatV0zWiY32_ceo&x-client-SKU=ID_NETSTANDARD2_0&x-client-ver=6.7.1.0 - -

[02:22:19 Information] Microsoft.AspNetCore.Cors.Infrastructure.CorsService
CORS policy execution successful.

[02:22:19 Information] Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware
No CORS policy found for the specified request.

[02:22:19 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was successfully authenticated.

[02:22:19 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was successfully authenticated.

[02:22:19 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /connect/authorize/callback matched to endpoint type Authorize

[02:22:19 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint

[02:22:19 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback

[02:22:19 Debug] IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
Start authorize callback request

[02:22:19 Debug] IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
User in authorize request: 4

[02:22:19 Debug] IdentityServer4.Validation.AuthorizeRequestValidator
Start authorize request protocol validation

[02:22:19 Debug] IdentityServer4.Stores.ValidatingClientStore
client configuration validation for client Starter.Bff succeeded.

[02:22:19 Debug] IdentityServer4.Validation.AuthorizeRequestValidator
Checking for PKCE parameters

[02:22:19 Debug] IdentityServer4.Validation.AuthorizeRequestValidator
Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator

[02:22:19 Debug] IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
ValidatedAuthorizeRequest
{"ClientId":"Starter.Bff","ClientName":null,"RedirectUri":"https://localhost/signin-oidc","AllowedRedirectUris":["https://localhost/signin-oidc","https://bff:5005/signin-oidc","https://localhost/loggedin"],"SubjectId":"4","ResponseType":"code","ResponseMode":"form_post","GrantType":"authorization_code","RequestedScopes":"openid profile Starter.Api offline_access","State":"CfDJ8B_OL-oYhMtAppB-AJAKkXqq5DT3sDEJnxutmCXrQc8NIX2Q0XcZqQOXxpbr2P0GDE5GPjQfZhLfSLUgfLylX0jAEYaCxmWFuxLbSwWNAOApszDBoXQdF8rWBnvQgLzVDPK1Qm0pXLpDXhPqhW3avvet90m-etYc3082k_-tTOOvKjOTnaPvZralHCF1uQZk8Aqu7nqOfQA5yH6Zr9lFxXEtvllHyfIN3yJQ3AwgvceeuIWUUtqQ3TOE5WDKXJO2GIS-1tyw6XpZ_9ldK9uFyV5pv9tMA9211QVBHfghYkGOcmExWUmOrlb0ya-ulFvT38OLzKZKhVbgjHUbPmaQkjd6I4Be92K5I4TkgnOo8KDjOgfjrLbJUMGw5ZyfAPCatmeaKSj0QatV0zWiY32_ceo","UiLocales":null,"Nonce":"637773781330355890.Zjc1ZGE2MjUtY2Q5Ny00MTkxLWJkZTItMWEyNzlhOGUyOTkxNTI4MGQ1M2MtMDRkYi00NmNiLWE1YWMtMGEwZmI2OWJhNmI5","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"33CD3BF982D7F5EB5C4D9CE119E01BA2","Raw":{"client_id":"Starter.Bff","redirect_uri":"https://localhost/signin-oidc","response_type":"code","scope":"openid profile Starter.Api offline_access","code_challenge":"rTpiWLerseh9H8YcRlwffuXWbDgNvKPXwk-18MfhtJw","code_challenge_method":"S256","response_mode":"form_post","nonce":"637773781330355890.Zjc1ZGE2MjUtY2Q5Ny00MTkxLWJkZTItMWEyNzlhOGUyOTkxNTI4MGQ1M2MtMDRkYi00NmNiLWE1YWMtMGEwZmI2OWJhNmI5","state":"CfDJ8B_OL-oYhMtAppB-AJAKkXqq5DT3sDEJnxutmCXrQc8NIX2Q0XcZqQOXxpbr2P0GDE5GPjQfZhLfSLUgfLylX0jAEYaCxmWFuxLbSwWNAOApszDBoXQdF8rWBnvQgLzVDPK1Qm0pXLpDXhPqhW3avvet90m-etYc3082k_-tTOOvKjOTnaPvZralHCF1uQZk8Aqu7nqOfQA5yH6Zr9lFxXEtvllHyfIN3yJQ3AwgvceeuIWUUtqQ3TOE5WDKXJO2GIS-1tyw6XpZ_9ldK9uFyV5pv9tMA9211QVBHfghYkGOcmExWUmOrlb0ya-ulFvT38OLzKZKhVbgjHUbPmaQkjd6I4Be92K5I4TkgnOo8KDjOgfjrLbJUMGw5ZyfAPCatmeaKSj0QatV0zWiY32_ceo","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"6.7.1.0"},"$type":"AuthorizeRequestValidationLog"}

[02:22:19 Information] Microsoft.EntityFrameworkCore.Infrastructure
Entity Framework Core 5.0.8 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None

[02:22:19 Information] Microsoft.EntityFrameworkCore.Database.Command
Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0

[02:22:19 Debug] IdentityServer4.Services.DefaultConsentService
Client is configured to not require consent, no consent is required

[02:22:19 Debug] IdentityServer4.ResponseHandling.AuthorizeResponseGenerator
Creating Authorization Code Flow response.

[02:22:19 Information] IdentityServer4.Events.DefaultEventService
{"ClientId":"Starter.Bff","ClientName":null,"RedirectUri":"https://localhost/signin-oidc","Endpoint":"Authorize","SubjectId":"4","Scopes":"openid profile Starter.Api offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****20AF","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HMEJS01GRVG9:00000002","TimeStamp":"2022-01-10T02:22:19.0000000Z","ProcessId":202,"LocalIpAddress":"172.24.0.3:5007","RemoteIpAddress":"172.24.0.1","$type":"TokenIssuedSuccessEvent"}

[02:22:19 Debug] IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
Authorize endpoint response
{"SubjectId":"4","ClientId":"Starter.Bff","RedirectUri":"https://localhost/signin-oidc","State":"CfDJ8B_OL-oYhMtAppB-AJAKkXqq5DT3sDEJnxutmCXrQc8NIX2Q0XcZqQOXxpbr2P0GDE5GPjQfZhLfSLUgfLylX0jAEYaCxmWFuxLbSwWNAOApszDBoXQdF8rWBnvQgLzVDPK1Qm0pXLpDXhPqhW3avvet90m-etYc3082k_-tTOOvKjOTnaPvZralHCF1uQZk8Aqu7nqOfQA5yH6Zr9lFxXEtvllHyfIN3yJQ3AwgvceeuIWUUtqQ3TOE5WDKXJO2GIS-1tyw6XpZ_9ldK9uFyV5pv9tMA9211QVBHfghYkGOcmExWUmOrlb0ya-ulFvT38OLzKZKhVbgjHUbPmaQkjd6I4Be92K5I4TkgnOo8KDjOgfjrLbJUMGw5ZyfAPCatmeaKSj0QatV0zWiY32_ceo","Scope":"openid profile Starter.Api offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}

[02:22:19 Debug] IdentityServer4.Hosting.IdentityServerAuthenticationService
Augmenting SignInContext

[02:22:19 Information] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application signed in.

[02:22:19 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.0 GET https://localhost/connect/authorize/callback?client_id=Starter.Bff&redirect_uri=https%3A%2F%2Flocalhost%2Fsignin-oidc&response_type=code&scope=openid%20profile%20Starter.Api%20offline_access&code_challenge=rTpiWLerseh9H8YcRlwffuXWbDgNvKPXwk-18MfhtJw&code_challenge_method=S256&response_mode=form_post&nonce=637773781330355890.Zjc1ZGE2MjUtY2Q5Ny00MTkxLWJkZTItMWEyNzlhOGUyOTkxNTI4MGQ1M2MtMDRkYi00NmNiLWE1YWMtMGEwZmI2OWJhNmI5&state=CfDJ8B_OL-oYhMtAppB-AJAKkXqq5DT3sDEJnxutmCXrQc8NIX2Q0XcZqQOXxpbr2P0GDE5GPjQfZhLfSLUgfLylX0jAEYaCxmWFuxLbSwWNAOApszDBoXQdF8rWBnvQgLzVDPK1Qm0pXLpDXhPqhW3avvet90m-etYc3082k_-tTOOvKjOTnaPvZralHCF1uQZk8Aqu7nqOfQA5yH6Zr9lFxXEtvllHyfIN3yJQ3AwgvceeuIWUUtqQ3TOE5WDKXJO2GIS-1tyw6XpZ_9ldK9uFyV5pv9tMA9211QVBHfghYkGOcmExWUmOrlb0ya-ulFvT38OLzKZKhVbgjHUbPmaQkjd6I4Be92K5I4TkgnOo8KDjOgfjrLbJUMGw5ZyfAPCatmeaKSj0QatV0zWiY32_ceo&x-client-SKU=ID_NETSTANDARD2_0&x-client-ver=6.7.1.0 - - - 200 - text/html;+charset=UTF-8 103.4635ms

[02:22:19 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.1 POST http://idp:5006/connect/token application/x-www-form-urlencoded 251

[02:22:19 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[02:22:19 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[02:22:19 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /connect/token matched to endpoint type Token

[02:22:19 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint

[02:22:19 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token

[02:22:19 Debug] IdentityServer4.Endpoints.TokenEndpoint
Start token request.

[02:22:19 Debug] IdentityServer4.Validation.ClientSecretValidator
Start client validation

[02:22:19 Debug] IdentityServer4.Validation.BasicAuthenticationSecretParser
Start parsing Basic Authentication secret

[02:22:19 Debug] IdentityServer4.Validation.PostBodySecretParser
Start parsing for secret in post body

[02:22:19 Debug] IdentityServer4.Validation.ISecretsListParser
Parser found secret: PostBodySecretParser

[02:22:19 Debug] IdentityServer4.Validation.ISecretsListParser
Secret id found: Starter.Bff

[02:22:19 Debug] IdentityServer4.Stores.ValidatingClientStore
client configuration validation for client Starter.Bff succeeded.

[02:22:19 Debug] IdentityServer4.Validation.ISecretsListValidator
Secret validator success: HashedSharedSecretValidator

[02:22:19 Debug] IdentityServer4.Validation.ClientSecretValidator
Client validation success

[02:22:19 Information] IdentityServer4.Events.DefaultEventService
{"ClientId":"Starter.Bff","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HMEJS01GRVG1:00000004","TimeStamp":"2022-01-10T02:22:19.0000000Z","ProcessId":202,"LocalIpAddress":"172.24.0.3:5006","RemoteIpAddress":"172.24.0.5","$type":"ClientAuthenticationSuccessEvent"}

[02:22:19 Debug] IdentityServer4.Validation.TokenRequestValidator
Start token request validation

[02:22:19 Debug] IdentityServer4.Validation.TokenRequestValidator
Start validation of authorization code token request

[02:22:19 Debug] IdentityServer4.Validation.TokenRequestValidator
Client required a proof key for code exchange. Starting PKCE validation

[02:22:19 Information] Microsoft.EntityFrameworkCore.Infrastructure
Entity Framework Core 5.0.8 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None

[02:22:19 Information] Microsoft.EntityFrameworkCore.Database.Command
Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0

[02:22:19 Debug] IdentityServer4.Validation.TokenRequestValidator
Validation of authorization code token request success

[02:22:19 Information] IdentityServer4.Validation.TokenRequestValidator
Token request validation success, {"ClientId":"Starter.Bff","ClientName":null,"GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"****20AF","RefreshToken":"********","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"Starter.Bff","client_secret":"***REDACTED***","code":"55926DE55641A196B67974B91929A13893B9283563F75E28738F924C951E20AF","grant_type":"authorization_code","redirect_uri":"https://localhost/signin-oidc","code_verifier":"W4Yz-KzqxyCQK00rh3S6zATxiUJ0KjsRxDUctHc1OIU"},"$type":"TokenRequestValidationLog"}

[02:22:19 Debug] IdentityServer4.Stores.ValidatingClientStore
client configuration validation for client Starter.Bff succeeded.

[02:22:19 Debug] IdentityServer4.Services.DefaultClaimsService
Getting claims for access token for client: Starter.Bff

[02:22:19 Debug] IdentityServer4.Services.DefaultClaimsService
Getting claims for access token for subject: 4

[02:22:19 Information] Microsoft.EntityFrameworkCore.Database.Command
Executed DbCommand (1ms) [Parameters=[@__user_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0

[02:22:19 Information] Microsoft.EntityFrameworkCore.Database.Command
Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0

[02:22:19 Debug] IdentityServer4.Services.DefaultRefreshTokenService
Creating refresh token

[02:22:19 Debug] IdentityServer4.Services.DefaultRefreshTokenService
Setting an absolute lifetime: 2592000

[02:22:19 Debug] IdentityServer4.Stores.ValidatingClientStore
client configuration validation for client Starter.Bff succeeded.

[02:22:19 Debug] IdentityServer4.Services.DefaultClaimsService
Getting claims for identity token for subject: 4 and client: Starter.Bff

[02:22:19 Debug] IdentityServer4.Services.DefaultClaimsService
In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.

[02:22:19 Information] IdentityServer4.Events.DefaultEventService
{"ClientId":"Starter.Bff","ClientName":null,"RedirectUri":null,"Endpoint":"Token","SubjectId":"4","Scopes":"openid profile Starter.Api offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****9PMw","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****4251","$type":"Token"},{"TokenType":"access_token","TokenValue":"****lJsw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HMEJS01GRVG1:00000004","TimeStamp":"2022-01-10T02:22:19.0000000Z","ProcessId":202,"LocalIpAddress":"172.24.0.3:5006","RemoteIpAddress":"172.24.0.5","$type":"TokenIssuedSuccessEvent"}

[02:22:19 Debug] IdentityServer4.Endpoints.TokenEndpoint
Token request success.

[02:22:19 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.1 POST http://idp:5006/connect/token application/x-www-form-urlencoded 251 - 200 - application/json;+charset=UTF-8 145.9385ms

[02:22:19 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.1 GET http://idp:5006/connect/userinfo - -

[02:22:19 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[02:22:19 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[02:22:19 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /connect/userinfo matched to endpoint type Userinfo

[02:22:19 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint

[02:22:19 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo

[02:22:19 Debug] IdentityServer4.Endpoints.UserInfoEndpoint
Start userinfo request

[02:22:19 Debug] IdentityServer4.Validation.BearerTokenUsageValidator
Bearer token found in header

[02:22:19 Debug] IdentityServer4.Stores.ValidatingClientStore
client configuration validation for client Starter.Bff succeeded.

[02:22:19 Debug] IdentityServer4.Stores.ValidatingClientStore
client configuration validation for client Starter.Bff succeeded.

[02:22:19 Information] Microsoft.EntityFrameworkCore.Infrastructure
Entity Framework Core 5.0.8 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None

[02:22:19 Information] Microsoft.EntityFrameworkCore.Database.Command
Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0

[02:22:19 Debug] IdentityServer4.Validation.TokenValidator
Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator

[02:22:19 Debug] IdentityServer4.Validation.TokenValidator
Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":"B8C0569891B83A830A8DD6365B9CD699","Claims":{"nbf":1641781339,"exp":1641784939,"iss":"https://localhost","aud":["starter.api","https://localhost/resources"],"client_id":"Starter.Bff","sub":"4","auth_time":1641781339,"idp":"local","jti":"B8C0569891B83A830A8DD6365B9CD699","sid":"33CD3BF982D7F5EB5C4D9CE119E01BA2","iat":1641781339,"scope":["openid","profile","Starter.Api","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}

[02:22:19 Debug] IdentityServer4.ResponseHandling.UserInfoResponseGenerator
Creating userinfo response

[02:22:19 Debug] IdentityServer4.ResponseHandling.UserInfoResponseGenerator
Scopes in access token: openid profile Starter.Api offline_access

[02:22:19 Debug] IdentityServer4.ResponseHandling.UserInfoResponseGenerator
Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at

[02:22:19 Information] Microsoft.EntityFrameworkCore.Database.Command
Executed DbCommand (1ms) [Parameters=[@__user_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0

[02:22:19 Information] Microsoft.EntityFrameworkCore.Database.Command
Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0

[02:22:19 Information] IdentityServer4.ResponseHandling.UserInfoResponseGenerator
Profile service returned the following claim types: sub website family_name given_name name preferred_username

[02:22:19 Debug] IdentityServer4.Endpoints.UserInfoEndpoint
End userinfo request

[02:22:19 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.1 GET http://idp:5006/connect/userinfo - - - 200 - application/json;+charset=UTF-8 53.0972ms

[02:40:27 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration - -

[02:40:27 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[02:40:27 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[02:40:27 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /.well-known/openid-configuration matched to endpoint type Discovery

[02:40:27 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint

[02:40:27 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration

[02:40:27 Debug] IdentityServer4.Endpoints.DiscoveryEndpoint
Start discovery request

[02:40:27 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 3.6068ms

[02:42:27 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration - -

[02:42:27 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[02:42:27 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[02:42:27 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /.well-known/openid-configuration matched to endpoint type Discovery

[02:42:27 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint

[02:42:27 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration

[02:42:27 Debug] IdentityServer4.Endpoints.DiscoveryEndpoint
Start discovery request

[02:42:27 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 16.3951ms

[02:52:55 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration - -

[02:52:55 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[02:52:55 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[02:52:55 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /.well-known/openid-configuration matched to endpoint type Discovery

[02:52:55 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint

[02:52:55 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration

[02:52:55 Debug] IdentityServer4.Endpoints.DiscoveryEndpoint
Start discovery request

[02:52:55 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 2.7103ms

[03:04:12 Information] 
Starting host...

[03:04:12 Warning] Microsoft.AspNetCore.DataProtection.Repositories.FileSystemXmlRepository
Storing keys in a directory '/root/.aspnet/DataProtection-Keys' that may not be persisted outside of the container. Protected data will be unavailable when container is destroyed.

[03:04:12 Information] Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager
User profile is available. Using '/root/.aspnet/DataProtection-Keys' as key repository; keys will not be encrypted at rest.

[03:04:13 Debug] 
alice already exists

[03:04:13 Debug] 
bob already exists

[03:04:13 Information] IdentityServer4.Startup
Starting IdentityServer4 version 4.1.2+997a6cdd643e46cd5762b710c4ddc43574cbec2e

[03:04:13 Information] IdentityServer4.Startup
You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.

[03:04:13 Debug] IdentityServer4.Startup
Custom IssuerUri set to https://localhost

[03:04:13 Information] IdentityServer4.Startup
Using the default authentication scheme Identity.Application for IdentityServer

[03:04:13 Debug] IdentityServer4.Startup
Using Identity.Application as default ASP.NET Core scheme for authentication

[03:04:13 Debug] IdentityServer4.Startup
Using Identity.External as default ASP.NET Core scheme for sign-in

[03:04:13 Debug] IdentityServer4.Startup
Using Identity.External as default ASP.NET Core scheme for sign-out

[03:04:13 Debug] IdentityServer4.Startup
Using Identity.Application as default ASP.NET Core scheme for challenge

[03:04:13 Debug] IdentityServer4.Startup
Using Identity.Application as default ASP.NET Core scheme for forbid

[03:04:13 Warning] Microsoft.AspNetCore.Server.Kestrel
Overriding address(es) 'https://localhost:5001, http://localhost:5000'. Binding to endpoints defined in UseKestrel() instead.

[03:04:13 Information] Microsoft.Hosting.Lifetime
Now listening on: http://0.0.0.0:5006

[03:04:13 Information] Microsoft.Hosting.Lifetime
Now listening on: https://0.0.0.0:5007

[03:04:13 Information] Microsoft.Hosting.Lifetime
Application started. Press Ctrl+C to shut down.

[03:04:13 Information] Microsoft.Hosting.Lifetime
Hosting environment: Development

[03:04:13 Information] Microsoft.Hosting.Lifetime
Content root path: /app

[03:05:27 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration - -

[03:05:27 Debug] IdentityServer4.Startup
Login Url: /Account/Login

[03:05:27 Debug] IdentityServer4.Startup
Login Return Url Parameter: ReturnUrl

[03:05:27 Debug] IdentityServer4.Startup
Logout Url: /Account/Logout

[03:05:27 Debug] IdentityServer4.Startup
ConsentUrl Url: /consent

[03:05:27 Debug] IdentityServer4.Startup
Consent Return Url Parameter: returnUrl

[03:05:27 Debug] IdentityServer4.Startup
Error Url: /home/error

[03:05:27 Debug] IdentityServer4.Startup
Error Id Parameter: errorId

[03:05:27 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[03:05:27 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[03:05:27 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /.well-known/openid-configuration matched to endpoint type Discovery

[03:05:27 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint

[03:05:27 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration

[03:05:27 Debug] IdentityServer4.Endpoints.DiscoveryEndpoint
Start discovery request

[03:05:27 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 96.0409ms

[03:08:56 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration - -

[03:08:56 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[03:08:56 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[03:08:56 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /.well-known/openid-configuration matched to endpoint type Discovery

[03:08:56 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint

[03:08:56 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration

[03:08:56 Debug] IdentityServer4.Endpoints.DiscoveryEndpoint
Start discovery request

[03:08:56 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 7.6180ms

[03:17:00 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration - -

[03:17:00 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[03:17:00 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[03:17:00 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /.well-known/openid-configuration matched to endpoint type Discovery

[03:17:00 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint

[03:17:00 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration

[03:17:00 Debug] IdentityServer4.Endpoints.DiscoveryEndpoint
Start discovery request

[03:17:00 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 42.6609ms

[03:19:57 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration - -

[03:19:57 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[03:19:57 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[03:19:57 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /.well-known/openid-configuration matched to endpoint type Discovery

[03:19:57 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint

[03:19:57 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration

[03:19:57 Debug] IdentityServer4.Endpoints.DiscoveryEndpoint
Start discovery request

[03:19:57 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 3.8709ms

[03:23:01 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration - -

[03:23:01 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[03:23:01 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[03:23:01 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /.well-known/openid-configuration matched to endpoint type Discovery

[03:23:01 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint

[03:23:01 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration

[03:23:01 Debug] IdentityServer4.Endpoints.DiscoveryEndpoint
Start discovery request

[03:23:01 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 6.5143ms

[03:29:02 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration - -

[03:29:02 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[03:29:02 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[03:29:02 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /.well-known/openid-configuration matched to endpoint type Discovery

[03:29:02 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint

[03:29:02 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration

[03:29:02 Debug] IdentityServer4.Endpoints.DiscoveryEndpoint
Start discovery request

[03:29:02 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 2.9451ms

[03:32:37 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration - -

[03:32:37 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[03:32:37 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[03:32:37 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /.well-known/openid-configuration matched to endpoint type Discovery

[03:32:37 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint

[03:32:37 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration

[03:32:37 Debug] IdentityServer4.Endpoints.DiscoveryEndpoint
Start discovery request

[03:32:37 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 2.5498ms

[03:32:37 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration/jwks - -

[03:32:37 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[03:32:37 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[03:32:37 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery

[03:32:37 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint

[03:32:37 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks

[03:32:37 Debug] IdentityServer4.Endpoints.DiscoveryKeyEndpoint
Start key discovery request

[03:32:37 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 25.3403ms

[03:32:37 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.1 POST http://idp:5006/connect/token application/x-www-form-urlencoded 47

[03:32:37 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[03:32:37 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[03:32:37 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /connect/token matched to endpoint type Token

[03:32:37 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint

[03:32:37 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token

[03:32:37 Debug] IdentityServer4.Endpoints.TokenEndpoint
Start token request.

[03:32:37 Debug] IdentityServer4.Validation.ClientSecretValidator
Start client validation

[03:32:37 Debug] IdentityServer4.Validation.BasicAuthenticationSecretParser
Start parsing Basic Authentication secret

[03:32:37 Debug] IdentityServer4.Validation.ISecretsListParser
Parser found secret: BasicAuthenticationSecretParser

[03:32:37 Debug] IdentityServer4.Validation.ISecretsListParser
Secret id found: Starter.Bff

[03:32:37 Debug] IdentityServer4.Stores.ValidatingClientStore
client configuration validation for client Starter.Bff succeeded.

[03:32:37 Debug] IdentityServer4.Validation.ISecretsListValidator
Secret validator success: HashedSharedSecretValidator

[03:32:37 Debug] IdentityServer4.Validation.ClientSecretValidator
Client validation success

[03:32:37 Information] IdentityServer4.Events.DefaultEventService
{"ClientId":"Starter.Bff","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HMEJSO6O5JGS:00000002","TimeStamp":"2022-01-10T03:32:37.0000000Z","ProcessId":189,"LocalIpAddress":"172.24.0.3:5006","RemoteIpAddress":"172.24.0.5","$type":"ClientAuthenticationSuccessEvent"}

[03:32:37 Debug] IdentityServer4.Validation.TokenRequestValidator
Start token request validation

[03:32:37 Debug] IdentityServer4.Validation.TokenRequestValidator
Start client credentials token request validation

[03:32:37 Error] IdentityServer4.Validation.TokenRequestValidator
Client not authorized for client credentials flow, check the AllowedGrantTypes setting{"clientId":"Starter.Bff"}, details: {"ClientId":"Starter.Bff","ClientName":null,"GrantType":"client_credentials","Scopes":null,"AuthorizationCode":"********","RefreshToken":"********","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"client_credentials","scope":"Starter.Api"},"$type":"TokenRequestValidationLog"}

[03:32:37 Information] IdentityServer4.Events.DefaultEventService
{"ClientId":"Starter.Bff","ClientName":null,"RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":null,"GrantType":"client_credentials","Error":"unauthorized_client","ErrorDescription":null,"Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HMEJSO6O5JGS:00000002","TimeStamp":"2022-01-10T03:32:37.0000000Z","ProcessId":189,"LocalIpAddress":"172.24.0.3:5006","RemoteIpAddress":"172.24.0.5","$type":"TokenIssuedFailureEvent"}

[03:32:37 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.1 POST http://idp:5006/connect/token application/x-www-form-urlencoded 47 - 400 - application/json;+charset=UTF-8 52.3436ms

[03:37:44 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration - -

[03:37:44 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[03:37:44 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[03:37:44 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /.well-known/openid-configuration matched to endpoint type Discovery

[03:37:44 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint

[03:37:44 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration

[03:37:44 Debug] IdentityServer4.Endpoints.DiscoveryEndpoint
Start discovery request

[03:37:44 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 4.1625ms

[03:37:44 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration/jwks - -

[03:37:44 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[03:37:44 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[03:37:44 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery

[03:37:44 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint

[03:37:44 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks

[03:37:44 Debug] IdentityServer4.Endpoints.DiscoveryKeyEndpoint
Start key discovery request

[03:37:44 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 7.8857ms

[03:37:44 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.1 POST http://idp:5006/connect/token application/x-www-form-urlencoded 47

[03:37:44 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[03:37:44 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[03:37:44 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /connect/token matched to endpoint type Token

[03:37:44 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint

[03:37:44 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token

[03:37:44 Debug] IdentityServer4.Endpoints.TokenEndpoint
Start token request.

[03:37:44 Debug] IdentityServer4.Validation.ClientSecretValidator
Start client validation

[03:37:44 Debug] IdentityServer4.Validation.BasicAuthenticationSecretParser
Start parsing Basic Authentication secret

[03:37:44 Debug] IdentityServer4.Validation.ISecretsListParser
Parser found secret: BasicAuthenticationSecretParser

[03:37:44 Debug] IdentityServer4.Validation.ISecretsListParser
Secret id found: Starter.Bff

[03:37:44 Debug] IdentityServer4.Stores.ValidatingClientStore
client configuration validation for client Starter.Bff succeeded.

[03:37:44 Debug] IdentityServer4.Validation.ISecretsListValidator
Secret validator success: HashedSharedSecretValidator

[03:37:44 Debug] IdentityServer4.Validation.ClientSecretValidator
Client validation success

[03:37:44 Information] IdentityServer4.Events.DefaultEventService
{"ClientId":"Starter.Bff","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HMEJSO6O5JGU:00000002","TimeStamp":"2022-01-10T03:37:44.0000000Z","ProcessId":189,"LocalIpAddress":"172.24.0.3:5006","RemoteIpAddress":"172.24.0.5","$type":"ClientAuthenticationSuccessEvent"}

[03:37:44 Debug] IdentityServer4.Validation.TokenRequestValidator
Start token request validation

[03:37:44 Debug] IdentityServer4.Validation.TokenRequestValidator
Start client credentials token request validation

[03:37:44 Error] IdentityServer4.Validation.TokenRequestValidator
Client not authorized for client credentials flow, check the AllowedGrantTypes setting{"clientId":"Starter.Bff"}, details: {"ClientId":"Starter.Bff","ClientName":null,"GrantType":"client_credentials","Scopes":null,"AuthorizationCode":"********","RefreshToken":"********","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"client_credentials","scope":"Starter.Api"},"$type":"TokenRequestValidationLog"}

[03:37:44 Information] IdentityServer4.Events.DefaultEventService
{"ClientId":"Starter.Bff","ClientName":null,"RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":null,"GrantType":"client_credentials","Error":"unauthorized_client","ErrorDescription":null,"Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HMEJSO6O5JGU:00000002","TimeStamp":"2022-01-10T03:37:44.0000000Z","ProcessId":189,"LocalIpAddress":"172.24.0.3:5006","RemoteIpAddress":"172.24.0.5","$type":"TokenIssuedFailureEvent"}

[03:37:44 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.1 POST http://idp:5006/connect/token application/x-www-form-urlencoded 47 - 400 - application/json;+charset=UTF-8 13.5591ms

[03:40:43 Information] Microsoft.Hosting.Lifetime
Application is shutting down...

[03:41:34 Information] 
Starting host...

[03:41:34 Warning] Microsoft.AspNetCore.DataProtection.Repositories.FileSystemXmlRepository
Storing keys in a directory '/root/.aspnet/DataProtection-Keys' that may not be persisted outside of the container. Protected data will be unavailable when container is destroyed.

[03:41:34 Information] Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager
User profile is available. Using '/root/.aspnet/DataProtection-Keys' as key repository; keys will not be encrypted at rest.

[03:41:36 Debug] 
alice already exists

[03:41:36 Debug] 
bob already exists

[03:41:36 Information] IdentityServer4.Startup
Starting IdentityServer4 version 4.1.2+997a6cdd643e46cd5762b710c4ddc43574cbec2e

[03:41:36 Information] IdentityServer4.Startup
You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.

[03:41:36 Debug] IdentityServer4.Startup
Custom IssuerUri set to https://localhost

[03:41:36 Information] IdentityServer4.Startup
Using the default authentication scheme Identity.Application for IdentityServer

[03:41:36 Debug] IdentityServer4.Startup
Using Identity.Application as default ASP.NET Core scheme for authentication

[03:41:36 Debug] IdentityServer4.Startup
Using Identity.External as default ASP.NET Core scheme for sign-in

[03:41:36 Debug] IdentityServer4.Startup
Using Identity.External as default ASP.NET Core scheme for sign-out

[03:41:36 Debug] IdentityServer4.Startup
Using Identity.Application as default ASP.NET Core scheme for challenge

[03:41:36 Debug] IdentityServer4.Startup
Using Identity.Application as default ASP.NET Core scheme for forbid

[03:41:36 Warning] Microsoft.AspNetCore.Server.Kestrel
Overriding address(es) 'https://localhost:5001, http://localhost:5000'. Binding to endpoints defined in UseKestrel() instead.

[03:41:36 Information] Microsoft.Hosting.Lifetime
Now listening on: http://0.0.0.0:5006

[03:41:36 Information] Microsoft.Hosting.Lifetime
Now listening on: https://0.0.0.0:5007

[03:41:36 Information] Microsoft.Hosting.Lifetime
Application started. Press Ctrl+C to shut down.

[03:41:36 Information] Microsoft.Hosting.Lifetime
Hosting environment: Development

[03:41:36 Information] Microsoft.Hosting.Lifetime
Content root path: /app

[03:41:45 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.1 POST http://idp:5006/connect/token application/x-www-form-urlencoded 47

[03:41:45 Debug] IdentityServer4.Startup
Login Url: /Account/Login

[03:41:45 Debug] IdentityServer4.Startup
Login Return Url Parameter: ReturnUrl

[03:41:45 Debug] IdentityServer4.Startup
Logout Url: /Account/Logout

[03:41:45 Debug] IdentityServer4.Startup
ConsentUrl Url: /consent

[03:41:45 Debug] IdentityServer4.Startup
Consent Return Url Parameter: returnUrl

[03:41:45 Debug] IdentityServer4.Startup
Error Url: /home/error

[03:41:45 Debug] IdentityServer4.Startup
Error Id Parameter: errorId

[03:41:45 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[03:41:45 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[03:41:45 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /connect/token matched to endpoint type Token

[03:41:45 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint

[03:41:45 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token

[03:41:45 Debug] IdentityServer4.Endpoints.TokenEndpoint
Start token request.

[03:41:45 Debug] IdentityServer4.Validation.ClientSecretValidator
Start client validation

[03:41:45 Debug] IdentityServer4.Validation.BasicAuthenticationSecretParser
Start parsing Basic Authentication secret

[03:41:45 Debug] IdentityServer4.Validation.ISecretsListParser
Parser found secret: BasicAuthenticationSecretParser

[03:41:45 Debug] IdentityServer4.Validation.ISecretsListParser
Secret id found: Starter.Bff

[03:41:45 Debug] IdentityServer4.Stores.ValidatingClientStore
client configuration validation for client Starter.Bff succeeded.

[03:41:45 Debug] IdentityServer4.Validation.ISecretsListValidator
Secret validator success: HashedSharedSecretValidator

[03:41:45 Debug] IdentityServer4.Validation.ClientSecretValidator
Client validation success

[03:41:45 Information] IdentityServer4.Events.DefaultEventService
{"ClientId":"Starter.Bff","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HMEJTCFTJ784:00000002","TimeStamp":"2022-01-10T03:41:45.0000000Z","ProcessId":188,"LocalIpAddress":"172.24.0.3:5006","RemoteIpAddress":"172.24.0.5","$type":"ClientAuthenticationSuccessEvent"}

[03:41:45 Debug] IdentityServer4.Validation.TokenRequestValidator
Start token request validation

[03:41:45 Debug] IdentityServer4.Validation.TokenRequestValidator
Start client credentials token request validation

[03:41:45 Debug] IdentityServer4.Validation.TokenRequestValidator
Starter.Bff credentials token request validation success

[03:41:45 Information] IdentityServer4.Validation.TokenRequestValidator
Token request validation success, {"ClientId":"Starter.Bff","ClientName":null,"GrantType":"client_credentials","Scopes":"Starter.Api","AuthorizationCode":"********","RefreshToken":"********","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"client_credentials","scope":"Starter.Api"},"$type":"TokenRequestValidationLog"}

[03:41:45 Debug] IdentityServer4.Services.DefaultClaimsService
Getting claims for access token for client: Starter.Bff

[03:41:45 Information] IdentityServer4.Events.DefaultEventService
{"ClientId":"Starter.Bff","ClientName":null,"RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"Starter.Api","GrantType":"client_credentials","Tokens":[{"TokenType":"access_token","TokenValue":"****PWuw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HMEJTCFTJ784:00000002","TimeStamp":"2022-01-10T03:41:45.0000000Z","ProcessId":188,"LocalIpAddress":"172.24.0.3:5006","RemoteIpAddress":"172.24.0.5","$type":"TokenIssuedSuccessEvent"}

[03:41:45 Debug] IdentityServer4.Endpoints.TokenEndpoint
Token request success.

[03:41:45 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.1 POST http://idp:5006/connect/token application/x-www-form-urlencoded 47 - 200 - application/json;+charset=UTF-8 274.5294ms

[03:41:45 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.1 GET http://idp:5006/connect/userinfo - -

[03:41:45 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[03:41:45 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[03:41:45 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /connect/userinfo matched to endpoint type Userinfo

[03:41:45 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint

[03:41:45 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo

[03:41:45 Debug] IdentityServer4.Endpoints.UserInfoEndpoint
Start userinfo request

[03:41:45 Debug] IdentityServer4.Validation.BearerTokenUsageValidator
Bearer token found in header

[03:41:45 Debug] IdentityServer4.Stores.ValidatingClientStore
client configuration validation for client Starter.Bff succeeded.

[03:41:45 Debug] IdentityServer4.Stores.ValidatingClientStore
client configuration validation for client Starter.Bff succeeded.

[03:41:45 Error] IdentityServer4.Validation.TokenValidator
Checking for expected scope openid failed
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":"A1552D1ADF366661F213432C470488CF","Claims":{"nbf":1641786105,"exp":1641789705,"iss":"https://localhost","aud":["starter.api","https://localhost/resources"],"client_id":"Starter.Bff","jti":"A1552D1ADF366661F213432C470488CF","iat":1641786105,"scope":"Starter.Api"},"$type":"TokenValidationLog"}

[03:41:45 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.1 GET http://idp:5006/connect/userinfo - - - 403 0 - 51.6596ms

[03:46:33 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration - -

[03:46:33 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[03:46:33 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[03:46:33 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /.well-known/openid-configuration matched to endpoint type Discovery

[03:46:33 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint

[03:46:33 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration

[03:46:33 Debug] IdentityServer4.Endpoints.DiscoveryEndpoint
Start discovery request

[03:46:33 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 32.0087ms

[03:46:33 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration/jwks - -

[03:46:33 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[03:46:33 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[03:46:33 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery

[03:46:33 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint

[03:46:33 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks

[03:46:33 Debug] IdentityServer4.Endpoints.DiscoveryKeyEndpoint
Start key discovery request

[03:46:33 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 10.4287ms

[03:46:33 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.1 POST http://idp:5006/connect/token application/x-www-form-urlencoded 43

[03:46:33 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[03:46:33 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[03:46:33 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /connect/token matched to endpoint type Token

[03:46:33 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint

[03:46:33 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token

[03:46:33 Debug] IdentityServer4.Endpoints.TokenEndpoint
Start token request.

[03:46:33 Debug] IdentityServer4.Validation.ClientSecretValidator
Start client validation

[03:46:33 Debug] IdentityServer4.Validation.BasicAuthenticationSecretParser
Start parsing Basic Authentication secret

[03:46:33 Debug] IdentityServer4.Validation.ISecretsListParser
Parser found secret: BasicAuthenticationSecretParser

[03:46:33 Debug] IdentityServer4.Validation.ISecretsListParser
Secret id found: Starter.Bff

[03:46:33 Debug] IdentityServer4.Stores.ValidatingClientStore
client configuration validation for client Starter.Bff succeeded.

[03:46:33 Debug] IdentityServer4.Validation.ISecretsListValidator
Secret validator success: HashedSharedSecretValidator

[03:46:33 Debug] IdentityServer4.Validation.ClientSecretValidator
Client validation success

[03:46:33 Information] IdentityServer4.Events.DefaultEventService
{"ClientId":"Starter.Bff","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HMEJTCFTJ786:00000002","TimeStamp":"2022-01-10T03:46:33.0000000Z","ProcessId":188,"LocalIpAddress":"172.24.0.3:5006","RemoteIpAddress":"172.24.0.5","$type":"ClientAuthenticationSuccessEvent"}

[03:46:33 Debug] IdentityServer4.Validation.TokenRequestValidator
Start token request validation

[03:46:33 Debug] IdentityServer4.Validation.TokenRequestValidator
Start client credentials token request validation

[03:46:33 Error] IdentityServer4.Validation.DefaultResourceValidator
Scope Profile not found in store.

[03:46:33 Error] IdentityServer4.Validation.TokenRequestValidator
Invalid scopes requested, {"ClientId":"Starter.Bff","ClientName":null,"GrantType":"client_credentials","Scopes":null,"AuthorizationCode":"********","RefreshToken":"********","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"client_credentials","scope":"Profile"},"$type":"TokenRequestValidationLog"}

[03:46:33 Information] IdentityServer4.Events.DefaultEventService
{"ClientId":"Starter.Bff","ClientName":null,"RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":null,"GrantType":"client_credentials","Error":"invalid_scope","ErrorDescription":null,"Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HMEJTCFTJ786:00000002","TimeStamp":"2022-01-10T03:46:33.0000000Z","ProcessId":188,"LocalIpAddress":"172.24.0.3:5006","RemoteIpAddress":"172.24.0.5","$type":"TokenIssuedFailureEvent"}

[03:46:33 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.1 POST http://idp:5006/connect/token application/x-www-form-urlencoded 43 - 400 - application/json;+charset=UTF-8 8.9940ms

[03:47:35 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration - -

[03:47:35 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[03:47:35 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[03:47:35 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /.well-known/openid-configuration matched to endpoint type Discovery

[03:47:35 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint

[03:47:35 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration

[03:47:35 Debug] IdentityServer4.Endpoints.DiscoveryEndpoint
Start discovery request

[03:47:35 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 2.8843ms

[03:47:35 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration/jwks - -

[03:47:35 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[03:47:35 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[03:47:35 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery

[03:47:35 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint

[03:47:35 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks

[03:47:35 Debug] IdentityServer4.Endpoints.DiscoveryKeyEndpoint
Start key discovery request

[03:47:35 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 3.4602ms

[03:47:35 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.1 POST http://idp:5006/connect/token application/x-www-form-urlencoded 43

[03:47:35 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[03:47:35 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[03:47:35 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /connect/token matched to endpoint type Token

[03:47:35 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint

[03:47:35 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token

[03:47:35 Debug] IdentityServer4.Endpoints.TokenEndpoint
Start token request.

[03:47:35 Debug] IdentityServer4.Validation.ClientSecretValidator
Start client validation

[03:47:35 Debug] IdentityServer4.Validation.BasicAuthenticationSecretParser
Start parsing Basic Authentication secret

[03:47:35 Debug] IdentityServer4.Validation.ISecretsListParser
Parser found secret: BasicAuthenticationSecretParser

[03:47:35 Debug] IdentityServer4.Validation.ISecretsListParser
Secret id found: Starter.Bff

[03:47:35 Debug] IdentityServer4.Stores.ValidatingClientStore
client configuration validation for client Starter.Bff succeeded.

[03:47:35 Debug] IdentityServer4.Validation.ISecretsListValidator
Secret validator success: HashedSharedSecretValidator

[03:47:35 Debug] IdentityServer4.Validation.ClientSecretValidator
Client validation success

[03:47:35 Information] IdentityServer4.Events.DefaultEventService
{"ClientId":"Starter.Bff","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HMEJTCFTJ788:00000002","TimeStamp":"2022-01-10T03:47:35.0000000Z","ProcessId":188,"LocalIpAddress":"172.24.0.3:5006","RemoteIpAddress":"172.24.0.5","$type":"ClientAuthenticationSuccessEvent"}

[03:47:35 Debug] IdentityServer4.Validation.TokenRequestValidator
Start token request validation

[03:47:35 Debug] IdentityServer4.Validation.TokenRequestValidator
Start client credentials token request validation

[03:47:35 Error] IdentityServer4.Validation.TokenRequestValidator
Client cannot request OpenID scopes in client credentials flow{"clientId":"Starter.Bff"}, details: {"ClientId":"Starter.Bff","ClientName":null,"GrantType":"client_credentials","Scopes":"profile","AuthorizationCode":"********","RefreshToken":"********","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"client_credentials","scope":"profile"},"$type":"TokenRequestValidationLog"}

[03:47:35 Information] IdentityServer4.Events.DefaultEventService
{"ClientId":"Starter.Bff","ClientName":null,"RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"profile","GrantType":"client_credentials","Error":"invalid_scope","ErrorDescription":null,"Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HMEJTCFTJ788:00000002","TimeStamp":"2022-01-10T03:47:35.0000000Z","ProcessId":188,"LocalIpAddress":"172.24.0.3:5006","RemoteIpAddress":"172.24.0.5","$type":"TokenIssuedFailureEvent"}

[03:47:35 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.1 POST http://idp:5006/connect/token application/x-www-form-urlencoded 43 - 400 - application/json;+charset=UTF-8 21.6765ms

[03:59:51 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration - -

[03:59:51 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[03:59:51 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[03:59:51 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /.well-known/openid-configuration matched to endpoint type Discovery

[03:59:51 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint

[03:59:51 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration

[03:59:51 Debug] IdentityServer4.Endpoints.DiscoveryEndpoint
Start discovery request

[03:59:51 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 11.5189ms

[03:59:51 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration/jwks - -

[03:59:51 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[03:59:51 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[03:59:51 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery

[03:59:51 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint

[03:59:51 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks

[03:59:51 Debug] IdentityServer4.Endpoints.DiscoveryKeyEndpoint
Start key discovery request

[03:59:51 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 4.1323ms

[03:59:51 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration - -

[03:59:51 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[03:59:51 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[03:59:51 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /.well-known/openid-configuration matched to endpoint type Discovery

[03:59:51 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint

[03:59:51 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration

[03:59:51 Debug] IdentityServer4.Endpoints.DiscoveryEndpoint
Start discovery request

[03:59:51 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 4.5597ms

[03:59:51 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration/jwks - -

[03:59:51 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[03:59:51 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[03:59:51 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery

[03:59:51 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint

[03:59:51 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks

[03:59:51 Debug] IdentityServer4.Endpoints.DiscoveryKeyEndpoint
Start key discovery request

[03:59:51 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 3.0521ms

[03:59:51 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.1 POST http://idp:5006/connect/token application/x-www-form-urlencoded 103

[03:59:51 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[03:59:51 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[03:59:51 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /connect/token matched to endpoint type Token

[03:59:51 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint

[03:59:51 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token

[03:59:51 Debug] IdentityServer4.Endpoints.TokenEndpoint
Start token request.

[03:59:51 Debug] IdentityServer4.Validation.ClientSecretValidator
Start client validation

[03:59:51 Debug] IdentityServer4.Validation.BasicAuthenticationSecretParser
Start parsing Basic Authentication secret

[03:59:51 Debug] IdentityServer4.Validation.ISecretsListParser
Parser found secret: BasicAuthenticationSecretParser

[03:59:51 Debug] IdentityServer4.Validation.ISecretsListParser
Secret id found: Starter.Bff

[03:59:51 Debug] IdentityServer4.Stores.ValidatingClientStore
client configuration validation for client Starter.Bff succeeded.

[03:59:51 Debug] IdentityServer4.Validation.ISecretsListValidator
Secret validator success: HashedSharedSecretValidator

[03:59:51 Debug] IdentityServer4.Validation.ClientSecretValidator
Client validation success

[03:59:51 Information] IdentityServer4.Events.DefaultEventService
{"ClientId":"Starter.Bff","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HMEJTCFTJ78B:00000002","TimeStamp":"2022-01-10T03:59:51.0000000Z","ProcessId":188,"LocalIpAddress":"172.24.0.3:5006","RemoteIpAddress":"172.24.0.5","$type":"ClientAuthenticationSuccessEvent"}

[03:59:51 Debug] IdentityServer4.Validation.TokenRequestValidator
Start token request validation

[03:59:51 Debug] IdentityServer4.Validation.TokenRequestValidator
Start validation of refresh token request

[03:59:51 Debug] IdentityServer4.Stores.DefaultRefreshTokenStore
refresh_token grant with value: 38FBC17C0CEF28CBFBEDD2E22F153147A04123141743FBAEA863374077794251 not found in store.

[03:59:51 Warning] IdentityServer4.Services.DefaultRefreshTokenService
Invalid refresh token

[03:59:51 Warning] IdentityServer4.Validation.TokenRequestValidator
Refresh token validation failed. aborting, {"ClientId":"Starter.Bff","ClientName":null,"GrantType":"refresh_token","Scopes":null,"AuthorizationCode":"********","RefreshToken":"********","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***"},"$type":"TokenRequestValidationLog"}

[03:59:51 Information] IdentityServer4.Events.DefaultEventService
{"ClientId":"Starter.Bff","ClientName":null,"RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":null,"GrantType":"refresh_token","Error":"invalid_grant","ErrorDescription":null,"Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HMEJTCFTJ78B:00000002","TimeStamp":"2022-01-10T03:59:51.0000000Z","ProcessId":188,"LocalIpAddress":"172.24.0.3:5006","RemoteIpAddress":"172.24.0.5","$type":"TokenIssuedFailureEvent"}

[03:59:51 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.1 POST http://idp:5006/connect/token application/x-www-form-urlencoded 103 - 400 - application/json;+charset=UTF-8 10.3909ms

[04:09:07 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration - -

[04:09:07 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[04:09:07 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[04:09:07 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /.well-known/openid-configuration matched to endpoint type Discovery

[04:09:07 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint

[04:09:07 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration

[04:09:07 Debug] IdentityServer4.Endpoints.DiscoveryEndpoint
Start discovery request

[04:09:07 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 4.1434ms

[04:09:07 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration/jwks - -

[04:09:07 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[04:09:07 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[04:09:07 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery

[04:09:07 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint

[04:09:07 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks

[04:09:07 Debug] IdentityServer4.Endpoints.DiscoveryKeyEndpoint
Start key discovery request

[04:09:07 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 3.4014ms

[04:09:07 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.0 GET https://localhost/connect/authorize?client_id=Starter.Bff&redirect_uri=https%3A%2F%2Flocalhost%2Fsignin-oidc&response_type=code&scope=openid%20profile%20Starter.Api%20offline_access&code_challenge=kHASyVFWGmeptc3SdBek2OpJOSwPyNWrpHgW9qut8d8&code_challenge_method=S256&response_mode=form_post&nonce=637773845477965948.Y2FjNDU4NDAtMzlkZi00Yzc0LWIyZmUtMjg4MjQwNzA0ZWExZTVhMmYxMzAtZDg3Zi00MGYwLWI4ZTEtN2Q0Y2MxOWY4ZGJk&state=CfDJ8B_OL-oYhMtAppB-AJAKkXo_h5vvO6NhZIelY6Dw5qhd350dRbpxkPBSJ42027MnVnaO8QtUU8FmWrGiyR9KA2olhtnbeDPpUTydQBF42hsVEc99rdGqcB3G_SfORlyxuFlYm7vzGMKU7OnfLpt6443lozGxuk5az65bw0JJZsxjdpSbA9Dip5ePzGJ9f0PJoSZhELFBYVrc1JwMkJHE7YozET5y_3IdCcglJ5FAjljz9cV6peUUKWihfyOgeM4K2TkQAMIg792wP8VqAjloXI_-q-t5B-3ejuDVDoUZiHO_6VDyilNTI64reJWFJogGHOMmEKkp2esJ46NTZ5VIuIZ8FbT6ZGZq8_z68dX6UL3dj5JgZ1h2yjxIfAR0fMo5CR57frrmJu84ME_ka9U6Isg&x-client-SKU=ID_NETSTANDARD2_0&x-client-ver=6.7.1.0 - -

[04:09:07 Information] Microsoft.AspNetCore.Cors.Infrastructure.CorsService
CORS policy execution successful.

[04:09:07 Information] Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware
No CORS policy found for the specified request.

[04:09:07 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[04:09:07 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[04:09:07 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /connect/authorize matched to endpoint type Authorize

[04:09:07 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint

[04:09:07 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize

[04:09:07 Debug] IdentityServer4.Endpoints.AuthorizeEndpoint
Start authorize request

[04:09:07 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[04:09:07 Debug] IdentityServer4.Endpoints.AuthorizeEndpoint
No user present in authorize request

[04:09:07 Debug] IdentityServer4.Validation.AuthorizeRequestValidator
Start authorize request protocol validation

[04:09:07 Debug] IdentityServer4.Stores.ValidatingClientStore
client configuration validation for client Starter.Bff succeeded.

[04:09:07 Debug] IdentityServer4.Validation.AuthorizeRequestValidator
Checking for PKCE parameters

[04:09:07 Debug] IdentityServer4.Validation.AuthorizeRequestValidator
Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator

[04:09:07 Debug] IdentityServer4.Endpoints.AuthorizeEndpoint
ValidatedAuthorizeRequest
{"ClientId":"Starter.Bff","ClientName":null,"RedirectUri":"https://localhost/signin-oidc","AllowedRedirectUris":["https://localhost/signin-oidc","https://bff:5005/signin-oidc","https://localhost/loggedin"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"form_post","GrantType":"authorization_code","RequestedScopes":"openid profile Starter.Api offline_access","State":"CfDJ8B_OL-oYhMtAppB-AJAKkXo_h5vvO6NhZIelY6Dw5qhd350dRbpxkPBSJ42027MnVnaO8QtUU8FmWrGiyR9KA2olhtnbeDPpUTydQBF42hsVEc99rdGqcB3G_SfORlyxuFlYm7vzGMKU7OnfLpt6443lozGxuk5az65bw0JJZsxjdpSbA9Dip5ePzGJ9f0PJoSZhELFBYVrc1JwMkJHE7YozET5y_3IdCcglJ5FAjljz9cV6peUUKWihfyOgeM4K2TkQAMIg792wP8VqAjloXI_-q-t5B-3ejuDVDoUZiHO_6VDyilNTI64reJWFJogGHOMmEKkp2esJ46NTZ5VIuIZ8FbT6ZGZq8_z68dX6UL3dj5JgZ1h2yjxIfAR0fMo5CR57frrmJu84ME_ka9U6Isg","UiLocales":null,"Nonce":"637773845477965948.Y2FjNDU4NDAtMzlkZi00Yzc0LWIyZmUtMjg4MjQwNzA0ZWExZTVhMmYxMzAtZDg3Zi00MGYwLWI4ZTEtN2Q0Y2MxOWY4ZGJk","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"Starter.Bff","redirect_uri":"https://localhost/signin-oidc","response_type":"code","scope":"openid profile Starter.Api offline_access","code_challenge":"kHASyVFWGmeptc3SdBek2OpJOSwPyNWrpHgW9qut8d8","code_challenge_method":"S256","response_mode":"form_post","nonce":"637773845477965948.Y2FjNDU4NDAtMzlkZi00Yzc0LWIyZmUtMjg4MjQwNzA0ZWExZTVhMmYxMzAtZDg3Zi00MGYwLWI4ZTEtN2Q0Y2MxOWY4ZGJk","state":"CfDJ8B_OL-oYhMtAppB-AJAKkXo_h5vvO6NhZIelY6Dw5qhd350dRbpxkPBSJ42027MnVnaO8QtUU8FmWrGiyR9KA2olhtnbeDPpUTydQBF42hsVEc99rdGqcB3G_SfORlyxuFlYm7vzGMKU7OnfLpt6443lozGxuk5az65bw0JJZsxjdpSbA9Dip5ePzGJ9f0PJoSZhELFBYVrc1JwMkJHE7YozET5y_3IdCcglJ5FAjljz9cV6peUUKWihfyOgeM4K2TkQAMIg792wP8VqAjloXI_-q-t5B-3ejuDVDoUZiHO_6VDyilNTI64reJWFJogGHOMmEKkp2esJ46NTZ5VIuIZ8FbT6ZGZq8_z68dX6UL3dj5JgZ1h2yjxIfAR0fMo5CR57frrmJu84ME_ka9U6Isg","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"6.7.1.0"},"$type":"AuthorizeRequestValidationLog"}

[04:09:07 Information] IdentityServer4.ResponseHandling.AuthorizeInteractionResponseGenerator
Showing login: User is not authenticated

[04:09:07 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.0 GET https://localhost/connect/authorize?client_id=Starter.Bff&redirect_uri=https%3A%2F%2Flocalhost%2Fsignin-oidc&response_type=code&scope=openid%20profile%20Starter.Api%20offline_access&code_challenge=kHASyVFWGmeptc3SdBek2OpJOSwPyNWrpHgW9qut8d8&code_challenge_method=S256&response_mode=form_post&nonce=637773845477965948.Y2FjNDU4NDAtMzlkZi00Yzc0LWIyZmUtMjg4MjQwNzA0ZWExZTVhMmYxMzAtZDg3Zi00MGYwLWI4ZTEtN2Q0Y2MxOWY4ZGJk&state=CfDJ8B_OL-oYhMtAppB-AJAKkXo_h5vvO6NhZIelY6Dw5qhd350dRbpxkPBSJ42027MnVnaO8QtUU8FmWrGiyR9KA2olhtnbeDPpUTydQBF42hsVEc99rdGqcB3G_SfORlyxuFlYm7vzGMKU7OnfLpt6443lozGxuk5az65bw0JJZsxjdpSbA9Dip5ePzGJ9f0PJoSZhELFBYVrc1JwMkJHE7YozET5y_3IdCcglJ5FAjljz9cV6peUUKWihfyOgeM4K2TkQAMIg792wP8VqAjloXI_-q-t5B-3ejuDVDoUZiHO_6VDyilNTI64reJWFJogGHOMmEKkp2esJ46NTZ5VIuIZ8FbT6ZGZq8_z68dX6UL3dj5JgZ1h2yjxIfAR0fMo5CR57frrmJu84ME_ka9U6Isg&x-client-SKU=ID_NETSTANDARD2_0&x-client-ver=6.7.1.0 - - - 302 0 - 34.8453ms

[04:09:07 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.0 GET https://localhost/Account/Login?ReturnUrl=%2Fconnect%2Fauthorize%2Fcallback%3Fclient_id%3DStarter.Bff%26redirect_uri%3Dhttps%253A%252F%252Flocalhost%252Fsignin-oidc%26response_type%3Dcode%26scope%3Dopenid%2520profile%2520Starter.Api%2520offline_access%26code_challenge%3DkHASyVFWGmeptc3SdBek2OpJOSwPyNWrpHgW9qut8d8%26code_challenge_method%3DS256%26response_mode%3Dform_post%26nonce%3D637773845477965948.Y2FjNDU4NDAtMzlkZi00Yzc0LWIyZmUtMjg4MjQwNzA0ZWExZTVhMmYxMzAtZDg3Zi00MGYwLWI4ZTEtN2Q0Y2MxOWY4ZGJk%26state%3DCfDJ8B_OL-oYhMtAppB-AJAKkXo_h5vvO6NhZIelY6Dw5qhd350dRbpxkPBSJ42027MnVnaO8QtUU8FmWrGiyR9KA2olhtnbeDPpUTydQBF42hsVEc99rdGqcB3G_SfORlyxuFlYm7vzGMKU7OnfLpt6443lozGxuk5az65bw0JJZsxjdpSbA9Dip5ePzGJ9f0PJoSZhELFBYVrc1JwMkJHE7YozET5y_3IdCcglJ5FAjljz9cV6peUUKWihfyOgeM4K2TkQAMIg792wP8VqAjloXI_-q-t5B-3ejuDVDoUZiHO_6VDyilNTI64reJWFJogGHOMmEKkp2esJ46NTZ5VIuIZ8FbT6ZGZq8_z68dX6UL3dj5JgZ1h2yjxIfAR0fMo5CR57frrmJu84ME_ka9U6Isg%26x-client-SKU%3DID_NETSTANDARD2_0%26x-client-ver%3D6.7.1.0 - -

[04:09:07 Information] Microsoft.AspNetCore.Cors.Infrastructure.CorsService
CORS policy execution successful.

[04:09:07 Information] Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware
No CORS policy found for the specified request.

[04:09:07 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[04:09:07 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[04:09:07 Information] Microsoft.AspNetCore.Routing.EndpointMiddleware
Executing endpoint 'Starter.Idp.Controllers.Account.AccountController.Login (IDP)'

[04:09:07 Information] Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker
Route matched with {action = "Login", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(System.String) on controller Starter.Idp.Controllers.Account.AccountController (IDP).

[04:09:07 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[04:09:07 Debug] IdentityServer4.Validation.AuthorizeRequestValidator
Start authorize request protocol validation

[04:09:07 Debug] IdentityServer4.Stores.ValidatingClientStore
client configuration validation for client Starter.Bff succeeded.

[04:09:07 Debug] IdentityServer4.Validation.AuthorizeRequestValidator
Checking for PKCE parameters

[04:09:07 Debug] IdentityServer4.Validation.AuthorizeRequestValidator
Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator

[04:09:07 Debug] IdentityServer4.Stores.ValidatingClientStore
client configuration validation for client Starter.Bff succeeded.

[04:09:07 Information] Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor
Executing ViewResult, running view Login.

[04:09:08 Information] Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor
Executed ViewResult - view Login executed in 117.817ms.

[04:09:08 Information] Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker
Executed action Starter.Idp.Controllers.Account.AccountController.Login (IDP) in 155.1685ms

[04:09:08 Information] Microsoft.AspNetCore.Routing.EndpointMiddleware
Executed endpoint 'Starter.Idp.Controllers.Account.AccountController.Login (IDP)'

[04:09:08 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.0 GET https://localhost/Account/Login?ReturnUrl=%2Fconnect%2Fauthorize%2Fcallback%3Fclient_id%3DStarter.Bff%26redirect_uri%3Dhttps%253A%252F%252Flocalhost%252Fsignin-oidc%26response_type%3Dcode%26scope%3Dopenid%2520profile%2520Starter.Api%2520offline_access%26code_challenge%3DkHASyVFWGmeptc3SdBek2OpJOSwPyNWrpHgW9qut8d8%26code_challenge_method%3DS256%26response_mode%3Dform_post%26nonce%3D637773845477965948.Y2FjNDU4NDAtMzlkZi00Yzc0LWIyZmUtMjg4MjQwNzA0ZWExZTVhMmYxMzAtZDg3Zi00MGYwLWI4ZTEtN2Q0Y2MxOWY4ZGJk%26state%3DCfDJ8B_OL-oYhMtAppB-AJAKkXo_h5vvO6NhZIelY6Dw5qhd350dRbpxkPBSJ42027MnVnaO8QtUU8FmWrGiyR9KA2olhtnbeDPpUTydQBF42hsVEc99rdGqcB3G_SfORlyxuFlYm7vzGMKU7OnfLpt6443lozGxuk5az65bw0JJZsxjdpSbA9Dip5ePzGJ9f0PJoSZhELFBYVrc1JwMkJHE7YozET5y_3IdCcglJ5FAjljz9cV6peUUKWihfyOgeM4K2TkQAMIg792wP8VqAjloXI_-q-t5B-3ejuDVDoUZiHO_6VDyilNTI64reJWFJogGHOMmEKkp2esJ46NTZ5VIuIZ8FbT6ZGZq8_z68dX6UL3dj5JgZ1h2yjxIfAR0fMo5CR57frrmJu84ME_ka9U6Isg%26x-client-SKU%3DID_NETSTANDARD2_0%26x-client-ver%3D6.7.1.0 - - - 200 - text/html;+charset=utf-8 186.9631ms

[04:09:08 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.0 GET https://localhost/lib/bootstrap/dist/css/bootstrap.min.css - -

[04:09:08 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.0 GET https://localhost/lib/jquery/dist/jquery.slim.min.js - -

[04:09:08 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.0 GET https://localhost/css/site.css - -

[04:09:08 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.0 GET https://localhost/lib/bootstrap/dist/js/bootstrap.bundle.min.js - -

[04:09:08 Information] Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware
Sending file. Request path: '/lib/jquery/dist/jquery.slim.min.js'. Physical path: '/app/wwwroot/lib/jquery/dist/jquery.slim.min.js'

[04:09:08 Information] Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware
Sending file. Request path: '/css/site.css'. Physical path: '/app/wwwroot/css/site.css'

[04:09:08 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.0 GET https://localhost/lib/jquery/dist/jquery.slim.min.js - - - 200 72397 application/javascript 25.2822ms

[04:09:08 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.0 GET https://localhost/css/site.css - - - 200 497 text/css 13.1636ms

[04:09:08 Information] Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware
Sending file. Request path: '/lib/bootstrap/dist/js/bootstrap.bundle.min.js'. Physical path: '/app/wwwroot/lib/bootstrap/dist/js/bootstrap.bundle.min.js'

[04:09:08 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.0 GET https://localhost/lib/bootstrap/dist/js/bootstrap.bundle.min.js - - - 200 80698 application/javascript 65.1971ms

[04:09:08 Information] Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware
Sending file. Request path: '/lib/bootstrap/dist/css/bootstrap.min.css'. Physical path: '/app/wwwroot/lib/bootstrap/dist/css/bootstrap.min.css'

[04:09:08 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.0 GET https://localhost/lib/bootstrap/dist/css/bootstrap.min.css - - - 200 159515 text/css 97.3937ms

[04:09:08 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.0 GET https://localhost/lib/bootstrap/dist/css/bootstrap.min.css.map - -

[04:09:08 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.0 GET https://localhost/lib/bootstrap/dist/js/bootstrap.bundle.min.js.map - -

[04:09:08 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.0 GET https://localhost/favicon.ico - -

[04:09:08 Information] Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware
Sending file. Request path: '/favicon.ico'. Physical path: '/app/wwwroot/favicon.ico'

[04:09:08 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.0 GET https://localhost/favicon.ico - - - 200 1150 image/x-icon 17.4946ms

[04:09:08 Information] Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware
Sending file. Request path: '/lib/bootstrap/dist/js/bootstrap.bundle.min.js.map'. Physical path: '/app/wwwroot/lib/bootstrap/dist/js/bootstrap.bundle.min.js.map'

[04:09:08 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.0 GET https://localhost/lib/bootstrap/dist/js/bootstrap.bundle.min.js.map - - - 200 318045 text/plain 39.3550ms

[04:09:08 Information] Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware
Sending file. Request path: '/lib/bootstrap/dist/css/bootstrap.min.css.map'. Physical path: '/app/wwwroot/lib/bootstrap/dist/css/bootstrap.min.css.map'

[04:09:08 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.0 GET https://localhost/lib/bootstrap/dist/css/bootstrap.min.css.map - - - 200 641867 text/plain 59.0517ms

[04:09:08 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.0 GET https://localhost/favicon.ico - -

[04:09:08 Information] Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware
Sending file. Request path: '/favicon.ico'. Physical path: '/app/wwwroot/favicon.ico'

[04:09:08 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.0 GET https://localhost/favicon.ico - - - 200 1150 image/x-icon 6.7816ms

[04:09:14 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.0 POST https://localhost/Account/Login?ReturnUrl=%2Fconnect%2Fauthorize%2Fcallback%3Fclient_id%3DStarter.Bff%26redirect_uri%3Dhttps%253A%252F%252Flocalhost%252Fsignin-oidc%26response_type%3Dcode%26scope%3Dopenid%2520profile%2520Starter.Api%2520offline_access%26code_challenge%3DkHASyVFWGmeptc3SdBek2OpJOSwPyNWrpHgW9qut8d8%26code_challenge_method%3DS256%26response_mode%3Dform_post%26nonce%3D637773845477965948.Y2FjNDU4NDAtMzlkZi00Yzc0LWIyZmUtMjg4MjQwNzA0ZWExZTVhMmYxMzAtZDg3Zi00MGYwLWI4ZTEtN2Q0Y2MxOWY4ZGJk%26state%3DCfDJ8B_OL-oYhMtAppB-AJAKkXo_h5vvO6NhZIelY6Dw5qhd350dRbpxkPBSJ42027MnVnaO8QtUU8FmWrGiyR9KA2olhtnbeDPpUTydQBF42hsVEc99rdGqcB3G_SfORlyxuFlYm7vzGMKU7OnfLpt6443lozGxuk5az65bw0JJZsxjdpSbA9Dip5ePzGJ9f0PJoSZhELFBYVrc1JwMkJHE7YozET5y_3IdCcglJ5FAjljz9cV6peUUKWihfyOgeM4K2TkQAMIg792wP8VqAjloXI_-q-t5B-3ejuDVDoUZiHO_6VDyilNTI64reJWFJogGHOMmEKkp2esJ46NTZ5VIuIZ8FbT6ZGZq8_z68dX6UL3dj5JgZ1h2yjxIfAR0fMo5CR57frrmJu84ME_ka9U6Isg%26x-client-SKU%3DID_NETSTANDARD2_0%26x-client-ver%3D6.7.1.0 application/x-www-form-urlencoded 1198

[04:09:14 Information] Microsoft.AspNetCore.Cors.Infrastructure.CorsService
CORS policy execution successful.

[04:09:14 Information] Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware
No CORS policy found for the specified request.

[04:09:14 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[04:09:14 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[04:09:14 Information] Microsoft.AspNetCore.Routing.EndpointMiddleware
Executing endpoint 'Starter.Idp.Controllers.Account.AccountController.Login (IDP)'

[04:09:14 Information] Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker
Route matched with {action = "Login", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(Starter.Idp.Models.Account.LoginInputModel, System.String) on controller Starter.Idp.Controllers.Account.AccountController (IDP).

[04:09:14 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[04:09:14 Debug] IdentityServer4.Validation.AuthorizeRequestValidator
Start authorize request protocol validation

[04:09:14 Debug] IdentityServer4.Stores.ValidatingClientStore
client configuration validation for client Starter.Bff succeeded.

[04:09:14 Debug] IdentityServer4.Validation.AuthorizeRequestValidator
Checking for PKCE parameters

[04:09:14 Debug] IdentityServer4.Validation.AuthorizeRequestValidator
Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator

[04:09:14 Information] Microsoft.EntityFrameworkCore.Infrastructure
Entity Framework Core 5.0.8 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None

[04:09:14 Information] Microsoft.EntityFrameworkCore.Database.Command
Executed DbCommand (1ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0

[04:09:14 Information] Microsoft.EntityFrameworkCore.Database.Command
Executed DbCommand (3ms) [Parameters=[@__user_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0

[04:09:14 Information] Microsoft.EntityFrameworkCore.Database.Command
Executed DbCommand (3ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0

[04:09:14 Debug] IdentityServer4.Hosting.IdentityServerAuthenticationService
Augmenting SignInContext

[04:09:14 Debug] IdentityServer4.Hosting.IdentityServerAuthenticationService
Adding idp claim with value: local

[04:09:14 Debug] IdentityServer4.Hosting.IdentityServerAuthenticationService
Adding auth_time claim with value: 1641787754

[04:09:14 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[04:09:14 Information] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application signed in.

[04:09:14 Information] Microsoft.EntityFrameworkCore.Database.Command
Executed DbCommand (1ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0

[04:09:14 Information] IdentityServer4.Events.DefaultEventService
{"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"4","DisplayName":"bob","Endpoint":"UI","ClientId":"Starter.Bff","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HMEJTCFTJ78N:00000002","TimeStamp":"2022-01-10T04:09:14.0000000Z","ProcessId":188,"LocalIpAddress":"172.24.0.3:5007","RemoteIpAddress":"172.24.0.1","$type":"UserLoginSuccessEvent"}

[04:09:15 Information] Microsoft.AspNetCore.Mvc.Infrastructure.RedirectResultExecutor
Executing RedirectResult, redirecting to /connect/authorize/callback?client_id=Starter.Bff&redirect_uri=https%3A%2F%2Flocalhost%2Fsignin-oidc&response_type=code&scope=openid%20profile%20Starter.Api%20offline_access&code_challenge=kHASyVFWGmeptc3SdBek2OpJOSwPyNWrpHgW9qut8d8&code_challenge_method=S256&response_mode=form_post&nonce=637773845477965948.Y2FjNDU4NDAtMzlkZi00Yzc0LWIyZmUtMjg4MjQwNzA0ZWExZTVhMmYxMzAtZDg3Zi00MGYwLWI4ZTEtN2Q0Y2MxOWY4ZGJk&state=CfDJ8B_OL-oYhMtAppB-AJAKkXo_h5vvO6NhZIelY6Dw5qhd350dRbpxkPBSJ42027MnVnaO8QtUU8FmWrGiyR9KA2olhtnbeDPpUTydQBF42hsVEc99rdGqcB3G_SfORlyxuFlYm7vzGMKU7OnfLpt6443lozGxuk5az65bw0JJZsxjdpSbA9Dip5ePzGJ9f0PJoSZhELFBYVrc1JwMkJHE7YozET5y_3IdCcglJ5FAjljz9cV6peUUKWihfyOgeM4K2TkQAMIg792wP8VqAjloXI_-q-t5B-3ejuDVDoUZiHO_6VDyilNTI64reJWFJogGHOMmEKkp2esJ46NTZ5VIuIZ8FbT6ZGZq8_z68dX6UL3dj5JgZ1h2yjxIfAR0fMo5CR57frrmJu84ME_ka9U6Isg&x-client-SKU=ID_NETSTANDARD2_0&x-client-ver=6.7.1.0.

[04:09:15 Information] Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker
Executed action Starter.Idp.Controllers.Account.AccountController.Login (IDP) in 174.3129ms

[04:09:15 Information] Microsoft.AspNetCore.Routing.EndpointMiddleware
Executed endpoint 'Starter.Idp.Controllers.Account.AccountController.Login (IDP)'

[04:09:15 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.0 POST https://localhost/Account/Login?ReturnUrl=%2Fconnect%2Fauthorize%2Fcallback%3Fclient_id%3DStarter.Bff%26redirect_uri%3Dhttps%253A%252F%252Flocalhost%252Fsignin-oidc%26response_type%3Dcode%26scope%3Dopenid%2520profile%2520Starter.Api%2520offline_access%26code_challenge%3DkHASyVFWGmeptc3SdBek2OpJOSwPyNWrpHgW9qut8d8%26code_challenge_method%3DS256%26response_mode%3Dform_post%26nonce%3D637773845477965948.Y2FjNDU4NDAtMzlkZi00Yzc0LWIyZmUtMjg4MjQwNzA0ZWExZTVhMmYxMzAtZDg3Zi00MGYwLWI4ZTEtN2Q0Y2MxOWY4ZGJk%26state%3DCfDJ8B_OL-oYhMtAppB-AJAKkXo_h5vvO6NhZIelY6Dw5qhd350dRbpxkPBSJ42027MnVnaO8QtUU8FmWrGiyR9KA2olhtnbeDPpUTydQBF42hsVEc99rdGqcB3G_SfORlyxuFlYm7vzGMKU7OnfLpt6443lozGxuk5az65bw0JJZsxjdpSbA9Dip5ePzGJ9f0PJoSZhELFBYVrc1JwMkJHE7YozET5y_3IdCcglJ5FAjljz9cV6peUUKWihfyOgeM4K2TkQAMIg792wP8VqAjloXI_-q-t5B-3ejuDVDoUZiHO_6VDyilNTI64reJWFJogGHOMmEKkp2esJ46NTZ5VIuIZ8FbT6ZGZq8_z68dX6UL3dj5JgZ1h2yjxIfAR0fMo5CR57frrmJu84ME_ka9U6Isg%26x-client-SKU%3DID_NETSTANDARD2_0%26x-client-ver%3D6.7.1.0 application/x-www-form-urlencoded 1198 - 302 0 - 187.6035ms

[04:09:15 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.0 GET https://localhost/connect/authorize/callback?client_id=Starter.Bff&redirect_uri=https%3A%2F%2Flocalhost%2Fsignin-oidc&response_type=code&scope=openid%20profile%20Starter.Api%20offline_access&code_challenge=kHASyVFWGmeptc3SdBek2OpJOSwPyNWrpHgW9qut8d8&code_challenge_method=S256&response_mode=form_post&nonce=637773845477965948.Y2FjNDU4NDAtMzlkZi00Yzc0LWIyZmUtMjg4MjQwNzA0ZWExZTVhMmYxMzAtZDg3Zi00MGYwLWI4ZTEtN2Q0Y2MxOWY4ZGJk&state=CfDJ8B_OL-oYhMtAppB-AJAKkXo_h5vvO6NhZIelY6Dw5qhd350dRbpxkPBSJ42027MnVnaO8QtUU8FmWrGiyR9KA2olhtnbeDPpUTydQBF42hsVEc99rdGqcB3G_SfORlyxuFlYm7vzGMKU7OnfLpt6443lozGxuk5az65bw0JJZsxjdpSbA9Dip5ePzGJ9f0PJoSZhELFBYVrc1JwMkJHE7YozET5y_3IdCcglJ5FAjljz9cV6peUUKWihfyOgeM4K2TkQAMIg792wP8VqAjloXI_-q-t5B-3ejuDVDoUZiHO_6VDyilNTI64reJWFJogGHOMmEKkp2esJ46NTZ5VIuIZ8FbT6ZGZq8_z68dX6UL3dj5JgZ1h2yjxIfAR0fMo5CR57frrmJu84ME_ka9U6Isg&x-client-SKU=ID_NETSTANDARD2_0&x-client-ver=6.7.1.0 - -

[04:09:15 Information] Microsoft.AspNetCore.Cors.Infrastructure.CorsService
CORS policy execution successful.

[04:09:15 Information] Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware
No CORS policy found for the specified request.

[04:09:15 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was successfully authenticated.

[04:09:15 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was successfully authenticated.

[04:09:15 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /connect/authorize/callback matched to endpoint type Authorize

[04:09:15 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint

[04:09:15 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback

[04:09:15 Debug] IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
Start authorize callback request

[04:09:15 Debug] IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
User in authorize request: 4

[04:09:15 Debug] IdentityServer4.Validation.AuthorizeRequestValidator
Start authorize request protocol validation

[04:09:15 Debug] IdentityServer4.Stores.ValidatingClientStore
client configuration validation for client Starter.Bff succeeded.

[04:09:15 Debug] IdentityServer4.Validation.AuthorizeRequestValidator
Checking for PKCE parameters

[04:09:15 Debug] IdentityServer4.Validation.AuthorizeRequestValidator
Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator

[04:09:15 Debug] IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
ValidatedAuthorizeRequest
{"ClientId":"Starter.Bff","ClientName":null,"RedirectUri":"https://localhost/signin-oidc","AllowedRedirectUris":["https://localhost/signin-oidc","https://bff:5005/signin-oidc","https://localhost/loggedin"],"SubjectId":"4","ResponseType":"code","ResponseMode":"form_post","GrantType":"authorization_code","RequestedScopes":"openid profile Starter.Api offline_access","State":"CfDJ8B_OL-oYhMtAppB-AJAKkXo_h5vvO6NhZIelY6Dw5qhd350dRbpxkPBSJ42027MnVnaO8QtUU8FmWrGiyR9KA2olhtnbeDPpUTydQBF42hsVEc99rdGqcB3G_SfORlyxuFlYm7vzGMKU7OnfLpt6443lozGxuk5az65bw0JJZsxjdpSbA9Dip5ePzGJ9f0PJoSZhELFBYVrc1JwMkJHE7YozET5y_3IdCcglJ5FAjljz9cV6peUUKWihfyOgeM4K2TkQAMIg792wP8VqAjloXI_-q-t5B-3ejuDVDoUZiHO_6VDyilNTI64reJWFJogGHOMmEKkp2esJ46NTZ5VIuIZ8FbT6ZGZq8_z68dX6UL3dj5JgZ1h2yjxIfAR0fMo5CR57frrmJu84ME_ka9U6Isg","UiLocales":null,"Nonce":"637773845477965948.Y2FjNDU4NDAtMzlkZi00Yzc0LWIyZmUtMjg4MjQwNzA0ZWExZTVhMmYxMzAtZDg3Zi00MGYwLWI4ZTEtN2Q0Y2MxOWY4ZGJk","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"086FAE565F6D1C6EAA0740DB4605C3E3","Raw":{"client_id":"Starter.Bff","redirect_uri":"https://localhost/signin-oidc","response_type":"code","scope":"openid profile Starter.Api offline_access","code_challenge":"kHASyVFWGmeptc3SdBek2OpJOSwPyNWrpHgW9qut8d8","code_challenge_method":"S256","response_mode":"form_post","nonce":"637773845477965948.Y2FjNDU4NDAtMzlkZi00Yzc0LWIyZmUtMjg4MjQwNzA0ZWExZTVhMmYxMzAtZDg3Zi00MGYwLWI4ZTEtN2Q0Y2MxOWY4ZGJk","state":"CfDJ8B_OL-oYhMtAppB-AJAKkXo_h5vvO6NhZIelY6Dw5qhd350dRbpxkPBSJ42027MnVnaO8QtUU8FmWrGiyR9KA2olhtnbeDPpUTydQBF42hsVEc99rdGqcB3G_SfORlyxuFlYm7vzGMKU7OnfLpt6443lozGxuk5az65bw0JJZsxjdpSbA9Dip5ePzGJ9f0PJoSZhELFBYVrc1JwMkJHE7YozET5y_3IdCcglJ5FAjljz9cV6peUUKWihfyOgeM4K2TkQAMIg792wP8VqAjloXI_-q-t5B-3ejuDVDoUZiHO_6VDyilNTI64reJWFJogGHOMmEKkp2esJ46NTZ5VIuIZ8FbT6ZGZq8_z68dX6UL3dj5JgZ1h2yjxIfAR0fMo5CR57frrmJu84ME_ka9U6Isg","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"6.7.1.0"},"$type":"AuthorizeRequestValidationLog"}

[04:09:15 Information] Microsoft.EntityFrameworkCore.Infrastructure
Entity Framework Core 5.0.8 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None

[04:09:15 Information] Microsoft.EntityFrameworkCore.Database.Command
Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0

[04:09:15 Debug] IdentityServer4.Services.DefaultConsentService
Client is configured to not require consent, no consent is required

[04:09:15 Debug] IdentityServer4.ResponseHandling.AuthorizeResponseGenerator
Creating Authorization Code Flow response.

[04:09:15 Information] IdentityServer4.Events.DefaultEventService
{"ClientId":"Starter.Bff","ClientName":null,"RedirectUri":"https://localhost/signin-oidc","Endpoint":"Authorize","SubjectId":"4","Scopes":"openid profile Starter.Api offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****97B7","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HMEJTCFTJ78O:00000002","TimeStamp":"2022-01-10T04:09:15.0000000Z","ProcessId":188,"LocalIpAddress":"172.24.0.3:5007","RemoteIpAddress":"172.24.0.1","$type":"TokenIssuedSuccessEvent"}

[04:09:15 Debug] IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
Authorize endpoint response
{"SubjectId":"4","ClientId":"Starter.Bff","RedirectUri":"https://localhost/signin-oidc","State":"CfDJ8B_OL-oYhMtAppB-AJAKkXo_h5vvO6NhZIelY6Dw5qhd350dRbpxkPBSJ42027MnVnaO8QtUU8FmWrGiyR9KA2olhtnbeDPpUTydQBF42hsVEc99rdGqcB3G_SfORlyxuFlYm7vzGMKU7OnfLpt6443lozGxuk5az65bw0JJZsxjdpSbA9Dip5ePzGJ9f0PJoSZhELFBYVrc1JwMkJHE7YozET5y_3IdCcglJ5FAjljz9cV6peUUKWihfyOgeM4K2TkQAMIg792wP8VqAjloXI_-q-t5B-3ejuDVDoUZiHO_6VDyilNTI64reJWFJogGHOMmEKkp2esJ46NTZ5VIuIZ8FbT6ZGZq8_z68dX6UL3dj5JgZ1h2yjxIfAR0fMo5CR57frrmJu84ME_ka9U6Isg","Scope":"openid profile Starter.Api offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}

[04:09:15 Debug] IdentityServer4.Hosting.IdentityServerAuthenticationService
Augmenting SignInContext

[04:09:15 Information] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application signed in.

[04:09:15 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.0 GET https://localhost/connect/authorize/callback?client_id=Starter.Bff&redirect_uri=https%3A%2F%2Flocalhost%2Fsignin-oidc&response_type=code&scope=openid%20profile%20Starter.Api%20offline_access&code_challenge=kHASyVFWGmeptc3SdBek2OpJOSwPyNWrpHgW9qut8d8&code_challenge_method=S256&response_mode=form_post&nonce=637773845477965948.Y2FjNDU4NDAtMzlkZi00Yzc0LWIyZmUtMjg4MjQwNzA0ZWExZTVhMmYxMzAtZDg3Zi00MGYwLWI4ZTEtN2Q0Y2MxOWY4ZGJk&state=CfDJ8B_OL-oYhMtAppB-AJAKkXo_h5vvO6NhZIelY6Dw5qhd350dRbpxkPBSJ42027MnVnaO8QtUU8FmWrGiyR9KA2olhtnbeDPpUTydQBF42hsVEc99rdGqcB3G_SfORlyxuFlYm7vzGMKU7OnfLpt6443lozGxuk5az65bw0JJZsxjdpSbA9Dip5ePzGJ9f0PJoSZhELFBYVrc1JwMkJHE7YozET5y_3IdCcglJ5FAjljz9cV6peUUKWihfyOgeM4K2TkQAMIg792wP8VqAjloXI_-q-t5B-3ejuDVDoUZiHO_6VDyilNTI64reJWFJogGHOMmEKkp2esJ46NTZ5VIuIZ8FbT6ZGZq8_z68dX6UL3dj5JgZ1h2yjxIfAR0fMo5CR57frrmJu84ME_ka9U6Isg&x-client-SKU=ID_NETSTANDARD2_0&x-client-ver=6.7.1.0 - - - 200 - text/html;+charset=UTF-8 88.7340ms

[04:09:15 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.1 POST http://idp:5006/connect/token application/x-www-form-urlencoded 251

[04:09:15 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[04:09:15 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[04:09:15 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /connect/token matched to endpoint type Token

[04:09:15 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint

[04:09:15 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token

[04:09:15 Debug] IdentityServer4.Endpoints.TokenEndpoint
Start token request.

[04:09:15 Debug] IdentityServer4.Validation.ClientSecretValidator
Start client validation

[04:09:15 Debug] IdentityServer4.Validation.BasicAuthenticationSecretParser
Start parsing Basic Authentication secret

[04:09:15 Debug] IdentityServer4.Validation.PostBodySecretParser
Start parsing for secret in post body

[04:09:15 Debug] IdentityServer4.Validation.ISecretsListParser
Parser found secret: PostBodySecretParser

[04:09:15 Debug] IdentityServer4.Validation.ISecretsListParser
Secret id found: Starter.Bff

[04:09:15 Debug] IdentityServer4.Stores.ValidatingClientStore
client configuration validation for client Starter.Bff succeeded.

[04:09:15 Debug] IdentityServer4.Validation.ISecretsListValidator
Secret validator success: HashedSharedSecretValidator

[04:09:15 Debug] IdentityServer4.Validation.ClientSecretValidator
Client validation success

[04:09:15 Information] IdentityServer4.Events.DefaultEventService
{"ClientId":"Starter.Bff","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HMEJTCFTJ78C:00000004","TimeStamp":"2022-01-10T04:09:15.0000000Z","ProcessId":188,"LocalIpAddress":"172.24.0.3:5006","RemoteIpAddress":"172.24.0.5","$type":"ClientAuthenticationSuccessEvent"}

[04:09:15 Debug] IdentityServer4.Validation.TokenRequestValidator
Start token request validation

[04:09:15 Debug] IdentityServer4.Validation.TokenRequestValidator
Start validation of authorization code token request

[04:09:15 Debug] IdentityServer4.Validation.TokenRequestValidator
Client required a proof key for code exchange. Starting PKCE validation

[04:09:15 Information] Microsoft.EntityFrameworkCore.Infrastructure
Entity Framework Core 5.0.8 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None

[04:09:15 Information] Microsoft.EntityFrameworkCore.Database.Command
Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0

[04:09:15 Debug] IdentityServer4.Validation.TokenRequestValidator
Validation of authorization code token request success

[04:09:15 Information] IdentityServer4.Validation.TokenRequestValidator
Token request validation success, {"ClientId":"Starter.Bff","ClientName":null,"GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"****97B7","RefreshToken":"********","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"Starter.Bff","client_secret":"***REDACTED***","code":"56C56D8387B5B476386DF1565A8D771C4301C683EF8BE2677C128FCEC09C97B7","grant_type":"authorization_code","redirect_uri":"https://localhost/signin-oidc","code_verifier":"ys55_h8EsSKmyEpWeV1rOsfeFwNFUQVR54D6VdLKvTk"},"$type":"TokenRequestValidationLog"}

[04:09:15 Debug] IdentityServer4.Stores.ValidatingClientStore
client configuration validation for client Starter.Bff succeeded.

[04:09:15 Debug] IdentityServer4.Services.DefaultClaimsService
Getting claims for access token for client: Starter.Bff

[04:09:15 Debug] IdentityServer4.Services.DefaultClaimsService
Getting claims for access token for subject: 4

[04:09:15 Information] Microsoft.EntityFrameworkCore.Database.Command
Executed DbCommand (2ms) [Parameters=[@__user_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0

[04:09:15 Information] Microsoft.EntityFrameworkCore.Database.Command
Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0

[04:09:15 Debug] IdentityServer4.Services.DefaultRefreshTokenService
Creating refresh token

[04:09:15 Debug] IdentityServer4.Services.DefaultRefreshTokenService
Setting an absolute lifetime: 2592000

[04:09:15 Debug] IdentityServer4.Stores.ValidatingClientStore
client configuration validation for client Starter.Bff succeeded.

[04:09:15 Debug] IdentityServer4.Services.DefaultClaimsService
Getting claims for identity token for subject: 4 and client: Starter.Bff

[04:09:15 Debug] IdentityServer4.Services.DefaultClaimsService
In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.

[04:09:15 Information] IdentityServer4.Events.DefaultEventService
{"ClientId":"Starter.Bff","ClientName":null,"RedirectUri":null,"Endpoint":"Token","SubjectId":"4","Scopes":"openid profile Starter.Api offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****BN5w","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****80FC","$type":"Token"},{"TokenType":"access_token","TokenValue":"****i0tg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HMEJTCFTJ78C:00000004","TimeStamp":"2022-01-10T04:09:15.0000000Z","ProcessId":188,"LocalIpAddress":"172.24.0.3:5006","RemoteIpAddress":"172.24.0.5","$type":"TokenIssuedSuccessEvent"}

[04:09:15 Debug] IdentityServer4.Endpoints.TokenEndpoint
Token request success.

[04:09:15 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.1 POST http://idp:5006/connect/token application/x-www-form-urlencoded 251 - 200 - application/json;+charset=UTF-8 92.3282ms

[04:09:15 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.1 GET http://idp:5006/connect/userinfo - -

[04:09:15 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[04:09:15 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[04:09:15 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /connect/userinfo matched to endpoint type Userinfo

[04:09:15 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint

[04:09:15 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo

[04:09:15 Debug] IdentityServer4.Endpoints.UserInfoEndpoint
Start userinfo request

[04:09:15 Debug] IdentityServer4.Validation.BearerTokenUsageValidator
Bearer token found in header

[04:09:15 Debug] IdentityServer4.Stores.ValidatingClientStore
client configuration validation for client Starter.Bff succeeded.

[04:09:15 Debug] IdentityServer4.Stores.ValidatingClientStore
client configuration validation for client Starter.Bff succeeded.

[04:09:15 Information] Microsoft.EntityFrameworkCore.Infrastructure
Entity Framework Core 5.0.8 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None

[04:09:15 Information] Microsoft.EntityFrameworkCore.Database.Command
Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0

[04:09:15 Debug] IdentityServer4.Validation.TokenValidator
Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator

[04:09:15 Debug] IdentityServer4.Validation.TokenValidator
Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":"EF4FF3643B244E224D2A7A71BCEF9F3B","Claims":{"nbf":1641787755,"exp":1641791355,"iss":"https://localhost","aud":["starter.api","https://localhost/resources"],"client_id":"Starter.Bff","sub":"4","auth_time":1641787754,"idp":"local","jti":"EF4FF3643B244E224D2A7A71BCEF9F3B","sid":"086FAE565F6D1C6EAA0740DB4605C3E3","iat":1641787755,"scope":["openid","profile","Starter.Api","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}

[04:09:15 Debug] IdentityServer4.ResponseHandling.UserInfoResponseGenerator
Creating userinfo response

[04:09:15 Debug] IdentityServer4.ResponseHandling.UserInfoResponseGenerator
Scopes in access token: openid profile Starter.Api offline_access

[04:09:15 Debug] IdentityServer4.ResponseHandling.UserInfoResponseGenerator
Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at

[04:09:15 Information] Microsoft.EntityFrameworkCore.Database.Command
Executed DbCommand (1ms) [Parameters=[@__user_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0

[04:09:15 Information] Microsoft.EntityFrameworkCore.Database.Command
Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0

[04:09:15 Information] IdentityServer4.ResponseHandling.UserInfoResponseGenerator
Profile service returned the following claim types: sub website family_name given_name name preferred_username

[04:09:15 Debug] IdentityServer4.Endpoints.UserInfoEndpoint
End userinfo request

[04:09:15 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.1 GET http://idp:5006/connect/userinfo - - - 200 - application/json;+charset=UTF-8 25.8902ms

[04:09:15 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration - -

[04:09:15 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[04:09:15 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[04:09:15 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /.well-known/openid-configuration matched to endpoint type Discovery

[04:09:15 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint

[04:09:15 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration

[04:09:15 Debug] IdentityServer4.Endpoints.DiscoveryEndpoint
Start discovery request

[04:09:15 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 3.4545ms

[04:09:15 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration/jwks - -

[04:09:15 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[04:09:15 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[04:09:15 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery

[04:09:15 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint

[04:09:15 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks

[04:09:15 Debug] IdentityServer4.Endpoints.DiscoveryKeyEndpoint
Start key discovery request

[04:09:15 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 3.5631ms

[04:09:15 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.1 GET http://idp:5006/connect/userinfo - -

[04:09:15 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[04:09:15 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[04:09:15 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /connect/userinfo matched to endpoint type Userinfo

[04:09:15 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint

[04:09:15 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo

[04:09:15 Debug] IdentityServer4.Endpoints.UserInfoEndpoint
Start userinfo request

[04:09:15 Debug] IdentityServer4.Validation.BearerTokenUsageValidator
Bearer token found in header

[04:09:15 Debug] IdentityServer4.Stores.ValidatingClientStore
client configuration validation for client Starter.Bff succeeded.

[04:09:15 Debug] IdentityServer4.Stores.ValidatingClientStore
client configuration validation for client Starter.Bff succeeded.

[04:09:15 Information] Microsoft.EntityFrameworkCore.Infrastructure
Entity Framework Core 5.0.8 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None

[04:09:15 Information] Microsoft.EntityFrameworkCore.Database.Command
Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0

[04:09:15 Debug] IdentityServer4.Validation.TokenValidator
Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator

[04:09:15 Debug] IdentityServer4.Validation.TokenValidator
Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":"EF4FF3643B244E224D2A7A71BCEF9F3B","Claims":{"nbf":1641787755,"exp":1641791355,"iss":"https://localhost","aud":["starter.api","https://localhost/resources"],"client_id":"Starter.Bff","sub":"4","auth_time":1641787754,"idp":"local","jti":"EF4FF3643B244E224D2A7A71BCEF9F3B","sid":"086FAE565F6D1C6EAA0740DB4605C3E3","iat":1641787755,"scope":["openid","profile","Starter.Api","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}

[04:09:15 Debug] IdentityServer4.ResponseHandling.UserInfoResponseGenerator
Creating userinfo response

[04:09:15 Debug] IdentityServer4.ResponseHandling.UserInfoResponseGenerator
Scopes in access token: openid profile Starter.Api offline_access

[04:09:15 Debug] IdentityServer4.ResponseHandling.UserInfoResponseGenerator
Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at

[04:09:15 Information] Microsoft.EntityFrameworkCore.Database.Command
Executed DbCommand (1ms) [Parameters=[@__user_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0

[04:09:15 Information] Microsoft.EntityFrameworkCore.Database.Command
Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0

[04:09:15 Information] IdentityServer4.ResponseHandling.UserInfoResponseGenerator
Profile service returned the following claim types: sub website family_name given_name name preferred_username

[04:09:15 Debug] IdentityServer4.Endpoints.UserInfoEndpoint
End userinfo request

[04:09:15 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.1 GET http://idp:5006/connect/userinfo - - - 200 - application/json;+charset=UTF-8 38.9511ms

[04:11:39 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration - -

[04:11:39 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[04:11:39 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[04:11:39 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /.well-known/openid-configuration matched to endpoint type Discovery

[04:11:39 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint

[04:11:39 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration

[04:11:39 Debug] IdentityServer4.Endpoints.DiscoveryEndpoint
Start discovery request

[04:11:39 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 3.5914ms

[04:11:39 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration/jwks - -

[04:11:39 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[04:11:39 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[04:11:39 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery

[04:11:39 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint

[04:11:39 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks

[04:11:39 Debug] IdentityServer4.Endpoints.DiscoveryKeyEndpoint
Start key discovery request

[04:11:39 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 6.6411ms

[04:11:39 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.1 GET http://idp:5006/connect/userinfo - -

[04:11:39 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[04:11:39 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[04:11:39 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /connect/userinfo matched to endpoint type Userinfo

[04:11:39 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint

[04:11:39 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo

[04:11:39 Debug] IdentityServer4.Endpoints.UserInfoEndpoint
Start userinfo request

[04:11:39 Debug] IdentityServer4.Validation.BearerTokenUsageValidator
Bearer token found in header

[04:11:39 Debug] IdentityServer4.Stores.ValidatingClientStore
client configuration validation for client Starter.Bff succeeded.

[04:11:39 Debug] IdentityServer4.Stores.ValidatingClientStore
client configuration validation for client Starter.Bff succeeded.

[04:11:39 Information] Microsoft.EntityFrameworkCore.Infrastructure
Entity Framework Core 5.0.8 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None

[04:11:39 Information] Microsoft.EntityFrameworkCore.Database.Command
Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0

[04:11:39 Debug] IdentityServer4.Validation.TokenValidator
Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator

[04:11:39 Debug] IdentityServer4.Validation.TokenValidator
Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":"EF4FF3643B244E224D2A7A71BCEF9F3B","Claims":{"nbf":1641787755,"exp":1641791355,"iss":"https://localhost","aud":["starter.api","https://localhost/resources"],"client_id":"Starter.Bff","sub":"4","auth_time":1641787754,"idp":"local","jti":"EF4FF3643B244E224D2A7A71BCEF9F3B","sid":"086FAE565F6D1C6EAA0740DB4605C3E3","iat":1641787755,"scope":["openid","profile","Starter.Api","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}

[04:11:39 Debug] IdentityServer4.ResponseHandling.UserInfoResponseGenerator
Creating userinfo response

[04:11:39 Debug] IdentityServer4.ResponseHandling.UserInfoResponseGenerator
Scopes in access token: openid profile Starter.Api offline_access

[04:11:39 Debug] IdentityServer4.ResponseHandling.UserInfoResponseGenerator
Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at

[04:11:39 Information] Microsoft.EntityFrameworkCore.Database.Command
Executed DbCommand (1ms) [Parameters=[@__user_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0

[04:11:39 Information] Microsoft.EntityFrameworkCore.Database.Command
Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0

[04:11:39 Information] IdentityServer4.ResponseHandling.UserInfoResponseGenerator
Profile service returned the following claim types: sub website family_name given_name name preferred_username

[04:11:39 Debug] IdentityServer4.Endpoints.UserInfoEndpoint
End userinfo request

[04:11:39 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.1 GET http://idp:5006/connect/userinfo - - - 200 - application/json;+charset=UTF-8 14.2358ms

[04:17:00 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration - -

[04:17:00 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[04:17:00 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[04:17:00 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /.well-known/openid-configuration matched to endpoint type Discovery

[04:17:00 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint

[04:17:00 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration

[04:17:00 Debug] IdentityServer4.Endpoints.DiscoveryEndpoint
Start discovery request

[04:17:00 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 6.8133ms

[04:17:00 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration/jwks - -

[04:17:00 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[04:17:00 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[04:17:00 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery

[04:17:00 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint

[04:17:00 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks

[04:17:00 Debug] IdentityServer4.Endpoints.DiscoveryKeyEndpoint
Start key discovery request

[04:17:00 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 3.3046ms

[04:17:00 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.1 GET http://idp:5006/connect/userinfo - -

[04:17:00 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[04:17:00 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[04:17:00 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /connect/userinfo matched to endpoint type Userinfo

[04:17:00 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint

[04:17:00 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo

[04:17:00 Debug] IdentityServer4.Endpoints.UserInfoEndpoint
Start userinfo request

[04:17:00 Debug] IdentityServer4.Validation.BearerTokenUsageValidator
Bearer token found in header

[04:17:00 Debug] IdentityServer4.Stores.ValidatingClientStore
client configuration validation for client Starter.Bff succeeded.

[04:17:00 Debug] IdentityServer4.Stores.ValidatingClientStore
client configuration validation for client Starter.Bff succeeded.

[04:17:00 Information] Microsoft.EntityFrameworkCore.Infrastructure
Entity Framework Core 5.0.8 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None

[04:17:00 Information] Microsoft.EntityFrameworkCore.Database.Command
Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0

[04:17:00 Debug] IdentityServer4.Validation.TokenValidator
Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator

[04:17:00 Debug] IdentityServer4.Validation.TokenValidator
Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":"EF4FF3643B244E224D2A7A71BCEF9F3B","Claims":{"nbf":1641787755,"exp":1641791355,"iss":"https://localhost","aud":["starter.api","https://localhost/resources"],"client_id":"Starter.Bff","sub":"4","auth_time":1641787754,"idp":"local","jti":"EF4FF3643B244E224D2A7A71BCEF9F3B","sid":"086FAE565F6D1C6EAA0740DB4605C3E3","iat":1641787755,"scope":["openid","profile","Starter.Api","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}

[04:17:00 Debug] IdentityServer4.ResponseHandling.UserInfoResponseGenerator
Creating userinfo response

[04:17:00 Debug] IdentityServer4.ResponseHandling.UserInfoResponseGenerator
Scopes in access token: openid profile Starter.Api offline_access

[04:17:00 Debug] IdentityServer4.ResponseHandling.UserInfoResponseGenerator
Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at

[04:17:00 Information] Microsoft.EntityFrameworkCore.Database.Command
Executed DbCommand (1ms) [Parameters=[@__user_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0

[04:17:00 Information] Microsoft.EntityFrameworkCore.Database.Command
Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0

[04:17:00 Information] IdentityServer4.ResponseHandling.UserInfoResponseGenerator
Profile service returned the following claim types: sub website family_name given_name name preferred_username

[04:17:00 Debug] IdentityServer4.Endpoints.UserInfoEndpoint
End userinfo request

[04:17:00 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.1 GET http://idp:5006/connect/userinfo - - - 200 - application/json;+charset=UTF-8 52.2532ms

[04:17:53 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration - -

[04:17:53 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[04:17:53 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[04:17:53 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /.well-known/openid-configuration matched to endpoint type Discovery

[04:17:53 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint

[04:17:53 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration

[04:17:53 Debug] IdentityServer4.Endpoints.DiscoveryEndpoint
Start discovery request

[04:17:53 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 2.7727ms

[04:17:53 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration/jwks - -

[04:17:53 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[04:17:53 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[04:17:53 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery

[04:17:53 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint

[04:17:53 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks

[04:17:53 Debug] IdentityServer4.Endpoints.DiscoveryKeyEndpoint
Start key discovery request

[04:17:53 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 2.8936ms

[04:17:53 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.1 GET http://idp:5006/connect/userinfo - -

[04:17:53 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[04:17:53 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[04:17:53 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /connect/userinfo matched to endpoint type Userinfo

[04:17:53 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint

[04:17:53 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo

[04:17:53 Debug] IdentityServer4.Endpoints.UserInfoEndpoint
Start userinfo request

[04:17:53 Debug] IdentityServer4.Validation.BearerTokenUsageValidator
Bearer token found in header

[04:17:53 Debug] IdentityServer4.Stores.ValidatingClientStore
client configuration validation for client Starter.Bff succeeded.

[04:17:53 Debug] IdentityServer4.Stores.ValidatingClientStore
client configuration validation for client Starter.Bff succeeded.

[04:17:53 Information] Microsoft.EntityFrameworkCore.Infrastructure
Entity Framework Core 5.0.8 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None

[04:17:53 Information] Microsoft.EntityFrameworkCore.Database.Command
Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0

[04:17:53 Debug] IdentityServer4.Validation.TokenValidator
Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator

[04:17:53 Debug] IdentityServer4.Validation.TokenValidator
Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":"EF4FF3643B244E224D2A7A71BCEF9F3B","Claims":{"nbf":1641787755,"exp":1641791355,"iss":"https://localhost","aud":["starter.api","https://localhost/resources"],"client_id":"Starter.Bff","sub":"4","auth_time":1641787754,"idp":"local","jti":"EF4FF3643B244E224D2A7A71BCEF9F3B","sid":"086FAE565F6D1C6EAA0740DB4605C3E3","iat":1641787755,"scope":["openid","profile","Starter.Api","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}

[04:17:53 Debug] IdentityServer4.ResponseHandling.UserInfoResponseGenerator
Creating userinfo response

[04:17:53 Debug] IdentityServer4.ResponseHandling.UserInfoResponseGenerator
Scopes in access token: openid profile Starter.Api offline_access

[04:17:53 Debug] IdentityServer4.ResponseHandling.UserInfoResponseGenerator
Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at

[04:17:53 Information] Microsoft.EntityFrameworkCore.Database.Command
Executed DbCommand (1ms) [Parameters=[@__user_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0

[04:17:53 Information] Microsoft.EntityFrameworkCore.Database.Command
Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0

[04:17:53 Information] IdentityServer4.ResponseHandling.UserInfoResponseGenerator
Profile service returned the following claim types: sub website family_name given_name name preferred_username

[04:17:53 Debug] IdentityServer4.Endpoints.UserInfoEndpoint
End userinfo request

[04:17:53 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.1 GET http://idp:5006/connect/userinfo - - - 200 - application/json;+charset=UTF-8 11.9096ms

[04:19:12 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration - -

[04:19:12 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[04:19:12 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[04:19:12 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /.well-known/openid-configuration matched to endpoint type Discovery

[04:19:12 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint

[04:19:12 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration

[04:19:12 Debug] IdentityServer4.Endpoints.DiscoveryEndpoint
Start discovery request

[04:19:12 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 2.6677ms

[04:19:12 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration/jwks - -

[04:19:12 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[04:19:12 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[04:19:12 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery

[04:19:12 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint

[04:19:12 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks

[04:19:12 Debug] IdentityServer4.Endpoints.DiscoveryKeyEndpoint
Start key discovery request

[04:19:12 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.1 GET http://idp:5006/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 2.7277ms

[04:19:12 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.1 GET http://idp:5006/connect/userinfo - -

[04:19:12 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[04:19:12 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[04:19:12 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /connect/userinfo matched to endpoint type Userinfo

[04:19:12 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint

[04:19:12 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo

[04:19:12 Debug] IdentityServer4.Endpoints.UserInfoEndpoint
Start userinfo request

[04:19:12 Debug] IdentityServer4.Validation.BearerTokenUsageValidator
Bearer token found in header

[04:19:12 Debug] IdentityServer4.Stores.ValidatingClientStore
client configuration validation for client Starter.Bff succeeded.

[04:19:12 Debug] IdentityServer4.Stores.ValidatingClientStore
client configuration validation for client Starter.Bff succeeded.

[04:19:12 Information] Microsoft.EntityFrameworkCore.Infrastructure
Entity Framework Core 5.0.8 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None

[04:19:12 Information] Microsoft.EntityFrameworkCore.Database.Command
Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0

[04:19:12 Debug] IdentityServer4.Validation.TokenValidator
Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator

[04:19:12 Debug] IdentityServer4.Validation.TokenValidator
Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":"EF4FF3643B244E224D2A7A71BCEF9F3B","Claims":{"nbf":1641787755,"exp":1641791355,"iss":"https://localhost","aud":["starter.api","https://localhost/resources"],"client_id":"Starter.Bff","sub":"4","auth_time":1641787754,"idp":"local","jti":"EF4FF3643B244E224D2A7A71BCEF9F3B","sid":"086FAE565F6D1C6EAA0740DB4605C3E3","iat":1641787755,"scope":["openid","profile","Starter.Api","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}

[04:19:12 Debug] IdentityServer4.ResponseHandling.UserInfoResponseGenerator
Creating userinfo response

[04:19:12 Debug] IdentityServer4.ResponseHandling.UserInfoResponseGenerator
Scopes in access token: openid profile Starter.Api offline_access

[04:19:12 Debug] IdentityServer4.ResponseHandling.UserInfoResponseGenerator
Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at

[04:19:12 Information] Microsoft.EntityFrameworkCore.Database.Command
Executed DbCommand (1ms) [Parameters=[@__user_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0

[04:19:12 Information] Microsoft.EntityFrameworkCore.Database.Command
Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0

[04:19:12 Information] IdentityServer4.ResponseHandling.UserInfoResponseGenerator
Profile service returned the following claim types: sub website family_name given_name name preferred_username

[04:19:12 Debug] IdentityServer4.Endpoints.UserInfoEndpoint
End userinfo request

[04:19:12 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.1 GET http://idp:5006/connect/userinfo - - - 200 - application/json;+charset=UTF-8 12.0030ms

[04:20:49 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.1 GET http://idp:5006/connect/userinfo - -

[04:20:49 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[04:20:49 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[04:20:49 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /connect/userinfo matched to endpoint type Userinfo

[04:20:49 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint

[04:20:49 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo

[04:20:49 Debug] IdentityServer4.Endpoints.UserInfoEndpoint
Start userinfo request

[04:20:49 Debug] IdentityServer4.Validation.BearerTokenUsageValidator
Bearer token found in header

[04:20:49 Debug] IdentityServer4.Stores.ValidatingClientStore
client configuration validation for client Starter.Bff succeeded.

[04:20:49 Debug] IdentityServer4.Stores.ValidatingClientStore
client configuration validation for client Starter.Bff succeeded.

[04:20:49 Information] Microsoft.EntityFrameworkCore.Infrastructure
Entity Framework Core 5.0.8 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None

[04:20:49 Information] Microsoft.EntityFrameworkCore.Database.Command
Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0

[04:20:49 Debug] IdentityServer4.Validation.TokenValidator
Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator

[04:20:49 Debug] IdentityServer4.Validation.TokenValidator
Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":"EF4FF3643B244E224D2A7A71BCEF9F3B","Claims":{"nbf":1641787755,"exp":1641791355,"iss":"https://localhost","aud":["starter.api","https://localhost/resources"],"client_id":"Starter.Bff","sub":"4","auth_time":1641787754,"idp":"local","jti":"EF4FF3643B244E224D2A7A71BCEF9F3B","sid":"086FAE565F6D1C6EAA0740DB4605C3E3","iat":1641787755,"scope":["openid","profile","Starter.Api","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}

[04:20:49 Debug] IdentityServer4.ResponseHandling.UserInfoResponseGenerator
Creating userinfo response

[04:20:49 Debug] IdentityServer4.ResponseHandling.UserInfoResponseGenerator
Scopes in access token: openid profile Starter.Api offline_access

[04:20:49 Debug] IdentityServer4.ResponseHandling.UserInfoResponseGenerator
Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at

[04:20:49 Information] Microsoft.EntityFrameworkCore.Database.Command
Executed DbCommand (1ms) [Parameters=[@__user_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0

[04:20:49 Information] Microsoft.EntityFrameworkCore.Database.Command
Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0

[04:20:49 Information] IdentityServer4.ResponseHandling.UserInfoResponseGenerator
Profile service returned the following claim types: sub website family_name given_name name preferred_username

[04:20:49 Debug] IdentityServer4.Endpoints.UserInfoEndpoint
End userinfo request

[04:20:49 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.1 GET http://idp:5006/connect/userinfo - - - 200 - application/json;+charset=UTF-8 11.5804ms

[04:24:22 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.1 GET http://idp:5006/connect/userinfo - -

[04:24:22 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[04:24:22 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[04:24:22 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /connect/userinfo matched to endpoint type Userinfo

[04:24:22 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint

[04:24:22 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo

[04:24:22 Debug] IdentityServer4.Endpoints.UserInfoEndpoint
Start userinfo request

[04:24:22 Debug] IdentityServer4.Validation.BearerTokenUsageValidator
Bearer token found in header

[04:24:22 Debug] IdentityServer4.Stores.ValidatingClientStore
client configuration validation for client Starter.Bff succeeded.

[04:24:22 Debug] IdentityServer4.Stores.ValidatingClientStore
client configuration validation for client Starter.Bff succeeded.

[04:24:22 Information] Microsoft.EntityFrameworkCore.Infrastructure
Entity Framework Core 5.0.8 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None

[04:24:22 Information] Microsoft.EntityFrameworkCore.Database.Command
Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0

[04:24:22 Debug] IdentityServer4.Validation.TokenValidator
Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator

[04:24:22 Debug] IdentityServer4.Validation.TokenValidator
Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":"EF4FF3643B244E224D2A7A71BCEF9F3B","Claims":{"nbf":1641787755,"exp":1641791355,"iss":"https://localhost","aud":["starter.api","https://localhost/resources"],"client_id":"Starter.Bff","sub":"4","auth_time":1641787754,"idp":"local","jti":"EF4FF3643B244E224D2A7A71BCEF9F3B","sid":"086FAE565F6D1C6EAA0740DB4605C3E3","iat":1641787755,"scope":["openid","profile","Starter.Api","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}

[04:24:22 Debug] IdentityServer4.ResponseHandling.UserInfoResponseGenerator
Creating userinfo response

[04:24:22 Debug] IdentityServer4.ResponseHandling.UserInfoResponseGenerator
Scopes in access token: openid profile Starter.Api offline_access

[04:24:22 Debug] IdentityServer4.ResponseHandling.UserInfoResponseGenerator
Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at

[04:24:22 Information] Microsoft.EntityFrameworkCore.Database.Command
Executed DbCommand (1ms) [Parameters=[@__user_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0

[04:24:22 Information] Microsoft.EntityFrameworkCore.Database.Command
Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0

[04:24:22 Information] IdentityServer4.ResponseHandling.UserInfoResponseGenerator
Profile service returned the following claim types: sub website family_name given_name name preferred_username

[04:24:22 Debug] IdentityServer4.Endpoints.UserInfoEndpoint
End userinfo request

[04:24:22 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.1 GET http://idp:5006/connect/userinfo - - - 200 - application/json;+charset=UTF-8 18.8832ms

[04:24:39 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.0 GET https://localhost/Account/Logout - -

[04:24:39 Information] Microsoft.AspNetCore.Cors.Infrastructure.CorsService
CORS policy execution successful.

[04:24:39 Information] Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware
No CORS policy found for the specified request.

[04:24:39 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was successfully authenticated.

[04:24:39 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was successfully authenticated.

[04:24:39 Information] Microsoft.AspNetCore.Routing.EndpointMiddleware
Executing endpoint 'Starter.Idp.Controllers.Account.AccountController.Logout (IDP)'

[04:24:39 Information] Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker
Route matched with {action = "Logout", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Logout(System.String) on controller Starter.Idp.Controllers.Account.AccountController (IDP).

[04:24:39 Information] Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor
Executing ViewResult, running view Logout.

[04:24:39 Information] Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor
Executed ViewResult - view Logout executed in 6.8703ms.

[04:24:39 Information] Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker
Executed action Starter.Idp.Controllers.Account.AccountController.Logout (IDP) in 20.3872ms

[04:24:39 Information] Microsoft.AspNetCore.Routing.EndpointMiddleware
Executed endpoint 'Starter.Idp.Controllers.Account.AccountController.Logout (IDP)'

[04:24:39 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.0 GET https://localhost/Account/Logout - - - 200 - text/html;+charset=utf-8 29.4688ms

[04:24:39 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.0 GET https://localhost/css/site.css - -

[04:24:39 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.0 GET https://localhost/lib/bootstrap/dist/css/bootstrap.min.css - -

[04:24:39 Information] Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware
Sending file. Request path: '/css/site.css'. Physical path: '/app/wwwroot/css/site.css'

[04:24:39 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.0 GET https://localhost/css/site.css - - - 200 497 text/css 13.6860ms

[04:24:39 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.0 GET https://localhost/lib/jquery/dist/jquery.slim.min.js - -

[04:24:39 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.0 GET https://localhost/lib/bootstrap/dist/js/bootstrap.bundle.min.js - -

[04:24:39 Information] Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware
Sending file. Request path: '/lib/jquery/dist/jquery.slim.min.js'. Physical path: '/app/wwwroot/lib/jquery/dist/jquery.slim.min.js'

[04:24:39 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.0 GET https://localhost/lib/jquery/dist/jquery.slim.min.js - - - 200 72397 application/javascript 12.6989ms

[04:24:39 Information] Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware
Sending file. Request path: '/lib/bootstrap/dist/css/bootstrap.min.css'. Physical path: '/app/wwwroot/lib/bootstrap/dist/css/bootstrap.min.css'

[04:24:39 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.0 GET https://localhost/lib/bootstrap/dist/css/bootstrap.min.css - - - 200 159515 text/css 36.5195ms

[04:24:39 Information] Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware
Sending file. Request path: '/lib/bootstrap/dist/js/bootstrap.bundle.min.js'. Physical path: '/app/wwwroot/lib/bootstrap/dist/js/bootstrap.bundle.min.js'

[04:24:39 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.0 GET https://localhost/lib/bootstrap/dist/js/bootstrap.bundle.min.js - - - 200 80698 application/javascript 17.4453ms

[04:24:39 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.0 GET https://localhost/lib/bootstrap/dist/css/bootstrap.min.css.map - -

[04:24:39 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.0 GET https://localhost/lib/bootstrap/dist/js/bootstrap.bundle.min.js.map - -

[04:24:39 Information] Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware
Sending file. Request path: '/lib/bootstrap/dist/js/bootstrap.bundle.min.js.map'. Physical path: '/app/wwwroot/lib/bootstrap/dist/js/bootstrap.bundle.min.js.map'

[04:24:39 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.0 GET https://localhost/lib/bootstrap/dist/js/bootstrap.bundle.min.js.map - - - 200 318045 text/plain 17.6672ms

[04:24:39 Information] Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware
Sending file. Request path: '/lib/bootstrap/dist/css/bootstrap.min.css.map'. Physical path: '/app/wwwroot/lib/bootstrap/dist/css/bootstrap.min.css.map'

[04:24:39 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.0 GET https://localhost/lib/bootstrap/dist/css/bootstrap.min.css.map - - - 200 641867 text/plain 28.6187ms

[04:24:41 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.0 POST https://localhost/Account/Logout application/x-www-form-urlencoded 235

[04:24:41 Information] Microsoft.AspNetCore.Cors.Infrastructure.CorsService
CORS policy execution successful.

[04:24:41 Information] Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware
No CORS policy found for the specified request.

[04:24:41 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was successfully authenticated.

[04:24:41 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was successfully authenticated.

[04:24:41 Information] Microsoft.AspNetCore.Routing.EndpointMiddleware
Executing endpoint 'Starter.Idp.Controllers.Account.AccountController.Logout (IDP)'

[04:24:41 Information] Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker
Route matched with {action = "Logout", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Logout(Starter.Idp.Models.Account.LogoutInputModel) on controller Starter.Idp.Controllers.Account.AccountController (IDP).

[04:24:41 Information] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application signed out.

[04:24:41 Information] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.External signed out.

[04:24:41 Information] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.TwoFactorUserId signed out.

[04:24:41 Information] IdentityServer4.Events.DefaultEventService
{"SubjectId":"4","DisplayName":"Bob Smith","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HMEJTCFTJ79D:00000002","TimeStamp":"2022-01-10T04:24:41.0000000Z","ProcessId":188,"LocalIpAddress":"172.24.0.3:5007","RemoteIpAddress":"172.24.0.1","$type":"UserLogoutSuccessEvent"}

[04:24:41 Information] Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor
Executing ViewResult, running view LoggedOut.

[04:24:41 Debug] IdentityServer4.Hosting.IdentityServerMiddleware
SignOutCalled set; processing post-signout session cleanup.

[04:24:41 Debug] IdentityServer4.Stores.ValidatingClientStore
client configuration validation for client Starter.Bff succeeded.

[04:24:41 Debug] IdentityServer4.Services.LogoutNotificationService
No client back-channel logout URLs

[04:24:41 Information] Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor
Executed ViewResult - view LoggedOut executed in 10.1916ms.

[04:24:41 Information] Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker
Executed action Starter.Idp.Controllers.Account.AccountController.Logout (IDP) in 21.7931ms

[04:24:41 Information] Microsoft.AspNetCore.Routing.EndpointMiddleware
Executed endpoint 'Starter.Idp.Controllers.Account.AccountController.Logout (IDP)'

[04:24:41 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.0 POST https://localhost/Account/Logout application/x-www-form-urlencoded 235 - 200 - text/html;+charset=utf-8 30.7284ms

[04:24:41 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.0 GET https://localhost/css/site.css - -

[04:24:41 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.0 GET https://localhost/connect/endsession/callback?endSessionId=CfDJ8C12c5uNIJ9LlhxxnQXiB7Kx_4Z93UzWeHp4htqLnVcVTqMf9XM9tjRuPztSa05iunOruKRrqpW3K1x_e2yZYjKZFXJ14ZBmB440e4b-590WcTuSHcuWcllBvD8_333tdqu9n0qn7Tg0WqGB2GwKpCEFSFgIzmAE2aWRdxK_Mxpap4jPiihIYNYP3V_0Kvaox0Dzbe8J4gNtOWNUdqfb4do-fF80g2wsVRXrcB9Tg95kMse4fnjlcXw0Hqvhu7WXwKGioxbfAsC1I4ORWfzbVDKRHbzx6mtoCYLKM3OmnE9Y - -

[04:24:41 Information] Microsoft.AspNetCore.Cors.Infrastructure.CorsService
CORS policy execution successful.

[04:24:41 Information] Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware
No CORS policy found for the specified request.

[04:24:41 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[04:24:41 Debug] Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler
AuthenticationScheme: Identity.Application was not authenticated.

[04:24:41 Debug] IdentityServer4.Hosting.EndpointRouter
Request path /connect/endsession/callback matched to endpoint type Endsession

[04:24:41 Debug] IdentityServer4.Hosting.EndpointRouter
Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint

[04:24:41 Information] Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware
Sending file. Request path: '/css/site.css'. Physical path: '/app/wwwroot/css/site.css'

[04:24:41 Information] IdentityServer4.Hosting.IdentityServerMiddleware
Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback

[04:24:41 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.0 GET https://localhost/css/site.css - - - 200 497 text/css 17.1305ms

[04:24:41 Debug] IdentityServer4.Endpoints.EndSessionCallbackEndpoint
Processing signout callback request

[04:24:41 Debug] IdentityServer4.Stores.ValidatingClientStore
client configuration validation for client Starter.Bff succeeded.

[04:24:41 Debug] IdentityServer4.Services.LogoutNotificationService
No client front-channel logout URLs

[04:24:41 Information] IdentityServer4.Endpoints.EndSessionCallbackEndpoint
Successful signout callback.

[04:24:41 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.0 GET https://localhost/connect/endsession/callback?endSessionId=CfDJ8C12c5uNIJ9LlhxxnQXiB7Kx_4Z93UzWeHp4htqLnVcVTqMf9XM9tjRuPztSa05iunOruKRrqpW3K1x_e2yZYjKZFXJ14ZBmB440e4b-590WcTuSHcuWcllBvD8_333tdqu9n0qn7Tg0WqGB2GwKpCEFSFgIzmAE2aWRdxK_Mxpap4jPiihIYNYP3V_0Kvaox0Dzbe8J4gNtOWNUdqfb4do-fF80g2wsVRXrcB9Tg95kMse4fnjlcXw0Hqvhu7WXwKGioxbfAsC1I4ORWfzbVDKRHbzx6mtoCYLKM3OmnE9Y - - - 200 - text/html;+charset=UTF-8 16.0128ms

[04:24:41 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.0 GET https://localhost/lib/bootstrap/dist/css/bootstrap.min.css - -

[04:24:41 Information] Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware
Sending file. Request path: '/lib/bootstrap/dist/css/bootstrap.min.css'. Physical path: '/app/wwwroot/lib/bootstrap/dist/css/bootstrap.min.css'

[04:24:41 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.0 GET https://localhost/lib/bootstrap/dist/css/bootstrap.min.css - - - 200 159515 text/css 16.8447ms

[04:24:41 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.0 GET https://localhost/lib/bootstrap/dist/css/bootstrap.min.css.map - -

[04:24:41 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request starting HTTP/1.0 GET https://localhost/lib/bootstrap/dist/js/bootstrap.bundle.min.js.map - -

[04:24:41 Information] Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware
Sending file. Request path: '/lib/bootstrap/dist/css/bootstrap.min.css.map'. Physical path: '/app/wwwroot/lib/bootstrap/dist/css/bootstrap.min.css.map'

[04:24:41 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.0 GET https://localhost/lib/bootstrap/dist/css/bootstrap.min.css.map - - - 200 641867 text/plain 38.4453ms

[04:24:41 Information] Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware
Sending file. Request path: '/lib/bootstrap/dist/js/bootstrap.bundle.min.js.map'. Physical path: '/app/wwwroot/lib/bootstrap/dist/js/bootstrap.bundle.min.js.map'

[04:24:41 Information] Microsoft.AspNetCore.Hosting.Diagnostics
Request finished HTTP/1.0 GET https://localhost/lib/bootstrap/dist/js/bootstrap.bundle.min.js.map - - - 200 318045 text/plain 24.7971ms

